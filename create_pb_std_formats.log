1                                                          The SAS System                              11:30 Friday, January 8, 2016

NOTE: Unable to open SASUSER.REGSTRY. WORK.REGSTRY will be opened instead.
NOTE: All registry changes will be lost at the end of the session.

WARNING: Unable to copy SASUSER registry to WORK registry. Because of this, you will not see registry customizations during this 
         session.
NOTE: Unable to open SASUSER.PROFILE. WORK.PROFILE will be opened instead.
NOTE: All profile changes will be lost at the end of the session.
NOTE: Copyright (c) 2002-2010 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.3 (TS1M2) 
      Licensed to LOYALTY SOLUTIONS & RESEARCH PRIVATE LIMITED, Site 11602563.
NOTE: This session is executing on the Linux 2.6.18-348.6.1.el5 (LIN X64) platform.



NOTE: Enhanced analytical products:

SAS/STAT 12.1, SAS/ETS 12.1, SAS/OR 12.2, SAS/IML 12.1

You are running SAS 9. Some SAS 8 files will be automatically converted 
by the V9 engine; others are incompatible.  Please see 
http://support.sas.com/rnd/migration/planning/platform/64bit.html

PROC MIGRATE will preserve current SAS file attributes and is 
recommended for converting all your SAS libraries from any 
SAS 8 release to SAS 9.  For details and examples, please see
http://support.sas.com/rnd/migration/index.html


This message is contained in the SAS news file, and is presented upon
initialization.  Edit the file "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.




NOTE: SAS initialization used:
      real time           0.04 seconds
      cpu time            0.03 seconds
      

NOTE: AUTOEXEC processing beginning; file is /sasdata/core_etl/prod/sas/includes/init_env.sas.


NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

50        +/************************************************************************
51        +*       Program      : SET_RPT_ENV							            *
52        +*                                                                       *
53        +*       Owner        : Analytics, LSRPL                                 *
54        +*                                                                       *
55        +*       Author       : ANANTHA RAMAN                          			*
56        +*                                                                       *
57        +*       Input        :  NONE                         					*
58        +*                                                                       *
2                                                          The SAS System                              11:30 Friday, January 8, 2016

59        +*       Output       : PERFECT SAS ENVIRONMENT							*
60        +*                                                                       *
61        +*       Dependencies : NONE                                             *
62        +*                                                                       *
63        +*       Description  : This macro can be used to SET THE BASIC SAS ENV  *
64        +*                      at eachh invocation of SAS Session  				*
65        +*																		*
66        +* 		Path		 :/sasdata/core_etl/prod/sas/sasautos/set_rpt_env.sas*
67        +*																		*
68        +*                                                                       *
69        +*       Usage        : 													*
70        +*                                                                       *
71        +*       History      :                                                  *
72        +*   LSRL-273	13-Jul-2011	Created.                       				*
73        +*   LSRL-273    04-dec-2012 Added step to create dwhnpg library     	*
74        +*                           (C0001)                                     *
75        +*   LSRL-273    26-JAN-2013 Moving physical_card_Type_id = 4 from   	*
76        +*                           CARDED to NON-CARDED bucket in the format 	*
77        +*							definition FORMATS.CARD_TYPE (C0002)		*
78        +*   LSRL-273    24-feb-2013 Added step to create date cut-off macro 	*
79        +*                   		variables (C0003)                           *
80        +*	LSRL-324    28-mar-2013 Default compress of datasets has added		*
81        +*							(C0004)										*
82        +*	LSRL-324    03-apr-2013 included table or column info macro (C0005) *
83        +*	LSRL-273    01-may-2013	Added a new format PID2LMID to capture 		*
84        +*							loyalty_partner_id given the partner_id 	*
85        +*							(C0006)										*
86        +*   LSRL-273  16-sep-2013 Migrated to the UNIX environment. (C0007)     *
87        +*   LSRL-273  17-sep-2013 Decoupled FORMAT creation code and restricted *
88        +*                         it only for etl_adm user                      *
89        +*   LSRL-273  19-sep-2013 Added SUMMLIB to list of preloaded libraries (C0008)*
90        +*   LSRL-273  01-oct-2013 Moved the SAS formats pre-loaded library from *
91        +*             core_etl to sasconf area to facilitate availability of the*
92        +*		formats to all client tools and BI servers. (C0009)       		*
93        +*	LSRL-324  26-Oct-2013 Creates the formats on conditional basis		*
94        +*				1) if login user is ETL_ADM and if it is first run only *
95        +*				2) System will wait for 2 mins if signal file created 	*
96        +*					with in 2 minutes of signal file creation (C0010)	*
97        +*   LSRL-273  05-dec-2013 Added library reference for AMX_STG(C0011)    *
98        +*   LSRL-334  15APR2014 created formats in a common location 			*
99        +*             for both servers 10.32.161.207 and 10.32.161.208 to check *
100       +*			  the difference between the performance of servers (C0012)*
101       +*   LSRL-273  Restoring the formats location so that BI process can access *
102       +*             user defined formats (C0013)                              *
103       +************************************************************************/
104       +
105       +options MAUTOSOURCE SASAUTOS=(
106       +					"/sasdata/core_etl/prod/FG/sasautos/reporting steps"
107       +					"/sasdata/core_etl/prod/FG/sasautos"
108       +					"/sasdata/core_etl/prod/sas/sasautos"
109       +                                         /*C0001 */
110       +				);
111       +
112       +
113       +%macro set_rpt_env;
114       +
115       +options compress=Char Reuse=yes; /* C0004 */
116       +options mprint mlogic symbolgen fmtsearch=(formats);
3                                                          The SAS System                              11:30 Friday, January 8, 2016

117       +
118       +/* Date related macro variables to be available throughout the session */
119       +data _null_;
120       +	call symput("rundate", put(today(), date9.));
121       +run;
122       +
123       +%put &rundate.;
124       +
125       +/* Earliest date to pick up data from */
126       +%LET epoch=01JUL2010;
127       +
128       +/* Last months last working day */
129       +%LET START_DATE_LAST_MON = INTNX("MONTH", "&SYSDATE"D, -1, "B");
130       +%LET END_DATE_LAST_MON = INTNX("MONTH", "&SYSDATE"D, -1, "E");
131       +%LET START_DATE_CURR_MON = INTNX("MONTH", "&SYSDATE"D, -0, "B");
132       +%LET END_DATE_CURR_MON = INTNX("MONTH", "&SYSDATE"D, -0, "E");
133       +
134       +/* SAS Native libraries */
135       +libname CUBELIB "/sasdata/core_etl/prod/libraries/CUBELIB";
136       +libname AUDITLIB "/sasdata/core_etl/prod/libraries/AUDITLIB/";
137       +libname SASMART "/sasdata/core_etl/prod/libraries/SASMART";
138       +libname SUPPLIB "/sasdata/core_etl/prod/libraries/SUPPLIB";
139       +libname WHOUSE "/sasdata/core_etl/prod/libraries/WHOUSE";
140       +libname TEMPLIB "/sasdata/core_etl/prod/libraries/TEMPLIB";
141       +libname OPSLIB "/sasdata/core_etl/prod/libraries/OPSLIB";
142       +libname ECOUPON "/sasdata/core_etl/prod/libraries/ECOUPON";
143       +libname REPORT "/sasdata/bi/REPORT";
144       +/* C0008 */
145       +libname SUMMLIB "/sasdata/core_etl/prod/libraries/SUMMLIB";
146       +libname CIMLIB "/sasdata/ci/CIMPLIB";
147       +libname CAMPLIB "/sasdata/campaign/CAMPLIB";
148       +libname DIDLIB "/sasdata1/did/DIDLIB";
149       +libname DID_STG "/sasdata1/did/DID_STG";
150       +
151       +libname BI_STG "/sasdata1/bi/BI_STG";
152       +libname BI_AUDIT "/sasdata1/bi/BI_AUDIT";
153       +
154       +/* C0011 */
155       +LIBNAME AMX_STG "/sasdata1/amex/AMX_STG";
156       +
157       +
158       +
159       +/*
160       +	20130917: Currently, core_etl admin (etl_adm user does not have write access to the following folder.
161       +	Moving formats creation to a localized folder within core_etl area.
162       +
163       +*/
164       +
165       +
166       +/* C0009 */
167       +/*(C0012)*/
168       +/*LIBNAME FORMATS "/sasdata/core_etl/prod/libraries/FORMATS_TMP"; */
169       +LIBNAME FORMATS "/sasconf/serverconfig/Lev1/SASApp/SASEnvironment/SASFormats/";
170       +/*LIBNAME FORMATS "/sasconf/serverconfig/Lev1/SASAnalytics/SASEnvironment/SASFormats/";*/
171       +
172       +
173       +/* ORACLE libraries */
174       +%include "/sasdata/core_etl/prod/sas/includes/set_conn_biu_dwh_rw.sas" / source2;
4                                                          The SAS System                              11:30 Friday, January 8, 2016

175       +
176       +
177       +
178       +/*C0010*/
179       +/* Construction of standardized PB formats. Runs only if core_etl administrator invokes the SAS-session and file
179      !+existence of formats_signal_DDMONYYYY.txt file*/
180       +
181       +	%IF %cmpres(%upcase(&sysuserid.))=%cmpres(ETL_ADM) %then
182       +		%do; /* ----- Checks the existence of file -- FORMATS_SIGNAL_DDMONYYYY.txt -----*/
183       +			%if %sysfunc(fileexist(/sasdata/core_etl/prod/conf/signals/formats_signal_&sysdate9..txt)) = 0 %then
184       +				%do;
185       +					/* ----- If file doesn't exist, create the file and run the formats creation ----- */
186       +				Data _null_;
187       +				file "/sasdata/core_etl/prod/conf/signals/formats_signal_&sysdate9..txt";
188       +				put "------------------";
189       +				run;
190       +				
191       +				%create_pb_std_formats;
192       +
193       +				%end;
194       +			%else
195       +				%do;
196       +					/* ----- If file exist, check the file creation time is 2 minutes before ----- */
197       +					/* ----- If file creation time is less than 2 minutes, system will wait for 2 minutes ------ */
198       +					filename stat pipe "ls -ltr /sasdata/core_etl/prod/conf/signals/formats_signal_&sysdate9..txt"	;			
199       +
200       +					data time;
201       +					infile stat truncover;
202       +					input var $200.;
203       +					Cr_time1 = scan(var,8,'');
204       +					cr_time  = ( scan(cr_time1,1,':')*60 ) + (scan(cr_time1,2,':')*1);
205       +					curtime1 = put(timepart(datetime()),HHMM5.);
206       +					a = scan(curtime1,1,':')*60;
207       +					b = scan(curtime1,2,':')*1;
208       +					curtime  = a + b;
209       +					call symputx('Mac_crt_time',cr_time);
210       +					call symputx('Mac_cur_time',curtime);
211       +					run;
212       +
213       +					%put Creatime Time ----> &Mac_crt_time. -- Current Time ------>  &Mac_cur_time.;
214       +
215       +					%if %eval(&Mac_crt_time. + 2) > &Mac_cur_time. %then
216       +						%do;
217       +							Data _null_;
218       +							a =sleep(120,1);
219       +							run;
220       +						%end;
221       +
222       +				%end;
223       +			%end;
224       +		%else
225       +				%do;
226       +					/* ----- If login user is not ETL_ADM and checking status file existence ----- */
227       +					/* ----- If file exist, check the file creation time is 2 minutes before ----- */
228       +					/* ----- If file creation time is less than 2 minutes, system will wait for 2 minutes ------ */
229       +
230       +					filename stat pipe "ls -ltr /sasdata/core_etl/prod/conf/signals/formats_signal_&sysdate9..txt"	;			
231       +
5                                                          The SAS System                              11:30 Friday, January 8, 2016

232       +					data time;
233       +					infile stat truncover;
234       +					input var $200.;
235       +					Cr_time1 = scan(var,8,'');
236       +					cr_time  = ( scan(cr_time1,1,':')*60 ) + (scan(cr_time1,2,':')*1);
237       +					curtime1 = put(timepart(datetime()),HHMM5.);
238       +					a = scan(curtime1,1,':')*60;
239       +					b = scan(curtime1,2,':')*1;
240       +					curtime  = a + b;
241       +					call symputx('Mac_crt_time',cr_time);
242       +					call symputx('Mac_cur_time',curtime);
243       +					run;
244       +
245       +					%put Creatime Time ----> &Mac_crt_time. -- Current Time ------>  &Mac_cur_time.;
246       +
247       +					%if %eval(&Mac_crt_time. + 2) > &Mac_cur_time. %then
248       +						%do;
249       +							Data _null_;
250       +							a =sleep(120,1);
251       +							run;
252       +						%end;
253       +
254       +				%end;
255       +
256       +%mend set_rpt_env;
257       +
258       +
NOTE: %INCLUDE (level 1) ending.
MPRINT(SET_RPT_ENV):   symbolgen fmtsearch=(formats);
MPRINT(SET_RPT_ENV):   data _null_;
MPRINT(SET_RPT_ENV):   call symput("rundate", put(today(), date9.));
MPRINT(SET_RPT_ENV):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MLOGIC(SET_RPT_ENV):  %PUT &rundate.
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
08JAN2016
MLOGIC(SET_RPT_ENV):  %LET (variable name is EPOCH)
MLOGIC(SET_RPT_ENV):  %LET (variable name is START_DATE_LAST_MON)
SYMBOLGEN:  Macro variable SYSDATE resolves to 08JAN16
MLOGIC(SET_RPT_ENV):  %LET (variable name is END_DATE_LAST_MON)
SYMBOLGEN:  Macro variable SYSDATE resolves to 08JAN16
MLOGIC(SET_RPT_ENV):  %LET (variable name is START_DATE_CURR_MON)
SYMBOLGEN:  Macro variable SYSDATE resolves to 08JAN16
MLOGIC(SET_RPT_ENV):  %LET (variable name is END_DATE_CURR_MON)
SYMBOLGEN:  Macro variable SYSDATE resolves to 08JAN16
MPRINT(SET_RPT_ENV):   libname CUBELIB "/sasdata/core_etl/prod/libraries/CUBELIB";
NOTE: Libref CUBELIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/core_etl/prod/libraries/CUBELIB
MPRINT(SET_RPT_ENV):   libname AUDITLIB "/sasdata/core_etl/prod/libraries/AUDITLIB/";
NOTE: Libref AUDITLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/core_etl/prod/libraries/AUDITLIB
6                                                          The SAS System                              11:30 Friday, January 8, 2016

MPRINT(SET_RPT_ENV):   libname SASMART "/sasdata/core_etl/prod/libraries/SASMART";
NOTE: Libref SASMART was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/core_etl/prod/libraries/SASMART
MPRINT(SET_RPT_ENV):   libname SUPPLIB "/sasdata/core_etl/prod/libraries/SUPPLIB";
NOTE: Libref SUPPLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/core_etl/prod/libraries/SUPPLIB
MPRINT(SET_RPT_ENV):   libname WHOUSE "/sasdata/core_etl/prod/libraries/WHOUSE";
NOTE: Libref WHOUSE was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/core_etl/prod/libraries/WHOUSE
MPRINT(SET_RPT_ENV):   libname TEMPLIB "/sasdata/core_etl/prod/libraries/TEMPLIB";
NOTE: Libref TEMPLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/core_etl/prod/libraries/TEMPLIB
MPRINT(SET_RPT_ENV):   libname OPSLIB "/sasdata/core_etl/prod/libraries/OPSLIB";
NOTE: Libref OPSLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/core_etl/prod/libraries/OPSLIB
MPRINT(SET_RPT_ENV):   libname ECOUPON "/sasdata/core_etl/prod/libraries/ECOUPON";
NOTE: Libref ECOUPON was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/core_etl/prod/libraries/ECOUPON
MPRINT(SET_RPT_ENV):   libname REPORT "/sasdata/bi/REPORT";
NOTE: Libref REPORT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/bi/REPORT
MPRINT(SET_RPT_ENV):   libname SUMMLIB "/sasdata/core_etl/prod/libraries/SUMMLIB";
NOTE: Libref SUMMLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/core_etl/prod/libraries/SUMMLIB
MPRINT(SET_RPT_ENV):   libname CIMLIB "/sasdata/ci/CIMPLIB";
NOTE: Libref CIMLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/ci/CIMPLIB
MPRINT(SET_RPT_ENV):   libname CAMPLIB "/sasdata/campaign/CAMPLIB";
NOTE: Libref CAMPLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata/campaign/CAMPLIB
MPRINT(SET_RPT_ENV):   libname DIDLIB "/sasdata1/did/DIDLIB";
NOTE: Libref DIDLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata1/did/DIDLIB
MPRINT(SET_RPT_ENV):   libname DID_STG "/sasdata1/did/DID_STG";
NOTE: Libref DID_STG was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata1/did/DID_STG
MPRINT(SET_RPT_ENV):   libname BI_STG "/sasdata1/bi/BI_STG";
NOTE: Libref BI_STG was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata1/bi/BI_STG
MPRINT(SET_RPT_ENV):   libname BI_AUDIT "/sasdata1/bi/BI_AUDIT";
NOTE: Libref BI_AUDIT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasdata1/bi/BI_AUDIT
MPRINT(SET_RPT_ENV):   LIBNAME AMX_STG "/sasdata1/amex/AMX_STG";
NOTE: Libref AMX_STG was successfully assigned as follows: 
7                                                          The SAS System                              11:30 Friday, January 8, 2016

      Engine:        V9 
      Physical Name: /sasdata1/amex/AMX_STG
MPRINT(SET_RPT_ENV):   LIBNAME FORMATS "/sasconf/serverconfig/Lev1/SASApp/SASEnvironment/SASFormats/";
NOTE: Libref FORMATS was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /sasconf/serverconfig/Lev1/SASApp/SASEnvironment/SASFormats
260       +/************************************************************************
261       +*       Program      : G:\sas\common\includes\set_conn_biu_dwh_rw.sas   *
262       +*                                                                       *
263       +*                                                                       *
264       +*       Owner        : Analytics, LSRPL                                 *
265       +*                                                                       *
266       +*       Author       : LSRL/273                                         *
267       +*                                                                       *
268       +*       Input        :                                                  *
269       +*                                                                       *
270       +*                                                                       *
271       +*                                                                       *
272       +*       Output       :                                                  *
273       +*                                                                       *
274       +*                                                                       *
275       +*                                                                       *
276       +*       Dependencies :                                                  *
277       +*                                                                       *
278       +*       Description  : Creates library references to ORACLE schema(s).  *
279       +*                                                                       *
280       +*                                                                       *
281       +*       Usage        :                                                  *
282       +*                                                                       *
283       +*                                                                       *
284       +*                                                                       *
285       +*                                                                       *
286       +*       History      :                                                  *
287       +*       (Analyst)     (Date)    (Changes)                               *
288       +*       LSRL/273    16MAY2013  Added libref creation for ECOUPON2       *
289       +*                              (C0001)                                  *
290       +*       LSRL/273    16-sep-2013 Module operational in UNIX environment. *
291       +*                   Currently defined ORACLE libraries are:             *
292       +*                   DWHLIB                                              *
293       +*                   ECOUPON                                             *
294       +*                   OFBIZLIB                                            *
295       +*                   This would be replaced with Oracle connections as   *
296       +*                   CMS implementation.                                 *
297       +*  		LSRL/334    27MAY2014(C0002)											*
298       +*                   Adding cmsdwh library to connect to cmsdwh          *
299       +*                   CMSDWH                                              *
300       +*                 														*
301       +************************************************************************/
302       +
303       +/* C0003*/
304       +/* LIBNAME dwhlib ORACLE  PATH=DWHFO  SCHEMA=dwh  USER=dwh  PASSWORD="manager" ; */
305       +LIBNAME DWHLIB ORACLE  PATH=CMSDWH  SCHEMA=BIU_READ  USER=biu_read  PASSWORD=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX ;
MPRINT(SET_RPT_ENV):   LIBNAME DWHLIB ORACLE PATH=CMSDWH SCHEMA=BIU_READ USER=biu_read 
PASSWORD="{SAS002}56AFFB0547A4A37417F8135F2EAD17C9" ;
NOTE: Libref DWHLIB was successfully assigned as follows: 
      Engine:        ORACLE 
      Physical Name: CMSDWH
306       +
8                                                          The SAS System                              11:30 Friday, January 8, 2016

307       +/* LIBNAME starlib ORACLE  PATH=DWHFO  SCHEMA=star  USER=dwh  PASSWORD="manager" ;
308       +LIBNAME worklib ORACLE  PATH=DWHFO  SCHEMA=work  USER=dwh  PASSWORD="manager" ; */
309       +libname ofbizlib oracle user=dwh password=XXXXXXX schema=OFBIZ path='DWHFO';
MPRINT(SET_RPT_ENV):   libname ofbizlib oracle user=dwh password=manager schema=OFBIZ path='DWHFO';
NOTE: Libref OFBIZLIB was successfully assigned as follows: 
      Engine:        ORACLE 
      Physical Name: DWHFO
310       +
311       +/* Connect to E-couponing test server */
312       +/*libname ecoulibt oracle USER=ecoupon password=payback path=PAYBACK;*/
313       +/* Connect to E-couponing prod area in ORACLE */
314       +libname ecoulibp oracle USER=dwh password=XXXXXXX schema=ecoupon path=DWHFO;
MPRINT(SET_RPT_ENV):   libname ecoulibp oracle USER=dwh password=manager schema=ecoupon path=DWHFO;
NOTE: Libref ECOULIBP was successfully assigned as follows: 
      Engine:        ORACLE 
      Physical Name: DWHFO
315       +
316       +/* C0001 */
317       +LIBNAME ecoupon2 ORACLE  PATH=dwhfo  SCHEMA=ecoupon2  USER=ecoupon2  PASSWORD=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
317      !+;
MPRINT(SET_RPT_ENV):   LIBNAME ecoupon2 ORACLE PATH=dwhfo SCHEMA=ecoupon2 USER=ecoupon2 
PASSWORD="{sas002}30A3A7464DCD9CC727DA4AF75736010D" ;
NOTE: Libref ECOUPON2 was successfully assigned as follows: 
      Engine:        ORACLE 
      Physical Name: dwhfo
318       +/* libname assignment for npg schema - To capture redemptions */
319       +LIBNAME DWHNPG ORACLE  PATH=DWHFO  SCHEMA=PAYBACK_NPG  USER=PAYBACK_NPG
319      !+PASSWORD=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX ;
MPRINT(SET_RPT_ENV):   LIBNAME DWHNPG ORACLE PATH=DWHFO SCHEMA=PAYBACK_NPG USER=PAYBACK_NPG 
PASSWORD="{sas002}3A30C82816E6152A3E034D255B1B9FA02961C64C" ;
NOTE: Libref DWHNPG was successfully assigned as follows: 
      Engine:        ORACLE 
      Physical Name: DWHFO
320       +
321       +
322       +%macro connecttooracle;
323       +connect to oracle as DWH (USER=biu_read  PASSWORD="{SAS002}56AFFB0547A4A37417F8135F2EAD17C9" path=CMSDWH
323      !+preserve_comments buffsize=10000);
324       +%mend;
NOTE: %INCLUDE (level 1) ending.
MLOGIC(SET_RPT_ENV):  Beginning compilation of CMPRES using the autocall file /sasdata/core_etl/prod/sas/sasautos/cmpres.sas.
MLOGIC(SET_RPT_ENV):  Ending compilation of CMPRES.
MLOGIC(CMPRES):  Beginning execution.
MLOGIC(CMPRES):  This macro was compiled from the autocall file /sasdata/core_etl/prod/sas/sasautos/cmpres.sas
SYMBOLGEN:  Macro variable SYSUSERID resolves to etl_adm
MLOGIC(CMPRES):  Parameter PARAM has value ETL_ADM
SYMBOLGEN:  Macro variable PARAM resolves to ETL_ADM
MLOGIC(CMPRES):  Ending execution.
MLOGIC(CMPRES):  Beginning execution.
MLOGIC(CMPRES):  This macro was compiled from the autocall file /sasdata/core_etl/prod/sas/sasautos/cmpres.sas
MLOGIC(CMPRES):  Parameter PARAM has value ETL_ADM
SYMBOLGEN:  Macro variable PARAM resolves to ETL_ADM
MLOGIC(CMPRES):  Ending execution.
MLOGIC(SET_RPT_ENV):  %IF condition %cmpres(%upcase(&sysuserid.))=%cmpres(ETL_ADM) is TRUE
SYMBOLGEN:  Macro variable SYSDATE9 resolves to 08JAN2016
MLOGIC(SET_RPT_ENV):  %IF condition %sysfunc(fileexist(/sasdata/core_etl/prod/conf/signals/formats_signal_&sysdate9..txt)) = 0 is 
      FALSE
SYMBOLGEN:  Macro variable SYSDATE9 resolves to 08JAN2016
9                                                          The SAS System                              11:30 Friday, January 8, 2016

MPRINT(SET_RPT_ENV):   filename stat pipe "ls -ltr /sasdata/core_etl/prod/conf/signals/formats_signal_08JAN2016.txt" ;
MPRINT(SET_RPT_ENV):   data time;
MPRINT(SET_RPT_ENV):   infile stat truncover;
MPRINT(SET_RPT_ENV):   input var $200.;
MPRINT(SET_RPT_ENV):   Cr_time1 = scan(var,8,'');
MPRINT(SET_RPT_ENV):   cr_time = ( scan(cr_time1,1,':')*60 ) + (scan(cr_time1,2,':')*1);
MPRINT(SET_RPT_ENV):   curtime1 = put(timepart(datetime()),HHMM5.);
MPRINT(SET_RPT_ENV):   a = scan(curtime1,1,':')*60;
MPRINT(SET_RPT_ENV):   b = scan(curtime1,2,':')*1;
MPRINT(SET_RPT_ENV):   curtime = a + b;
MPRINT(SET_RPT_ENV):   call symputx('Mac_crt_time',cr_time);
MPRINT(SET_RPT_ENV):   call symputx('Mac_cur_time',curtime);
MPRINT(SET_RPT_ENV):   run;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      324:236   324:11    324:96    324:130   
NOTE: The infile STAT is:
      Pipe command="ls -ltr /sasdata/core_etl/prod/conf/signals/formats_signal_08JAN2016.txt"

NOTE: 1 record was read from the infile STAT.
      The minimum record length was 114.
      The maximum record length was 114.
NOTE: The data set WORK.TIME has 1 observations and 7 variables.
NOTE: Compressing data set WORK.TIME decreased size by 0.00 percent. 
      Compressed is 1 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MLOGIC(SET_RPT_ENV):  %PUT Creatime Time ----> &Mac_crt_time. -- Current Time ------>  &Mac_cur_time.
SYMBOLGEN:  Macro variable MAC_CRT_TIME resolves to 11
SYMBOLGEN:  Macro variable MAC_CUR_TIME resolves to 690
Creatime Time ----> 11 -- Current Time ------>  690
SYMBOLGEN:  Macro variable MAC_CRT_TIME resolves to 11
SYMBOLGEN:  Macro variable MAC_CUR_TIME resolves to 690
MLOGIC(SET_RPT_ENV):  %IF condition %eval(&Mac_crt_time. + 2) > &Mac_cur_time. is FALSE
MLOGIC(SET_RPT_ENV):  Ending execution.
NOTE: Libref CMSDWH was successfully assigned as follows: 
      Engine:        ORACLE 
      Physical Name: cmsdwh

NOTE: AUTOEXEC processing completed.

1          /************************************************************************
2          *       Program      :                                                  *
3          *         /sasdata/core_etl/prod/sas/sasautos/create_pb_std_formats.sas *
4          *                                                                       *
5          *       Owner        : Analytics, LSRPL                                 *
6          *                                                                       *
7          *       Author       : LSRL/273. AMR                                    *
8          *                                                                       *
9          *       Input        :                                                  *
10         *                                                                       *
11         *                                                                       *
12         *                                                                       *
13         *       Output       : FORMATS.FORMATS catalog at                       *
14         *           /sasconf/serverconfig/Lev1/SASApp/SASEnvironment/SASFormats *
10                                                         The SAS System                              11:30 Friday, January 8, 2016

15         *                                                                       *
16         *                                                                       *
17         *       Dependencies : NONE                                             *
18         *                                                                       *
19         *       Description  : This module is meant for creating standardized   *
20         *          formats for PB REPORTING & ANALYTICS streams. This macro     *
21         *          can be called directly or through the autoexec module:       *
22         *          /sasdata/core_etl/prod/sas/includes/init_env.sas and will be *
23         *          available through the SAS session. While ETL_ADM user is the *
24         *          only user who could create/edit/delete these formats, the    *
25         *          other users can avail the formats in READ-ONLY mode.         *
26         *                                                                       *
27         *       Usage        :                                                  *
28         *		%create_pb_std_formats;                                         *
29         *                                                                       *
30         *       History      :                                                  *
31         *       (Analyst)     (Date)    (Changes)                               *
32         *       LSRL/273  01SEP2013     Created.                                *
33         *       LSRL/273  10OCT2013     Added a deletion step on the top of this*
34         *                               macro to eliminate data/catalog         *
35         *                               corruption issues. (C00001)             *
36         *       LSRL/273  10OCT2013     Modified the CARD_TYPE format to depict *
37         *                               permanent & virtual card types (physical*
38         *                               card type id is 1 & 5 instead of 1 & 4. *
39         *                               (C00002)                                *
40         *       LSRL/273  10OCT2013     Added three new formats                 *
41         *                               ptsvd, rfmtpts & enrcmpgn (C00003)      *
42         *       LSRL/273  30OCT2013     Added an include step for creation of   *
43         *                               top fg cities based on enrolment &      *
44         *                               performance criteria. (C00004)          *
45         *       LSRL/273  15NOV2013     Adding INDUSLEAGUE to FGPARTCD format   *
46         *                               (C00005)                                *
47         *       LSRL/273  02DEC2013     Adding INDUSLEAGUE related updates to   *
48         *                               all formats (C00006)                    *
49         *       LSRL/334  06JUL2014     Adding Formats for accessing the Character
50         *							variables(RFV, Evolution Segments,Reachability)
51         *										in ALL_MEMBERS_SEGMENTS_FILE   *
52         *                              			  (C00007)                    *
53         ************************************************************************/
54         
55         %macro create_pb_std_formats;
56         
57         %include "/sasdata/core_etl/prod/sas/sasautos/get_observation_count.sas";
58         %include "/sasdata/core_etl/prod/sas/sasautos/cmpres.sas";
59         /* %include "/sasdata/core_etl/prod/sas/sasautos/Campaign_analysis_macro.sas"; */
60         /* %include "/sasdata/core_etl/prod/sas/sasautos/Table_column_details.sas"; */
61         
62         /* C00001: Addition of a deletion step for FORMATS catalog to avoid data corruption */
63         
64         proc sort data=dwhlib.partner_list out=partner_list nodupkey;
65         by partner_id;
66         run;
67         
68         proc sort data = whouse.partner_hierarchy_1_dedup OUT=partner_hierarchy_1_dedup nodupkey;
69          by BRANCH_ID;
70         run;
71         
72         PROC DATASETS LIB=FORMATS MT=CATALOG nolist;
11                                                         The SAS System                              11:30 Friday, January 8, 2016

73         	DELETE
74         		FORMATS
75         	;
76         quit;
77         
78         /* Formats by direct value enlisting - HIGH MAINTENANCE */
79         proc format library = FORMATS;
80         	value ACTION_TYPE
81         		3 = "Earn Reversal"
82         		4 = "Burn Reversal"
83         		1,5 = "Earn"
84         		2,6 = "Burn"
85         	;
86         quit;
87         
88         proc format library = FORMATS;
89         	value ACTION_SUB_TYPE
90         		3 = "Earn Reversal"
91         		4 = "Burn Reversal"
92         		1 = "Earn"
93         		5 = "Preallocated Earn"
94         		2 = "Burn"
95         		6 = "Preallocated Burn"
96         	;
97         quit;
98         
99         proc format library=FORMATS;
100        	VALUE fgprcd
101        	183 = "BRF"
102        	179 = "BBZ"
103        	181 = "FBZ"
104        	182 = "CTL"
105        	185 = "EZN"
106        	184 = "HTN"
107        	180 = "PTL"
108        	188 = "FUTBCOM"
109        	190 = "PTL3STR"
110        	191 = "PTL5STR"
111        	192 = "PTL7STR"
112        	193 = "EZOL"
113        	194 = "FH"
114        	197 = "PFO"
115        	200 = "FRT"
116        	205 = "FBB"
117        	223 = "IL" /* C00006 */
118        	OTHER = "PB N/W"
119        	;
120        quit;
121        
122        proc format library=FORMATS;
123        	VALUE fgpartcd
124        	179 = "BIG BAZAAR"
125        	180 = "PANTALOON"
126        	181 = "FOOD BAZAAR"
127        	182 = "CENTRAL"
128        	183 = "BRAND FACTORY"
129        	184 = "HOME TOWN"
130        	185 = "E ZONE"
12                                                         The SAS System                              11:30 Friday, January 8, 2016

131        	188 = "FUTURE BAZAAR"
132        	190 = "PANTALOON 3STAR"
133        	191 = "PANTALOON 5STAR"
134        	192 = "PANTALOON 7STAR"
135        	193 = "E ZONE ONLINE"
136        	194 = "FOOD HALL"
137        	197 = "PANTALOONS FACTORY OUTLET"
138        	200 = "FOOD RIGHT"
139        	205 = "FBB"
140        	223 = "INDUSLEAGUE"
141        
142        	OTHER = "PB N/W"
143        	;
144        run;
145        
146        proc format library=FORMATS;
147        	VALUE fgpid2lmid
148        	179 = 90012965
149        	180 = 90012972
150        	181 = 90012969
151        	182 = 90012967
152        	183 = 90012966
153        	184 = 90012971
154        	185 = 90012968
155        	188 = 90012970
156        	190 = 90012972
157        	191 = 90012972
158        	192 = 90012972
159        	193 = 90012968
160        	194 = 90013041
161        	197 = 90013564
162        	200 = 90013625
163        	205 = 90013505
164        	223 = 90014145
165        	;
166        quit;
167        
168        proc format library=FORMATS;
169        	VALUE $ fgpart2lmid
170        	"BIG BAZAAR" = 90012965
171        	"PANTALOONS" = 90012972
172        	"FOOD BAZAAR" = 90012969
173        	"CENTRAL" = 90012967
174        	"BRAND FACTORY" = 90012966
175        	"HOME TOWN" = 90012971
176        	"E ZONE" = 90012968
177        	"PANTALOON 3STAR" = 90012972
178        	"FUTURE BAZAAR" = 90012970
179        	"PANTALOON 5STAR" = 90012972
180        	"PANTALOON 7STAR" = 90012972
181        	"PANTALOON" = 90012972
182        	"E ZONE ONLINE" = 90012968
183        	"FOOD HALL" = 90013041
184        	"FBB" = 90013505
185        	"PANTALOONS FACTORY OUTLET" = 90013564
186        	"FOOD RIGHT" = 90013625
187        	"INDUSLEAGUE" = 90014145
188        	;
13                                                         The SAS System                              11:30 Friday, January 8, 2016

189        quit;
190        
191        PROC FORMAT library=formats;
192        	value $ citygrp
193        	'MUMBAI'='MUMBAI'
194        	'DELHI'='DELHI'
195        	'HYDERABAD' = 'HYDERABAD'
196        	'KOLKATA' = 'KOLKATA'
197        	'AHMEDABAD' = 'AHMEDABAD'
198        	'PUNE' = 'PUNE'
199        	'BANGALORE' = 'BANGALORE'
200        	'CHENNAI' = 'CHENNAI'
201        	OTHER = 'OTHERS'	
202        	;
203        QUIT;
204        
205        PROC FORMAT library = formats;
206        	VALUE AGEGRP
207        	low-17 = '< 18'
208        	18-25 = '18-25'
209        	26-30 = '26-30'
210        	31-40 = '31-40'
211        	41-45 = '41-45'
212        	46-50 = '46-50'
213        	51-60 = '51-60'
214        	61-70 = '61-70'
215        	other = 'N/A'
216        	;
217        quit;
218        
219        proc format;
220        	value $ KPINAME
221        		"UNIQ_MEMCNT" = "# of Unique Members transacted"
222        		"uniq_memcnt" = "# of Unique Members transacted"
223        		"TOTAL_BRCH_SALES" = "Total value of Earn tranx"
224        		"num_earns" = "# of Earn Transactions"
225        		"NUM_EARNS" = "# of Earn Transactions"
226        		"num_burns" = "# of Redemptions"
227        		"NUM_BURNS" = "# of Redemptions"
228        		"POINTS_EARNS" = "Total points issued"
229        		"points_earns" = "Total points issued"
230        		"POINTS_BURNS" = "Total points redeemed"
231        		"points_burns" = "Total points redeemed"
232        		"num_earn_revs" = "# of Earn Rev. activities"
233        		"NUM_EARN_REVS" = "# of Earn Rev. activities"
234        		"POINTS_EARN_REVS" = "Total earn points reversed"
235        		"points_earn_revs" = "Total earn points reversed"
236        		"TOTAL_PB_BILLS" = "Total PB Bills"
237        		"total_pb_bills" = "Total PB Bills"
238        	;
239        quit;
240        
241        proc format library = formats;
242        	value $ fgcmbine (DEFAULT=20)
243        	"BIG BAZAAR-NWG" = "BIGBAZAAR"
244        	"BIG BAZAAR-SE" = "BIGBAZAAR"
245        	"FOOD BAZAAR-NWG" = "FOODBAZAAR"
246        	"FOOD BAZAAR-SE" = "FOODBAZAAR"
14                                                         The SAS System                              11:30 Friday, January 8, 2016

247        	;
248        run;
249        
250        /*
251        	Based on:
252        		1	PERMANENT
253        		2	TEMPORARY
254        		3	NOT CARDED
255        		4	RETAIL CARDS
256        		5	VIRTUAL CARDS
257        */
258        
259        proc format library = FORMATS;
260        	value card_sub_type
261        		1 = "PERMANENT"
262        		2 =	"TEMPORARY"
263        		3 =	"NOT CARDED"
264        		4 =	"RETAIL CARDS"
265        		5 =	"VIRTUAL CARDS"
266        	;
267        quit;
268        
269        /* C00002 */
270        proc format LIBRARY = FORMATS;
271        	value CARD_TYPE
272        		1,5="CARDED"
273        		2,3,4="NON-CARDED"
274        	;
275        quit;
276        
277        
278        PROC FORMAT library = formats;
279        	value card_type_prec
280        		1 = 1
281        		2 = 3
282        		3 = 4
283        		4 = 2
284        		5 = 5
285        	;
286        quit;
287        
288        
289        Proc format library = formats;
290               Value SEG_AFFLUENT_PB
291                  1 = "Royal Redeemer"
292                  2 =  "Affluent"
293                  3 =  "Big Ticket Spenders"
294                  4 =  "Enthusiast FG"
295                  5 =  "Low Enthusiast FG"
296              ;
297        quit;
298        
299        proc format library=formats;
300               value pts2slab
301                      low-0 = "0"
302                      1-200 = ">0 to 200"
303                      201-1000 = ">200 to 1000"
304                      1001-2000 = ">1000 to 2000"
15                                                         The SAS System                              11:30 Friday, January 8, 2016

305                      2001-4000 = ">2000 to 4000"
306                      4001-5000 = ">4000 to 5000"
307                      5001-8000 = ">5000 to 8000"
308                      8001-10000 = ">8000 to 10000"
309                      10001-12000 = ">10000 to 12000"
310                      12001-50000 = ">12000 to 50000"
311                      50001-100000= ">50000 to 100000"
312                      100001-high= ">100000"
313               ;
314        quit;
315        
316        /* C00003 */
317        Proc format library=formats;
318             value ptsvd
319                   low-0 = "0"
320                   1-49 = ">1 to 49"
321                   50-199 = ">50 to 199"
322                   200-499 = ">200 to 499"
323                   500-999 = ">500 to 999"
324                   1000-high = ">1000"
325             ;
326        quit;
327        
328        /* C00003 */
329        proc format library=formats;
330             value RFMTPTS
331                   0 = '0'
332                   1-49 = '1-49'
333                   50-199 = '50-199'
334                   200-499 = '200-499'
335                   500-999 = '500-999'
336                   1000-high = '1000+'
337             ;
338        quit;
339        
340        proc format library=formats;
341        	value pts4slab
342        		low-0 = "0"
343        		1-200 = ">0 to 200"
344        		201-1000 = ">200 to 1000"
345        		1001-2000 = ">1000 to 2000"
346        		2001-4000 = ">2000 to 4000"
347        		4001-high = ">4000"
348        	;
349        quit;
350        
351        proc format LIBRARY = FORMATS;
352        	value age
353        	15-21	=	"15-21"
354        	22-29	=  	"22-29"
355        	30-39	=	"30-39"
356        	40-55	=	"40-55"
357        	56-high	=	"56 +"
358        	other 	= 	"N/A"
359        ;
360        run;
361        quit;
362        
16                                                         The SAS System                              11:30 Friday, January 8, 2016

363        
364        /* Based on PID_ENROLMENT, which is a result of formatted promo_code_id by PID2PART format */
365        PROC FORMAT LIBRARY = FORMATS;
366        	VALUE $ ENRGRP
367        	"BIGBAZAAR" = "BIGBAZAAR"
368        	"FOODBAZAAR" = "FOODBAZAAR"
369        	"CENTRAL" = "CENTRAL"
370        	"BRANDFACTORY" = "BRANDFACTORY"
371        	"HOMETOWN" = "HOMETOWN"
372        	"EZONE" = "EZONE"
373        	"FUTUREBAZAAR" = "FUTUREBAZAAR"
374        	"PANTALOONS" = "PANTALOONS"
375        	"FOODHALL" = "FOODHALL"
376        	"FBB" = "FBB"
377        	"INDUSLEAGUE" = "INDUSLEAGUE" /* Adding INDUSLEAGUE to list of enrolments (C00006) */
378        	"FOODRIGHT" = "FOODRIGHT"
379        	"ICICIBANKDEBIT" = "ICICIDEBIT"
380        	"ICICIBANKCREDIT" = "ICICICREDIT"
381        	"ICICIOTHERS" = "ICICIOTHERS"
382        	"HPCL" = "HPCL"
383        	"MEGAMART" = "MEGAMART"
384        	"MMT" = "MMT"
385        	"MKRETAIL" = "MKRETAIL"
386        	"UNIVERCELL" = "UNIVERCELL"
387        	"B2E FIDELITY" = "B2E"
388        	"B2E MINDTREE" = "B2E"
389        	"B2E HCL" = "B2E"
390        	"B2E METLIFE" = "B2E"
391        	"B2E UBG" = "B2E"
392        	"B2E COGNIZANT" = "B2E"
393        	"B2E NESS" = "B2E"
394                "VF_POSTPAID"= "VODAFONE"
395                 "VF_PREPAID"= "VODAFONE"
396        	OTHER = "PB N/W"
397        
398        	;
399        quit;
400        
401        /* Based on P_COMMERCIAL_NAME, which is a result of formatted partner_id by PART2NM format */
402        PROC FORMAT LIBRARY = FORMATS;
403        	VALUE $ PARTGRP
404        	"BIGBAZAAR" = "BIGBAZAAR"
405        	"FOODBAZAAR" = "FOODBAZAAR"
406        	"CENTRAL" = "CENTRAL"
407        	"BRANDFACTORY" = "BRANDFACTORY"
408        	"HOMETOWN" = "HOMETOWN"
409        	"EZONE" = "EZONE"
410        	"EZONEONLINE" = "EZONEONLINE"
411        	"FUTUREBAZAAR" = "FUTUREBAZAAR"
412        	"PANTALOONS" = "PANTALOONS"
413        	"FOODHALL" = "FOODHALL"
414        	"FOODRIGHT" = "FOODRIGHT"
415        	"FBB" = "FBB"
416        	"INDUSLEAGUE" = "INDUSLEAGUE" /* C00006 */
417        	"HPCL" = "HPCL"
418        	"MEGAMART" = "MEGAMART"
419        	"MMT" = "MMT"
420        	"MMT_BUS" = "MMT"
17                                                         The SAS System                              11:30 Friday, January 8, 2016

421        	"MMT_DOM_AIR_TCKT" = "MMT"
422        	"MMT_AIRTKT" = "MMT"
423        	"MMT_HOTELS" = "MMT"
424        	"MMT_DOM_PKG" = "MMT"
425        	"MMT_INTL_PKG" = "MMT"
426        	"MMT_INTL_AIR_TCKT" = "MMT"
427        	"MAKEMYTRIP(INDIA)PVT.LTD." = "MMT"
428        	"MKRETAIL" = "MKRETAIL"
429        	"UNIVERCELL" = "UNIVERCELL"
430        	"ICICIBANKCREDIT" = "ICICICREDIT"
431        	"ICICIBANKDEBIT" = "ICICIDEBIT"
432        	"ICICIOTHERS" = "ICICIOTHERS"
433        	"BOOKMYSHOW" = "BOOKMYSHOW"
434        	"PLANETSPORTS"  =  "PLANETSPORTS"   /* added below 7 partners on 26-10-2012 */
435        	"BABYOYE"  =  "BABYOYE"
436        	"EDABBA"  =  "EDABBA"
437        	"FIRSTCRY"  =  "FIRSTCRY"
438        	"KOOVS"  =  "KOOVS"
439        	"PERFUME2ORDER"  =  "PERFUME2ORDER"
440        	"SURATDIAMOND"  =  "SURATDIAMOND"
441        	"VALYOO"  =  "VALYOO"
442                "VF_POSTPAID"= "VODAFONE"
443                 "VF_PREPAID"="VODAFONE"
444        	OTHER = "PB N/W"
445        	;
446        quit;
447        
448        /* ----------- Added on 31-10-2012 -- Partner wise Shortcuts ----------- */
449        
450        PROC FORMAT;
451        VALUE $PARTNER2SCT
452        		"BIGBAZAAR"		=		"FG_BBZ"
453        		"FOODBAZAAR"	=		"FG_FOB"
454        		"CENTRAL"		=		"FG_CTL"
455        		"BRANDFACTORY"	=		"FG_BF"
456        		"HOMETOWN"		=		"FG_HTN"
457        		"EZONE"			=		"FG_EZ"
458        		"FUTUREBAZAAR"	=		"FG_FUB"
459        		"PANTALOONS"	=		"FG_PL"
460        		"FOODHALL"		=		"FG_FHL"
461        		"FOODRIGHT"		=		"FG_FRT"
462        		"FBB"			=		"FG_FBB"
463        		"INDUSLEAGUE"                 =         "FG_IL" /* C00006 */
464        		"HPCL"			=		"HPCL"
465        		"MEGAMART"		=		"MM"
466        		"MMT"			=		"MMT"
467        		"MKRETAIL"		=		"MKR"
468        		"UNIVERCELL"	=		"UNI"
469        		"ICICICREDIT"	=		"ICICR"
470        		"ICICIDEBIT"	=		"ICIDE"
471        		"ICICIOTHERS"	=		"PBN"
472        		"BOOKMYSHOW"	=		"BMS"
473        		"PB N/W"		=		"PBN"
474        		"PLANETSPORTS"  =   	"PLASP"
475        		"BABYOYE"   	=   	"BABOY"
476        		"EDABBA"   		=   	"EDB"
477        		"FIRSTCRY"   	=   	"FICR"
478        		"KOOVS"   		=   	"KOO"
18                                                         The SAS System                              11:30 Friday, January 8, 2016

479        		"PERFUME2ORDER" = 		"PER"
480        		"SURATDIAMOND"  =   	"SUR"
481        		"VALYOO"   		=   	"VALY"
482        ;
483        quit;
484        
485        proc format;
486        	value $ metro
487        	"KOLKATA" = "METRO"
488        	"DELHI" = "METRO"
489        	"NEW DELHI" = "METRO"
490        	"MUMBAI" = "METRO"
491        	"CHENNAI" = "METRO"
492        	"PUNE" = "METRO"
493        	"HYDERABAD" = "METRO"
494        	"BANGALORE" = "METRO"
495        	"BENGALURU" = "METRO"
496        	"BANGLORE" = "METRO"
497        	OTHER = "NON-METRO"
498        	;
499        quit;
500        
501        
502        proc format library=formats;
503        	value KYCFLG
504        		1 = "ACCEPTED COMPLETE"
505        		2 = "ACCEPTED INCOMPLETE (EML/ADDR)"
506        		3 = "ACCEPTED INCOMPLETE (BOTH)"
507        		4 = "NOT UPDATED"
508        	;
509        quit;
510        
511        PROC FORMAT;
512        	VALUE TRANTYPE
513        		8,295="SWIPE EARN"
514        		OTHER="NON-SWIPE EARN"
515        	;
516        QUIT;
517        
518        /* For Adhoc Request for FG reporting */
519        proc format library=formats;
520        	value pts4fg
521        		low-0 = "0"
522        		1-200 = ">0 to 200"
523        		201-1000 = ">200 to 1000"
524        		1001-2000 = ">1000 to 2000"
525        		2001-4000 = ">2000 to 4000"
526        		4001-5000 = ">4000 to 5000"
527        		5000-10000 = ">5000 to 10000"
528        		10000-high = ">10000"
529        	;
530        run;
531        
532        /*MMT FormatS*/
533        
534        proc format library = FORMATS;
535        	value memtype
536        	167 = "ROYALE"
19                                                         The SAS System                              11:30 Friday, January 8, 2016

537        		166 = "ELITE"
538        		2,168 = "CLASSIC"
539        
540        	;
541        quit;
542        
543        
544        proc format library = FORMATS;
545        	value MOMtype
546        	201111 = "NOV11"
547        	201112 = "DEC11"
548        	201201 = "JAN12"
549        	201202= "FEB12"
550        	201203= "MAR12"
551        	201204 = "APR12"
552        	201205= "MAY12"
553        	201206= "JUN12"
554        	201207= "JUL12"
555        	201208= "AUG12"
556        	201209= "SEP12"
557        	;
558        quit;
559        
560        PROC FORMAT ;
561        		VALUE EC_TYPE
562        				1 =	"Offline Offer"
563        				2 =	"Online Offer";
564        		
565        quit;
566        
567        /* For accessing the Character variables(RFV, Evolution Segments,Reachability)
568        	in ALL_MEMBERS_SEGMENTS_FILE */
569        /*C00007*/
570        proc format library = FORMATS;
571        		value SEG_RFV_FRL
572        	1 ="REGULAR_BIG_TROLLEY"
573        	2 ="REGULAR_MEDIUM_TROLLEY"
574        	3 ="REGULAR_LOW_TROLLEY"
575        	4 ="ONE_TIME_HIGH_VALUE"
576        	5 ="ONE_TIME_LOW_VALUE"
577        	6 ="CASUAL_HIGH_VALUE"
578        	7 ="CASUAL_LOW_VALUE"
579        	8 ="BIGBAZAAR NEW CUSTOMER"
580        	9 ="BIGBAZAAR INACTIVE"
581        	10 ="BIGBAZAAR LAPSER"
582        	;
583        		VALUE SEG_RFV_CEN
584        	1 ="Central Platinum"
585        	2 ="Central Gold"
586        	3 ="Central Silver"
587        	4 ="Central Active"
588        	5 ="Central Never active"
589        	;
590        		VALUE SEG_RFV_BF
591        	1 ="HIGH SPENDERS"
592        	2 ="REGULAR SHOPPERS"
593        	3 ="NASCENT SHOPPER"
594        	4 ="BF NEW CUSTOMER"
20                                                         The SAS System                              11:30 Friday, January 8, 2016

595        	5 ="HIBERNATORS"
596        	;
597        	
598        		VALUE SEG_EVOLUTION_VI
599        	1 ="ADVO"
600        	2 ="ENTH"
601        	3 ="KN_ICI_MP"
602        	4 ="KN_ICI_SP"
603        	5 ="KNOWER_MP"
604        	6 ="KNOWER_SP"
605        	7 ="BY_ICI_SP"
606        	8 ="BY_ICICI_MP"
607        	9 ="BY_MP"
608        	10 ="BY_SP"
609        	11 ="INACTIVE"
610        	;
611        		
612        
613        		VALUE SEG_LIFESTAGE
614        	1="A.PENSION(>=60)"
615        	2="B.Single_MEN(<=30)"
616        	3="C.Single_WOMEN(<=30)"
617        	4="D.YOUNG_COUPLES(<=30)"
618        	5="F.COUPLES(30-45)"
619        	6="G.COUPLE_KID(30-45)"
620        	7="H.Single_MEN(30-45)"
621        	8="I.Single_WOMEN(30-45)"
622        	9="K.Mature_COUPLE_KID(45-60)"
623        	10="L.Single_MEN(45-60)"
624        	11="M.Single_WOMEN(45-60)"
625               12="E.YOUNG_COUPLE_KID(<=30)"
626        	;
627        		VALUE SEG_EVOLUTION_VII
628        	7="Cursory_shoppers"
629        	6="Single_LOB_enthusiasts"
630        	5="Single_LOB_Loyalists"
631        	4="Two_Dipping_cross_User"
632        	3="Two_Format_Enthusiasts"
633        	2="Enthusiasts"
634        	1="Advocates"
635        	;
636        
637        		VALUE SEG_WOMEN
638        	1="1. BigBazaar Loyalists"
639        	2="2. Ready to eat Shoppers"
640        	3="3. Groceries & Staples Shoppers"
641        	4="4. Non Essentials Shoppers"
642        	5="5. Random Shoppers"
643        	;
644        
645        
646        value seg_wallet
647        1="HIGHEST"
648        2="HIGH"
649        3="AVERAGE"
650        4="LOW"
651        5="LOWEST"
652        ;
21                                                         The SAS System                              11:30 Friday, January 8, 2016

653        value CEN_TIER_MGMNT
654        1="1 LEVEL UP"
655        2="2 LEVEL UP"
656        3="3 LEVEL UP"
657        4="HOLD"
658        5="1 LEVEL DOWN"
659        6="2 LEVEL DOWN"
660        7="3 LEVEL DOWN"
661        ;
662        
663        run;
664        
665        
666        /* Format based on datasets - FORMAT LOOKUP (recommended method for format creation) */
667        
668        
669        data MEMBER_CARD_LOGO_MAP;
670        	format label $10.;
671        	retain fmtname "CDLOGOMP" type "N";
672        	set DWHLIB.MST_MEMBER_CARD_TYPE;
673        	start = MEMBER_CARD_TYPE_ID;
674        	label = MEMBER_CARD_TYPE_DESC;
675        run;
676        
677        proc format cntlin = MEMBER_CARD_LOGO_MAP library = FORMATS;
678        quit;
679        
680        
681        /* FG Week definition */
682        data _null_;
683        	call symput("curr_year", YEAR("&SYSDATE"D));
684        run;
685        
686        %put &curr_year.;
687        
688        %INCLUDE "/sasdata/core_etl/prod/FG/sasautos/generate_fg_calendar.sas" /source2;
689        %generate_fg_calendar(base_year=2011, outdsn=whouse.fg_week_calendar_%cmpres(&curr_year.));
690        
691        data fg_temp;
692        	format label $10.;
693        	retain fmtname "FGWEEK" type "N";
694        	set whouse.fg_week_calendar_%cmpres(&curr_year.);
695        	start = activity_date;
696        	label = "Week # " || put(week,3.);
697        run;
698        
699        proc format cntlin = fg_temp library = FORMATS;
700        run;
701        
702        /* FG fiscal month for the fiscal year 2011-12 */
703        proc format library = formats;
704        	value fg_wk_mth_map
705        		1-4 = "JUL2011"
706        		5-8 = "AUG2011"
707        		9-13 = "SEP2011"
708        
709        		14-17 = "OCT2011"
710        		18-21 = "NOV2011"
22                                                         The SAS System                              11:30 Friday, January 8, 2016

711        		22-26 = "DEC2011"
712        
713        		27-30 = "JAN2012"
714        		31-34 = "FEB2012"
715        		35-39 = "MAR2012"
716        
717        		40-43 = "APR2012"
718        		44-47 = "MAY2012"
719        		48-52 = "JUN2012"
720        	;
721        run;		
722        
723        data fg_temp2;
724        	format label 8.;
725        	retain fmtname "FGWEEKN" type "N";
726        	set whouse.fg_week_calendar_%cmpres(&curr_year.);
727        	start = activity_date;
728        	label = week;
729        run;
730        
731        proc format cntlin = fg_temp2 library = WORK;
732        run;
733        
734        data active_status_temp;
735        	retain fmtname "fmtactstat" type "N";
736        	set dwhlib.mst_active_status;
737        	START = active_status_id;
738        	label = active_status_desc;
739        run;
740        
741        proc format lib=formats cntlin=active_status_temp;
742        run;
743        
744        /* Formats out of datasets */
745        
746        proc sort data = dwhlib.mst_association out=SUPPLIB.AID_LIST NODUPKEY;
747        	by ASSOCIATION_ID;
748        run;
749        
750        data TEMP_AID;
751        	RETAIN FMTNAME "AID2CODE" type "N";
752        	set supplib.aid_list;
753        	WHERE ASSOCIATION_ID ~= .;
754        	start = association_id;
755        	label = ASSOCIATION_CODE;
756        run;
757        
758        proc format cntlin = temp_AID library = formats;
759        run;
760        	
761        proc sort data = dwhlib.mst_sourced_association out=SUPPLIB.SID_LIST NODUPKEY;
762        	by SOURCED_ASSOCIATION_ID;
763        run;
764        
765        data TEMP_SID;
766        	RETAIN FMTNAME "SID2DESC" type "N";
767        	set supplib.sid_list;
768        	start = sourced_association_id;
23                                                         The SAS System                              11:30 Friday, January 8, 2016

769        	label = SOURCED_ASSOCIATION_DESC;
770        run;
771        
772        proc format cntlin = temp_SID library = formats;
773        run;
774        
775        
776        proc sort data = dwhlib.mst_sourced_association out=SUPPLIB.SID_LIST_2 NODUPKEY;
777        	by SOURCED_ASSOCIATION_ID;
778        run;
779        
780        data TEMP_SID_2;
781        	RETAIN FMTNAME "SID2CODE" type "N";
782        	set supplib.sid_list_2;
783        	start = sourced_association_id;
784        	label = SOURCED_ASSOCIATION_CODE;
785        run;
786        
787        proc format cntlin = temp_SID_2 library = formats;
788        run;
789        
790        
791        proc sort data = dwhlib.mst_promo_codes out=SUPPLIB.PID_LIST NODUPKEY;
792        	by PROMO_CODE_ID;
793        run;
794        
795        data TEMP_PID;
796        	RETAIN FMTNAME "PID2DESC" type "N";
797        	set SUPPLIB.PID_LIST;
798        	start = PROMO_CODE_ID;
799        	label = PROMO_CODE_DESC;
800        run;
801        
802        
803        proc format cntlin = temp_PID library = formats;
804        run;
805        
806        proc sort data = dwhlib.mst_promo_codes out=SUPPLIB.PID_LIST_2 NODUPKEY;
807        	by PROMO_CODE_ID;
808        run;
809        
810        data TEMP_PID_2;
811        	RETAIN FMTNAME "PID2CODE" type "N";
812        	set SUPPLIB.PID_LIST_2;
813        	start = PROMO_CODE_ID;
814        	label = PROMO_CODE;
815        run;
816        
817        proc format cntlin = temp_PID_2 library = formats;
818        run;
819        
820        proc sort data = dwhlib.mst_member_card_type out=SUPPLIB.MEM_CARD_TYPE_LIST NODUPKEY;
821        	by  MEMBER_CARD_TYPE_ID;
822        run;
823        
824        data TEMP_MCTID;
825        	RETAIN FMTNAME "MCT2DESC" type "N";
826        	set SUPPLIB.MEM_CARD_TYPE_LIST;
24                                                         The SAS System                              11:30 Friday, January 8, 2016

827        	start = MEMBER_CARD_TYPE_ID;
828        	label = MEMBER_CARD_TYPE_DESC;
829        run;
830        
831        proc format cntlin = temp_MCTID library = formats;
832        run;
833        
834        
835        data branch;
836        	RETAIN FMTNAME "BRCHNM" TYPE "N";
837        	set partner_hierarchy_1_dedup (keep=LEGAL_NAME STAR_BRANCH_ID);
838        	START=STAR_BRANCH_ID;
839        	LABEL = LEGAL_NAME;
840        run;
841        
842        proc format cntlin = BRANCH LIBRARY = FORMATS;
843        run;
844        
845        /*ECOUPONE FORMAT FOR COMM_CHANNEL*/
846        
847        DATA ECOUPON.MST_ECOUPON_COMM_CHANNEL;
848        SET ECOUPON.EC_CHANNEL (keep=Channel_Code Channel_Name rename=(Channel_Code = Start CHANNEL_NAME = label)) end=last;
849        RETAIN fmtname  "ECOUPON_COMM_CHANNEL" TYPE 'N';
850        OUTPUT;
851           if last then do;
852              hlo='O';
853              label='Other Channel';
854              output;
855           end;
856        run;
857        proc format lib=FORMATS cntlin=ECOUPON.MST_ECOUPON_COMM_CHANNEL;
858        RUN;
859        
860        
861        
862        
863        
864        /* LMID to PARTNER_ID lookup */
865        data lookup1;
866        	retain fmtname "LMID2PID" TYPE "C";
867        	set dwhlib.dim_partner (keep=partner_id loyalty_partner_id where=(loyalty_partner_id ~= ""));
868        	start = LOYALTY_PARTNER_ID;
869        	label = PARTNER_ID;
870        run;
871        
872        proc format CNTLIN=WORK.LOOKUP1 library = FORMATS;
873        run;
874        
875        /* PARTNER_ID TO LMID lookup */
876        data lookup2;
877        	retain fmtname "PID2LMID" TYPE "N";
878        	set dwhlib.dim_partner (keep=partner_id loyalty_partner_id);
879        	start = PARTNER_ID;
880        	label = LOYALTY_PARTNER_ID;
881        run;
882        
883        
884        proc format CNTLIN=WORK.LOOKUP2 library = FORMATS;
25                                                         The SAS System                              11:30 Friday, January 8, 2016

885        run;
886        
887        /* PARTNER_ID TO PARTNER_TYPE FORMAT LOOKUP */
888        
889        data partner_temp;
890        	retain fmtname "part2typ" type "N";
891        	set partner_list;
892        	start=partner_id;
893        	label=partner_type;
894        run;
895        
896        proc format cntlin=partner_temp library=formats;
897        run;
898        
899        /* PARTNER_ID TO PARTNER NAME (P_COMMERCIAL_NAME) FORMAT LOOKUP */
900        
901        data partner_temp2;
902        	retain fmtname "part2nm" type "N";
903        	set partner_list end=EOF;
904        	
905        	start=partner_id;
906        	label=p_commercial_name;
907        	output;
908        	if EOF then do;
909        		hlo="O";
910        		label="OTHERRETAIL";
911        		output;
912        	end;
913        run;
914        
915        proc format cntlin=partner_temp2 library=formats;
916        run;
917        
918        /* Promo code id to partner (consolidated) */
919        data pid_temp;
920        	retain fmtname "pid2part" type "N";
921        	set supplib.pid2partner end=EOF;;
922        	start=promo_code_id;
923        	label=promo_partner;
924        	output;
925        	if EOF then do;
926        		hlo="O";
927        		label="OTHERRETAIL";
928        		output;
929        	end;
930        run;
931        	
932        proc format cntlin=pid_temp library=formats;
933        run;
934        
935        /* Sourced Association id to partner (consolidated) */
936        data sid_temp;
937        	retain fmtname "sid2part" type "N";
938        	set supplib.sid2partner end=EOF;
939        	start=sourced_association_id;
940        	label=sourced_partner;
941        	output;
942        	if EOF then do;
26                                                         The SAS System                              11:30 Friday, January 8, 2016

943        		hlo="O";
944        		label="OTHERRETAIL";
945        		output;
946        	end;
947        run;
948        	
949        proc format cntlin=sid_temp library=formats;
950        run;
951        
952        
953        /* Board KPI partner list preparation */
954        
955        proc sort data = supplib.board_kpi_partner_list out = board_kpi_plist nodupkey;
956        	by board_kpi_partner p_commercial_name;
957        run;
958        
959        data board_kpi_hash;
960        	retain fmtname "part2brd" type "C";
961        	set board_kpi_plist end=EOF;
962        
963        	IF p_commercial_name = "FIRSTCRY" and board_kpi_partner in ("OTHERS") THEN DELETE;
964        	IF p_commercial_name ="OTHERRETAIL" and board_kpi_partner in ("ONLINE") then delete;
965        
966        	start=p_commercial_name;
967        	label=board_kpi_partner;
968        	output;
969        	if EOF then do;
970        		hlo="O";
971        		label="OTHERS";
972        		output;
973        	end;
974        run;
975        	
976        proc format cntlin = board_kpi_hash library = formats;
977        quit;
978        
979        /* Old to New MC code mappings */
980        
981        DATA mc_temp;
982        	set supplib.Mc_level_mba_bigbazaar_mar_13;
983        	DEP_NAME = STRIP(UPCASE(DEP_NAME));
984        RUN;
985        
986        proc sort data = MC_TEMP nodupkey;
987        	by DEP_NAME;
988        run;
989        
990        data mc_temp;
991        	retain fmtname "old2nwmc" type "C";
992        	set MC_TEMP end=EOF;
993        		BY DEP_NAME;
994        	start=strip(upcase(DEP_NAME));
995        	label=strip(upcase(name));
996        	output;
997        	if EOF then do;
998        		hlo="O";
999        		label="OTHER";
1000       		output;
27                                                         The SAS System                              11:30 Friday, January 8, 2016

1001       	end;
1002       run;
1003       	
1004       proc format cntlin=mc_temp library=formats;
1005       run;
1006       
1007       /* Basket item to description mapping */
1008       
1009       proc sort data = supplib.fg_mc_code_to_desc out = basket_temp nodupkey;
1010       	by mc_code mcnew;
1011       run;
1012       
1013       proc sort data = basket_temp nodupkey;
1014       	by mc_code;
1015       run;
1016       
1017       data basket_desc;
1018       	RETAIN FMTNAME "MC_CODE2DESC" TYPE "C";
1019       	set basket_temp(keep=mc_code mcnew);
1020       	START = MC_CODE;
1021       	LABEL=strip(upcase(MCNEW));
1022       run;
1023       
1024       proc format library = formats cntlin=basket_desc;
1025       quit;
1026       
1027       
1028       /* Branch ID to Store Name lookup */
1029       
1030       proc sort data = partner_hierarchy_1_dedup(keep=LEGAL_NAME BRANCH_ID) OUT=BRCH2STR_INPUT nodup;
1031       	by BRANCH_ID;
1032       run;
1033       
1034       data BRCH2STR;
1035       	RETAIN FMTNAME "brch2str" type "C";
1036       	SET BRCH2STR_INPUT end=eof;
1037       	WHERE
1038       		not (strip(branch_id) = "6535" and strip(upcase(legal_name)) LIKE '%HYDERABAD%');
1039       
1040       	legal_name = strip(upcase(legal_name));
1041       
1042       	
1043       
1044       	if strip(upcase(branch_id)) ~= "ONLINE" then do;
1045       		start = branch_id;
1046       		label = legal_name;
1047       		output;
1048       	end;
1049       	
1050       	if eof and strip(branch_id) ~= "" then do;	
1051       		hlo="O";
1052       		label="OTHER";
1053       		output;	
1054       	end;
1055       run;
1056       
1057       proc sort data = brch2str nodup;
1058       	by BRANCH_ID;
28                                                         The SAS System                              11:30 Friday, January 8, 2016

1059       run;
1060       
1061       proc format cntlin = BRCH2STR library = formats;
1062       quit;
1063       
1064       
1065       /* Basket level - MC CODE TO DESC Lookup */
1066       
1067       data basket_lkp;
1068       	retain fmtname 'bsktmc2desc' type 'C';
1069       	set supplib.basket_mc_code_2_desc end=eof;
1070       	START = dep_code;
1071       	LABEL = dep_name;
1072       	output;
1073       	if eof then do;
1074       		HLO="O";
1075       		label = "OTHERS";
1076       		output;
1077       	end;
1078       run;
1079       
1080       proc sort data = basket_lkp nodupkey;
1081       	by dep_code;
1082       run;
1083       
1084       proc format cntlin=basket_lkp library = formats;
1085       run;
1086       
1087       
1088       /* Store code to City */
1089       data store_temp;
1090       	RETAIN fmtname 'fgstr2cy' TYPE 'C';
1091       	set partner_hierarchy_1_dedup;
1092       	where
1093       /*		STRIP(UPCASE(branch_id)) not in ("ONLINE") */
1094       /*		and */
1095       		length(strip(branch_id)) <= 4
1096       	;
1097       	if length(strip(branch_id)) = 4 then do;
1098       		start = strip(put(input(branch_id, 4.), 4.));
1099       		label = strip(upcase(branch_city));
1100       		output;
1101       	end;
1102       	if length(strip(branch_id)) = 3 then do;
1103       		start = strip(put(input(branch_id, 4.), z4.));
1104       		label = strip(upcase(branch_city));
1105       		output;
1106       		start = strip(put(input(branch_id, 4.), 4.));
1107       		label = strip(upcase(branch_city));
1108       		output;
1109       	end;
1110       run;
1111       
1112       proc sort data = STORE_TEMP NODUPKEY;
1113       	BY start;
1114       RUN;
1115       
1116       proc format library = formats cntlin = store_temp;
29                                                         The SAS System                              11:30 Friday, January 8, 2016

1117       run;
1118       
1119       /* Store code to Zone */
1120       data store_temp_z;
1121       	RETAIN fmtname 'fgstr2zn' TYPE 'C';
1122       	set partner_hierarchy_1_dedup;
1123       	where
1124       /*		STRIP(UPCASE(branch_id)) not in ("ONLINE") */
1125       /*		and */
1126       		length(strip(branch_id)) <= 4
1127       	;
1128       	if length(strip(branch_id)) = 4 then do;
1129       		start = strip(put(input(branch_id, 4.), 4.));
1130       		label = strip(upcase(zone));
1131       		output;
1132       	end;
1133       	if length(strip(branch_id)) = 3 then do;
1134       		start = strip(put(input(branch_id, 4.), z4.));
1135       		label = strip(upcase(zone));
1136       		output;
1137       		start = strip(put(input(branch_id, 4.), 4.));
1138       		label = strip(upcase(zone));
1139       		output;
1140       	end;
1141       run;
1142       
1143       proc sort data = STORE_TEMP_z NODUPKEY;
1144       	BY start;
1145       RUN;
1146       
1147       proc format library = formats cntlin = store_temp_z;
1148       run;
1149       
1150       
1151       /* Store code to Legal Name */
1152       data store_temp1;
1153       	RETAIN fmtname 'fgstr2nm' TYPE 'C';
1154       	set partner_hierarchy_1_dedup;
1155       	where
1156       		STRIP(UPCASE(branch_id)) not in ("ONLINE") and length(strip(branch_id)) ~= 6;
1157       	start = branch_id;
1158       	label = strip(upcase(legal_name));
1159       run;
1160       
1161       proc sort data = STORE_TEMP1 NODUPKEY;
1162       	BY BRANCH_ID;
1163       RUN;
1164       
1165       proc format library = formats cntlin = store_temp1;
1166       QUIT;
1167       
1168       
1169       /* transaction type  -- not activity_action_id */
1170       
1171       proc sort data = DWHLIB.MST_activity_TRANS_TYPE out=WORK.TRANSACTION_TYPE NODUPKEY;
1172       	by ACTIVITY_transaction_type_id descending update_date descending add_date;
1173       run;
1174       
30                                                         The SAS System                              11:30 Friday, January 8, 2016

1175       DATA WORK.TRANSACTION_TYPE;
1176       	RETAIN fmtname 'TRNTYP2DESC' type 'N';
1177       	SET WORK.TRANSACTION_TYPE;
1178       	start = activity_transaction_type_id;
1179       	LABEL = activity_transaction_desc;
1180       run;
1181       
1182       proc format cntlin=WORK.TRANSACTION_TYPE Library=FORMATS;
1183       run;
1184       
1185       /* Redeem_channel_id to redeem_channel_name */
1186       
1187       proc sort data = DWHLIB.MST_REDEMPTION_CHANNEL out=WORK.REDEMPTION_CHANNEL NODUPKEY;
1188       	by redeem_channel_id descending update_date descending add_date;
1189       run;
1190       
1191       DATA WORK.REDEMPTION_CHANNEL;
1192       	RETAIN fmtname 'RDMID2NM' type 'N';
1193       	SET WORK.REDEMPTION_CHANNEL;
1194       	start = redeem_channel_id;
1195       	LABEL = redeem_channel_name;
1196       run;
1197       
1198       proc format cntlin=WORK.redemption_channel Library=FORMATS;
1199       run;
1200       
1201       
1202       /* Creating Format for CITY and ZIP based on Terminal ID */
1203       /* Added on 22 Nov 2012 */
1204       
1205       proc sql;
1206       create table terminal_dtls as
1207       select
1208       		distinct Terminal_id as start,
1209       		upcase(city)  as label1,
1210       		zip as label2,
1211       		'TID2city' as FMTNAME1,
1212       		'TID2zip' as FMTNAME2
1213       
1214       from dwhlib.det_partner_terminal_address
1215       ;
1216       quit;
1217       
1218       PROC SORT DATA = terminal_dtls;
1219       	by start descending label2;
1220       run;
1221       
1222       PROC SORT DATA = terminal_dtls NODUPKEY;
1223       	by start;
1224       run;
1225       
1226       proc format lib=formats cntlin=terminal_dtls(keep=start label1 fmtname1 rename=(label1=label fmtname1=fmtname));
1227       run;
1228       
1229       proc format lib=formats cntlin=terminal_dtls(keep=start label2 fmtname2 rename=(label2=label fmtname2=fmtname));
1230       run;
1231       
1232       %include "/sasdata/core_etl/prod/FG/includes/prep_fg_calendar_201213.sas" / source2;
31                                                         The SAS System                              11:30 Friday, January 8, 2016

1233       
1234       /* Picture formats */
1235       proc format;
1236       	picture custcomma (round)
1237       		low - 999 = '000'
1238       		1000 - 9999 = '0,000'
1239       		10000 - 99999 = '00,000'
1240       		100000 - 999999 = '000,000'
1241       		1000000 - 9999999 = '0,000,000'
1242       		10000000 - 99999999 = '00,000,000'
1243       		100000000 - 999999999 = '000,000,000'
1244       		1000000000 - 9999999999 = '0,000,000,000'
1245       	;
1246       	picture datefmt (default=45)
1247       	    low-high = 'Trans datD: %B %d, %Y %A' (datatype=date);
1248       run;
1249       
1250       /* Creation of a picture format converting datetime column into date or any of the higher periods */
1251       
1252       PROC FORMAT library=formats;
1253       	/* Datetime to Year-month */
1254       	PICTURE dt2yrmon (default=10) other='%b%Y' (DATATYPE=DATETIME);
1255       quit;
1256       
1257       PROC FORMAT library=formats;
1258       	/* Datetime to Year-month */
1259       	PICTURE dt2yymmn (default=10) other='%Y%0m' (DATATYPE=DATETIME);
1260       quit;
1261       
1262       PROC FORMAT library=formats;
1263       	/* Datetime to Year-month */
1264       	PICTURE dt2date (default=9) other='%Y%0m%0d' (DATATYPE=DATETIME);
1265       quit;
1266       
1267       /* C00003 */
1268       /* Definition of partner based on SID & PID combination as defined in the from the production MST_CAMPAIGN_SID_PID_LK
1268     ! master reference table */
1269       
1270       	proc sort data = DWHLIB.MST_CAMPAIGN_SID_PID_LK OUT=MST_CAMPAIGN_SID_PID_LK;
1271       		by
1272       			sourced_association_id promo_code_id /* DESCENDING add_date */
1273       		;
1274       	run;
1275       
1276       	proc sort data = MST_CAMPAIGN_SID_PID_LK nodupkey;
1277       		by sourced_association_id promo_code_id;
1278       	run;
1279       
1280       	DATA fmt_CAMPAIGN_SID_PID_LK;
1281       	
1282       		RETAIN fmtname 'ENRCMPGN' type 'N';
1283       		SET MST_CAMPAIGN_SID_PID_LK;
1284       		start = SUM(sourced_association_id*1000, promo_code_id);
1285       		LABEL = strip(upcase(MARKETING_DESC));
1286       	run;
1287       
1288       	proc format library=FORMATS CNTLIN=fmt_CAMPAIGN_SID_PID_LK;
1289       	quit;
32                                                         The SAS System                              11:30 Friday, January 8, 2016

1290       	run;
1291       
1292       /* End of section - Picture formats */
1293       
1294       /************************ End of section - Formats out of datasets **********************/
1295       
1296       /* Additional date macro variables for computing KPIs by recency (C0003) */
1297       %include "/sasdata/core_etl/prod/sas/includes/create_std_date_vars_inc.sas" / source2;
1298       
1299       %include "/sasdata/core_etl/prod/FG/includes/prep_fg_top_cities_fmt.sas" / source2;
1300       
1301       %mend create_pb_std_formats;
1302       
1303       %create_pb_std_formats;
MLOGIC(CREATE_PB_STD_FORMATS):  Beginning execution.
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data=dwhlib.partner_list out=partner_list nodupkey;
MPRINT(CREATE_PB_STD_FORMATS):   by partner_id;
MPRINT(CREATE_PB_STD_FORMATS):   run;

11                                                          The SAS System                              11:30 Friday, January 8, 
2016
 
 NOTE: PROCEDURE SQL used (Total process time):
       real time           0.09 seconds
       cpu time            0.02 seconds
       
 
NOTE: SQL generation was used to perform the sorting.
NOTE: There were 15580 observations read from the data set WORK._ZSQL0.
NOTE: The data set WORK.PARTNER_LIST has 15580 observations and 15 variables.
NOTE: Compressing data set WORK.PARTNER_LIST decreased size by 54.84 percent. 
      Compressed is 112 pages; un-compressed would require 248 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           6.15 seconds
      cpu time            0.18 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = whouse.partner_hierarchy_1_dedup OUT=partner_hierarchy_1_dedup nodupkey;
MPRINT(CREATE_PB_STD_FORMATS):   by BRANCH_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1222 observations read from the data set WHOUSE.PARTNER_HIERARCHY_1_DEDUP.
NOTE: 2 observations with duplicate key values were deleted.
NOTE: The data set WORK.PARTNER_HIERARCHY_1_DEDUP has 1220 observations and 19 variables.
NOTE: Compressing data set WORK.PARTNER_HIERARCHY_1_DEDUP decreased size by 34.78 percent. 
      Compressed is 15 pages; un-compressed would require 23 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC DATASETS LIB=FORMATS MT=CATALOG nolist;
MPRINT(CREATE_PB_STD_FORMATS):   DELETE FORMATS ;
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: Deleting FORMATS.FORMATS (memtype=CATALOG).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.05 seconds
33                                                         The SAS System                              11:30 Friday, January 8, 2016

      cpu time            0.03 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   value ACTION_TYPE 3 = "Earn Reversal" 4 = "Burn Reversal" 1,5 = "Earn" 2,6 = "Burn" ;
NOTE: Format ACTION_TYPE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   value ACTION_SUB_TYPE 3 = "Earn Reversal" 4 = "Burn Reversal" 1 = "Earn" 5 = "Preallocated Earn" 2 
= "Burn" 6 = "Preallocated Burn" ;
NOTE: Format ACTION_SUB_TYPE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library=FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   VALUE fgprcd 183 = "BRF" 179 = "BBZ" 181 = "FBZ" 182 = "CTL" 185 = "EZN" 184 = "HTN" 180 = "PTL" 
188 = "FUTBCOM" 190 = "PTL3STR" 191 = "PTL5STR" 192 = "PTL7STR" 193 = "EZOL" 194 = "FH" 197 = "PFO" 200 = "FRT" 205 = "FBB" 223 = 
"IL" OTHER = "PB N/W" ;
NOTE: Format FGPRCD has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library=FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   VALUE fgpartcd 179 = "BIG BAZAAR" 180 = "PANTALOON" 181 = "FOOD BAZAAR" 182 = "CENTRAL" 183 = 
"BRAND FACTORY" 184 = "HOME TOWN" 185 = "E ZONE" 188 = "FUTURE BAZAAR" 190 = "PANTALOON 3STAR" 191 = "PANTALOON 5STAR" 192 = 
"PANTALOON 7STAR" 193 = "E ZONE ONLINE" 194 = "FOOD HALL" 197 = "PANTALOONS FACTORY OUTLET" 200 = "FOOD RIGHT" 205 = "FBB" 223 = 
"INDUSLEAGUE" OTHER = "PB N/W" ;
NOTE: Format FGPARTCD has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library=FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   VALUE fgpid2lmid 179 = 90012965 180 = 90012972 181 = 90012969 182 = 90012967 183 = 90012966 184 = 
90012971 185 = 90012968 188 = 90012970 190 = 90012972 191 = 90012972 192 = 90012972 193 = 90012968 194 = 90013041 197 = 90013564 
200 = 90013625 205 = 90013505 223 = 90014145 ;
NOTE: Format FGPID2LMID has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
34                                                         The SAS System                              11:30 Friday, January 8, 2016

      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library=FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   VALUE $ fgpart2lmid "BIG BAZAAR" = 90012965 "PANTALOONS" = 90012972 "FOOD BAZAAR" = 90012969 
"CENTRAL" = 90012967 "BRAND FACTORY" = 90012966 "HOME TOWN" = 90012971 "E ZONE" = 90012968 "PANTALOON 3STAR" = 90012972 "FUTURE 
BAZAAR" = 90012970 "PANTALOON 5STAR" = 90012972 "PANTALOON 7STAR" = 90012972 "PANTALOON" = 90012972 "E ZONE ONLINE" = 90012968 
"FOOD HALL" = 90013041 "FBB" = 90013505 "PANTALOONS FACTORY OUTLET" = 90013564 "FOOD RIGHT" = 90013625 "INDUSLEAGUE" = 90014145 ;
NOTE: Format $FGPART2LMID has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT library=formats;
MPRINT(CREATE_PB_STD_FORMATS):   value $ citygrp 'MUMBAI'='MUMBAI' 'DELHI'='DELHI' 'HYDERABAD' = 'HYDERABAD' 'KOLKATA' = 'KOLKATA' 
'AHMEDABAD' = 'AHMEDABAD' 'PUNE' = 'PUNE' 'BANGALORE' = 'BANGALORE' 'CHENNAI' = 'CHENNAI' OTHER = 'OTHERS' ;
NOTE: Format $CITYGRP has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   QUIT;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT library = formats;
MPRINT(CREATE_PB_STD_FORMATS):   VALUE AGEGRP low-17 = '< 18' 18-25 = '18-25' 26-30 = '26-30' 31-40 = '31-40' 41-45 = '41-45' 46-50 
= '46-50' 51-60 = '51-60' 61-70 = '61-70' other = 'N/A' ;
NOTE: Format AGEGRP has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format;
MPRINT(CREATE_PB_STD_FORMATS):   value $ KPINAME "UNIQ_MEMCNT" = "# of Unique Members transacted" "uniq_memcnt" = "# of Unique 
Members transacted" "TOTAL_BRCH_SALES" = "Total value of Earn tranx" "num_earns" = "# of Earn Transactions" "NUM_EARNS" = "# of 
Earn Transactions" "num_burns" = "# of Redemptions" "NUM_BURNS" = "# of Redemptions" "POINTS_EARNS" = "Total points issued" 
"points_earns" = "Total points issued" "POINTS_BURNS" = "Total points redeemed" "points_burns" = "Total points redeemed" 
"num_earn_revs" = "# of Earn Rev. activities" "NUM_EARN_REVS" = "# of Earn Rev. activities" "POINTS_EARN_REVS" = "Total earn points 
reversed" "points_earn_revs" = "Total earn points reversed" "TOTAL_PB_BILLS" = "Total PB Bills" "total_pb_bills" = "Total PB Bills" 
;
NOTE: Format $KPINAME has been output.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats;
MPRINT(CREATE_PB_STD_FORMATS):   value $ fgcmbine (DEFAULT=20) "BIG BAZAAR-NWG" = "BIGBAZAAR" "BIG BAZAAR-SE" = "BIGBAZAAR" "FOOD 
BAZAAR-NWG" = "FOODBAZAAR" "FOOD BAZAAR-SE" = "FOODBAZAAR" ;
NOTE: Format $FGCMBINE has been written to FORMATS.FORMATS.
35                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   value card_sub_type 1 = "PERMANENT" 2 = "TEMPORARY" 3 = "NOT CARDED" 4 = "RETAIL CARDS" 5 = 
"VIRTUAL CARDS" ;
NOTE: Format CARD_SUB_TYPE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format LIBRARY = FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   value CARD_TYPE 1,5="CARDED" 2,3,4="NON-CARDED" ;
NOTE: Format CARD_TYPE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT library = formats;
MPRINT(CREATE_PB_STD_FORMATS):   value card_type_prec 1 = 1 2 = 3 3 = 4 4 = 2 5 = 5 ;
NOTE: Format CARD_TYPE_PREC has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   Proc format library = formats;
MPRINT(CREATE_PB_STD_FORMATS):   Value SEG_AFFLUENT_PB 1 = "Royal Redeemer" 2 = "Affluent" 3 = "Big Ticket Spenders" 4 = 
"Enthusiast FG" 5 = "Low Enthusiast FG" ;
NOTE: Format SEG_AFFLUENT_PB has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library=formats;
MPRINT(CREATE_PB_STD_FORMATS):   value pts2slab low-0 = "0" 1-200 = ">0 to 200" 201-1000 = ">200 to 1000" 1001-2000 = ">1000 to 
2000" 2001-4000 = ">2000 to 4000" 4001-5000 = ">4000 to 5000" 5001-8000 = ">5000 to 8000" 8001-10000 = ">8000 to 10000" 10001-12000 
= ">10000 to 12000" 12001-50000 = ">12000 to 50000" 50001-100000= ">50000 to 100000" 100001-high= ">100000" ;
NOTE: Format PTS2SLAB has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
36                                                         The SAS System                              11:30 Friday, January 8, 2016

      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   Proc format library=formats;
MPRINT(CREATE_PB_STD_FORMATS):   value ptsvd low-0 = "0" 1-49 = ">1 to 49" 50-199 = ">50 to 199" 200-499 = ">200 to 499" 500-999 = 
">500 to 999" 1000-high = ">1000" ;
NOTE: Format PTSVD has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library=formats;
MPRINT(CREATE_PB_STD_FORMATS):   value RFMTPTS 0 = '0' 1-49 = '1-49' 50-199 = '50-199' 200-499 = '200-499' 500-999 = '500-999' 
1000-high = '1000+' ;
NOTE: Format RFMTPTS has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library=formats;
MPRINT(CREATE_PB_STD_FORMATS):   value pts4slab low-0 = "0" 1-200 = ">0 to 200" 201-1000 = ">200 to 1000" 1001-2000 = ">1000 to 
2000" 2001-4000 = ">2000 to 4000" 4001-high = ">4000" ;
NOTE: Format PTS4SLAB has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format LIBRARY = FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   value age 15-21 = "15-21" 22-29 = "22-29" 30-39 = "30-39" 40-55 = "40-55" 56-high = "56 +" other = 
"N/A" ;
NOTE: Format AGE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT LIBRARY = FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   VALUE $ ENRGRP "BIGBAZAAR" = "BIGBAZAAR" "FOODBAZAAR" = "FOODBAZAAR" "CENTRAL" = "CENTRAL" 
"BRANDFACTORY" = "BRANDFACTORY" "HOMETOWN" = "HOMETOWN" "EZONE" = "EZONE" "FUTUREBAZAAR" = "FUTUREBAZAAR" "PANTALOONS" = 
"PANTALOONS" "FOODHALL" = "FOODHALL" "FBB" = "FBB" "INDUSLEAGUE" = "INDUSLEAGUE" "FOODRIGHT" = "FOODRIGHT" "ICICIBANKDEBIT" = 
"ICICIDEBIT" "ICICIBANKCREDIT" = "ICICICREDIT" "ICICIOTHERS" = "ICICIOTHERS" "HPCL" = "HPCL" "MEGAMART" = "MEGAMART" "MMT" = "MMT" 
"MKRETAIL" = "MKRETAIL" "UNIVERCELL" = "UNIVERCELL" "B2E FIDELITY" = "B2E" "B2E MINDTREE" = "B2E" "B2E HCL" = "B2E" "B2E METLIFE" = 
"B2E" "B2E UBG" = "B2E" "B2E COGNIZANT" = "B2E" "B2E NESS" = "B2E" "VF_POSTPAID"= "VODAFONE" "VF_PREPAID"= "VODAFONE" OTHER = "PB 
N/W" ;
NOTE: Format $ENRGRP has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;
37                                                         The SAS System                              11:30 Friday, January 8, 2016


NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT LIBRARY = FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   VALUE $ PARTGRP "BIGBAZAAR" = "BIGBAZAAR" "FOODBAZAAR" = "FOODBAZAAR" "CENTRAL" = "CENTRAL" 
"BRANDFACTORY" = "BRANDFACTORY" "HOMETOWN" = "HOMETOWN" "EZONE" = "EZONE" "EZONEONLINE" = "EZONEONLINE" "FUTUREBAZAAR" = 
"FUTUREBAZAAR" "PANTALOONS" = "PANTALOONS" "FOODHALL" = "FOODHALL" "FOODRIGHT" = "FOODRIGHT" "FBB" = "FBB" "INDUSLEAGUE" = 
"INDUSLEAGUE" "HPCL" = "HPCL" "MEGAMART" = "MEGAMART" "MMT" = "MMT" "MMT_BUS" = "MMT" "MMT_DOM_AIR_TCKT" = "MMT" "MMT_AIRTKT" = 
"MMT" "MMT_HOTELS" = "MMT" "MMT_DOM_PKG" = "MMT" "MMT_INTL_PKG" = "MMT" "MMT_INTL_AIR_TCKT" = "MMT" "MAKEMYTRIP(INDIA)PVT.LTD." = 
"MMT" "MKRETAIL" = "MKRETAIL" "UNIVERCELL" = "UNIVERCELL" "ICICIBANKCREDIT" = "ICICICREDIT" "ICICIBANKDEBIT" = "ICICIDEBIT" 
"ICICIOTHERS" = "ICICIOTHERS" "BOOKMYSHOW" = "BOOKMYSHOW" "PLANETSPORTS" = "PLANETSPORTS" "BABYOYE" = "BABYOYE" "EDABBA" = "EDABBA" 
"FIRSTCRY" = "FIRSTCRY" "KOOVS" = "KOOVS" "PERFUME2ORDER" = "PERFUME2ORDER" "SURATDIAMOND" = "SURATDIAMOND" "VALYOO" = "VALYOO" 
"VF_POSTPAID"= "VODAFONE" "VF_PREPAID"="VODAFONE" OTHER = "PB N/W" ;
NOTE: Format $PARTGRP has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT;
MPRINT(CREATE_PB_STD_FORMATS):   VALUE $PARTNER2SCT "BIGBAZAAR" = "FG_BBZ" "FOODBAZAAR" = "FG_FOB" "CENTRAL" = "FG_CTL" 
"BRANDFACTORY" = "FG_BF" "HOMETOWN" = "FG_HTN" "EZONE" = "FG_EZ" "FUTUREBAZAAR" = "FG_FUB" "PANTALOONS" = "FG_PL" "FOODHALL" = 
"FG_FHL" "FOODRIGHT" = "FG_FRT" "FBB" = "FG_FBB" "INDUSLEAGUE" = "FG_IL" "HPCL" = "HPCL" "MEGAMART" = "MM" "MMT" = "MMT" "MKRETAIL" 
= "MKR" "UNIVERCELL" = "UNI" "ICICICREDIT" = "ICICR" "ICICIDEBIT" = "ICIDE" "ICICIOTHERS" = "PBN" "BOOKMYSHOW" = "BMS" "PB N/W" = 
"PBN" "PLANETSPORTS" = "PLASP" "BABYOYE" = "BABOY" "EDABBA" = "EDB" "FIRSTCRY" = "FICR" "KOOVS" = "KOO" "PERFUME2ORDER" = "PER" 
"SURATDIAMOND" = "SUR" "VALYOO" = "VALY" ;
NOTE: Format $PARTNER2SCT has been output.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format;
MPRINT(CREATE_PB_STD_FORMATS):   value $ metro "KOLKATA" = "METRO" "DELHI" = "METRO" "NEW DELHI" = "METRO" "MUMBAI" = "METRO" 
"CHENNAI" = "METRO" "PUNE" = "METRO" "HYDERABAD" = "METRO" "BANGALORE" = "METRO" "BENGALURU" = "METRO" "BANGLORE" = "METRO" OTHER = 
"NON-METRO" ;
NOTE: Format $METRO has been output.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library=formats;
MPRINT(CREATE_PB_STD_FORMATS):   value KYCFLG 1 = "ACCEPTED COMPLETE" 2 = "ACCEPTED INCOMPLETE (EML/ADDR)" 3 = "ACCEPTED INCOMPLETE 
(BOTH)" 4 = "NOT UPDATED" ;
NOTE: Format KYCFLG has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
38                                                         The SAS System                              11:30 Friday, January 8, 2016

      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT;
MPRINT(CREATE_PB_STD_FORMATS):   VALUE TRANTYPE 8,295="SWIPE EARN" OTHER="NON-SWIPE EARN" ;
NOTE: Format TRANTYPE has been output.
MPRINT(CREATE_PB_STD_FORMATS):   QUIT;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library=formats;
MPRINT(CREATE_PB_STD_FORMATS):   value pts4fg low-0 = "0" 1-200 = ">0 to 200" 201-1000 = ">200 to 1000" 1001-2000 = ">1000 to 2000" 
2001-4000 = ">2000 to 4000" 4001-5000 = ">4000 to 5000" 5000-10000 = ">5000 to 10000" 10000-high = ">10000" ;
NOTE: Format PTS4FG has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   value memtype 167 = "ROYALE" 166 = "ELITE" 2,168 = "CLASSIC" ;
NOTE: Format MEMTYPE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   value MOMtype 201111 = "NOV11" 201112 = "DEC11" 201201 = "JAN12" 201202= "FEB12" 201203= "MAR12" 
201204 = "APR12" 201205= "MAY12" 201206= "JUN12" 201207= "JUL12" 201208= "AUG12" 201209= "SEP12" ;
NOTE: Format MOMTYPE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT ;
MPRINT(CREATE_PB_STD_FORMATS):   VALUE EC_TYPE 1 = "Offline Offer" 2 = "Online Offer";
NOTE: Format EC_TYPE has been output.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = FORMATS;
MPRINT(CREATE_PB_STD_FORMATS):   value SEG_RFV_FRL 1 ="REGULAR_BIG_TROLLEY" 2 ="REGULAR_MEDIUM_TROLLEY" 3 ="REGULAR_LOW_TROLLEY" 4 
39                                                         The SAS System                              11:30 Friday, January 8, 2016

="ONE_TIME_HIGH_VALUE" 5 ="ONE_TIME_LOW_VALUE" 6 ="CASUAL_HIGH_VALUE" 7 ="CASUAL_LOW_VALUE" 8 ="BIGBAZAAR NEW CUSTOMER" 9 
="BIGBAZAAR INACTIVE" 10 ="BIGBAZAAR LAPSER" ;
NOTE: Format SEG_RFV_FRL has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   VALUE SEG_RFV_CEN 1 ="Central Platinum" 2 ="Central Gold" 3 ="Central Silver" 4 ="Central Active" 
5 ="Central Never active" ;
NOTE: Format SEG_RFV_CEN has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   VALUE SEG_RFV_BF 1 ="HIGH SPENDERS" 2 ="REGULAR SHOPPERS" 3 ="NASCENT SHOPPER" 4 ="BF NEW 
CUSTOMER" 5 ="HIBERNATORS" ;
NOTE: Format SEG_RFV_BF has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   VALUE SEG_EVOLUTION_VI 1 ="ADVO" 2 ="ENTH" 3 ="KN_ICI_MP" 4 ="KN_ICI_SP" 5 ="KNOWER_MP" 6 
="KNOWER_SP" 7 ="BY_ICI_SP" 8 ="BY_ICICI_MP" 9 ="BY_MP" 10 ="BY_SP" 11 ="INACTIVE" ;
NOTE: Format SEG_EVOLUTION_VI has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   VALUE SEG_LIFESTAGE 1="A.PENSION(>=60)" 2="B.Single_MEN(<=30)" 3="C.Single_WOMEN(<=30)" 
4="D.YOUNG_COUPLES(<=30)" 5="F.COUPLES(30-45)" 6="G.COUPLE_KID(30-45)" 7="H.Single_MEN(30-45)" 8="I.Single_WOMEN(30-45)" 
9="K.Mature_COUPLE_KID(45-60)" 10="L.Single_MEN(45-60)" 11="M.Single_WOMEN(45-60)" 12="E.YOUNG_COUPLE_KID(<=30)" ;
NOTE: Format SEG_LIFESTAGE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   VALUE SEG_EVOLUTION_VII 7="Cursory_shoppers" 6="Single_LOB_enthusiasts" 5="Single_LOB_Loyalists" 
4="Two_Dipping_cross_User" 3="Two_Format_Enthusiasts" 2="Enthusiasts" 1="Advocates" ;
NOTE: Format SEG_EVOLUTION_VII has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   VALUE SEG_WOMEN 1="1. BigBazaar Loyalists" 2="2. Ready to eat Shoppers" 3="3. Groceries & Staples 
Shoppers" 4="4. Non Essentials Shoppers" 5="5. Random Shoppers" ;
NOTE: Format SEG_WOMEN has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   value seg_wallet 1="HIGHEST" 2="HIGH" 3="AVERAGE" 4="LOW" 5="LOWEST" ;
NOTE: Format SEG_WALLET has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   value CEN_TIER_MGMNT 1="1 LEVEL UP" 2="2 LEVEL UP" 3="3 LEVEL UP" 4="HOLD" 5="1 LEVEL DOWN" 6="2 
LEVEL DOWN" 7="3 LEVEL DOWN" ;
NOTE: Format CEN_TIER_MGMNT has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data MEMBER_CARD_LOGO_MAP;
MPRINT(CREATE_PB_STD_FORMATS):   format label $10.;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "CDLOGOMP" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set DWHLIB.MST_MEMBER_CARD_TYPE;
MPRINT(CREATE_PB_STD_FORMATS):   start = MEMBER_CARD_TYPE_ID;
MPRINT(CREATE_PB_STD_FORMATS):   label = MEMBER_CARD_TYPE_DESC;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 222 observations read from the data set DWHLIB.MST_MEMBER_CARD_TYPE.
NOTE: The data set WORK.MEMBER_CARD_LOGO_MAP has 222 observations and 24 variables.
NOTE: Compressing data set WORK.MEMBER_CARD_LOGO_MAP decreased size by 85.71 percent. 
      Compressed is 1 pages; un-compressed would require 7 pages.
NOTE: DATA statement used (Total process time):
      real time           0.43 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = MEMBER_CARD_LOGO_MAP library = FORMATS;
NOTE: Format CDLOGOMP has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: There were 222 observations read from the data set WORK.MEMBER_CARD_LOGO_MAP.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
40                                                         The SAS System                              11:30 Friday, January 8, 2016

      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data _null_;
SYMBOLGEN:  Macro variable SYSDATE resolves to 08JAN16
MPRINT(CREATE_PB_STD_FORMATS):   call symput("curr_year", YEAR("08JAN16"D));
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1332:170   
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MLOGIC(CREATE_PB_STD_FORMATS):  %PUT &curr_year.
SYMBOLGEN:  Macro variable CURR_YEAR resolves to         2016
2016
NOTE: %INCLUDE (level 1) file /sasdata/core_etl/prod/FG/sasautos/generate_fg_calendar.sas is file 
      /sasdata/core_etl/prod/FG/sasautos/generate_fg_calendar.sas.
1333      +/************************************************************************
1334      +*       Program      :                                                  *
1335      +*                                                                       *
1336      +*                                                                       *
1337      +*       Owner        : Analytics, LSRPL                                 *
1338      +*                                                                       *
1339      +*       Author       :                                                  *
1340      +*                                                                       *
1341      +*       Input        :                                                  *
1342      +*                                                                       *
1343      +*                                                                       *
1344      +*                                                                       *
1345      +*       Output       :                                                  *
1346      +*                                                                       *
1347      +*                                                                       *
1348      +*                                                                       *
1349      +*       Dependencies :                                                  *
1350      +*                                                                       *
1351      +*       Description  :                                                  *
1352      +*                                                                       *
1353      +*                                                                       *
1354      +*       Usage        :                                                  *
1355      +*                                                                       *
1356      +*                                                                       *
1357      +*                                                                       *
1358      +*                                                                       *
1359      +*       History      :                                                  *
1360      +*       (Analyst)     (Date)    (Changes)                               *
1361      +*                                                                       *
1362      +*                                                                       *
1363      +************************************************************************/
1364      +/************************************************************************
1365      +*       Program      :                                                  *
1366      +*                                                                       *
1367      +*                                                                       *
1368      +*       Owner        : Analytics, LSRPL                                 *
1369      +*                                                                       *
1370      +*       Author       :                                                  *
41                                                         The SAS System                              11:30 Friday, January 8, 2016

1371      +*                                                                       *
1372      +*       Input        :                                                  *
1373      +*                                                                       *
1374      +*                                                                       *
1375      +*                                                                       *
1376      +*       Output       :                                                  *
1377      +*                                                                       *
1378      +*                                                                       *
1379      +*                                                                       *
1380      +*       Dependencies :                                                  *
1381      +*                                                                       *
1382      +*       Description  :                                                  *
1383      +*                                                                       *
1384      +*                                                                       *
1385      +*       Usage        :                                                  *
1386      +*                                                                       *
1387      +*                                                                       *
1388      +*                                                                       *
1389      +*                                                                       *
1390      +*       History      :                                                  *
1391      +*       (Analyst)     (Date)    (Changes)                               *
1392      +* 		Imran-334      24JUL2014 Increased the end date for fg calendar *
1393      +*								for next 10 Years (C0001)						*
1394      +*                                                                       *
1395      +*                                                                       *
1396      +************************************************************************/
1397      +
1398      +%macro generate_fg_calendar(base_year=, outdsn=work.FG_CALENDAR_&base_year.);
1399      +
1400      +data &outdsn.;
1401      +	format activity_date date9.;
1402      +	DO i = "01JUL&base_year."D TO "08JUL&base_year."D;
1403      +		IF weekday(i) = 2 then start = I;
1404      +		CONTINUE;
1405      +	END;
1406      +/*	end = intnx("WEEK.2", INTNX("YEAR", start, 4, "S"), -1, "E");*/
1407      +/*	(C0001)*/
1408      +	end = intnx("WEEK.2", INTNX("YEAR", start, 10, "S"), -1, "E");
1409      +
1410      +	count = 0;
1411      +	week = 0;
1412      +	do activity_date = start to end;
1413      +		count = count + 1;
1414      +		if mod(count, 7) = 1 then week = week + 1;
1415      +/*(C0001)*/
1416      +		if activity_date le INTNX("WEEK", "&sysdate."d ,1, "S");
1417      +		output;
1418      +	end;
1419      +	
1420      +	keep activity_date week;
1421      +run;
1422      +
1423      +%mend generate_fg_calendar;
NOTE: %INCLUDE (level 1) ending.
MLOGIC(GENERATE_FG_CALENDAR):  Beginning execution.
MLOGIC(CMPRES):  Beginning execution.
SYMBOLGEN:  Macro variable CURR_YEAR resolves to         2016
MLOGIC(CMPRES):  Parameter PARAM has value 2016
42                                                         The SAS System                              11:30 Friday, January 8, 2016

SYMBOLGEN:  Macro variable PARAM resolves to 2016
MLOGIC(CMPRES):  Ending execution.
MLOGIC(GENERATE_FG_CALENDAR):  Parameter BASE_YEAR has value 2011
MLOGIC(GENERATE_FG_CALENDAR):  Parameter OUTDSN has value whouse.fg_week_calendar_2016
SYMBOLGEN:  Macro variable OUTDSN resolves to whouse.fg_week_calendar_2016
MPRINT(GENERATE_FG_CALENDAR):   data whouse.fg_week_calendar_2016;
MPRINT(GENERATE_FG_CALENDAR):   format activity_date date9.;
SYMBOLGEN:  Macro variable BASE_YEAR resolves to 2011
SYMBOLGEN:  Macro variable BASE_YEAR resolves to 2011
MPRINT(GENERATE_FG_CALENDAR):   DO i = "01JUL2011"D TO "08JUL2011"D;
MPRINT(GENERATE_FG_CALENDAR):   IF weekday(i) = 2 then start = I;
MPRINT(GENERATE_FG_CALENDAR):   CONTINUE;
MPRINT(GENERATE_FG_CALENDAR):   END;
MPRINT(GENERATE_FG_CALENDAR):   end = intnx("WEEK.2", INTNX("YEAR", start, 10, "S"), -1, "E");
MPRINT(GENERATE_FG_CALENDAR):   count = 0;
MPRINT(GENERATE_FG_CALENDAR):   week = 0;
MPRINT(GENERATE_FG_CALENDAR):   do activity_date = start to end;
MPRINT(GENERATE_FG_CALENDAR):   count = count + 1;
MPRINT(GENERATE_FG_CALENDAR):   if mod(count, 7) = 1 then week = week + 1;
SYMBOLGEN:  Macro variable SYSDATE resolves to 08JAN16
MPRINT(GENERATE_FG_CALENDAR):   if activity_date le INTNX("WEEK", "08JAN16"d ,1, "S");
MPRINT(GENERATE_FG_CALENDAR):   output;
MPRINT(GENERATE_FG_CALENDAR):   end;
MPRINT(GENERATE_FG_CALENDAR):   keep activity_date week;
MPRINT(GENERATE_FG_CALENDAR):   run;

NOTE: Compression was disabled for data set WHOUSE.FG_WEEK_CALENDAR_2016 because compression overhead would increase the size of 
      the data set.
NOTE: The data set WHOUSE.FG_WEEK_CALENDAR_2016 has 1657 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

MLOGIC(GENERATE_FG_CALENDAR):  Ending execution.
MPRINT(CREATE_PB_STD_FORMATS):  ;
MPRINT(CREATE_PB_STD_FORMATS):   data fg_temp;
MPRINT(CREATE_PB_STD_FORMATS):   format label $10.;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "FGWEEK" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set
MLOGIC(CMPRES):  Beginning execution.
SYMBOLGEN:  Macro variable CURR_YEAR resolves to         2016
MLOGIC(CMPRES):  Parameter PARAM has value 2016
SYMBOLGEN:  Macro variable PARAM resolves to 2016
MPRINT(CMPRES):   whouse.fg_week_calendar_2016
MLOGIC(CMPRES):  Ending execution.
MPRINT(CREATE_PB_STD_FORMATS):  ;
MPRINT(CREATE_PB_STD_FORMATS):   start = activity_date;
MPRINT(CREATE_PB_STD_FORMATS):   label = "Week # " || put(week,3.);
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1657 observations read from the data set WHOUSE.FG_WEEK_CALENDAR_2016.
NOTE: The data set WORK.FG_TEMP has 1657 observations and 6 variables.
NOTE: Compressing data set WORK.FG_TEMP increased size by 9.09 percent. 
      Compressed is 12 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
43                                                         The SAS System                              11:30 Friday, January 8, 2016

      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = fg_temp library = FORMATS;
NOTE: Format FGWEEK has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      
NOTE: There were 1657 observations read from the data set WORK.FG_TEMP.

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats;
MPRINT(CREATE_PB_STD_FORMATS):   value fg_wk_mth_map 1-4 = "JUL2011" 5-8 = "AUG2011" 9-13 = "SEP2011" 14-17 = "OCT2011" 18-21 = 
"NOV2011" 22-26 = "DEC2011" 27-30 = "JAN2012" 31-34 = "FEB2012" 35-39 = "MAR2012" 40-43 = "APR2012" 44-47 = "MAY2012" 48-52 = 
"JUN2012" ;
NOTE: Format FG_WK_MTH_MAP has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data fg_temp2;
MPRINT(CREATE_PB_STD_FORMATS):   format label 8.;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "FGWEEKN" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set
MLOGIC(CMPRES):  Beginning execution.
SYMBOLGEN:  Macro variable CURR_YEAR resolves to         2016
MLOGIC(CMPRES):  Parameter PARAM has value 2016
SYMBOLGEN:  Macro variable PARAM resolves to 2016
MPRINT(CMPRES):   whouse.fg_week_calendar_2016
MLOGIC(CMPRES):  Ending execution.
MPRINT(CREATE_PB_STD_FORMATS):  ;
MPRINT(CREATE_PB_STD_FORMATS):   start = activity_date;
MPRINT(CREATE_PB_STD_FORMATS):   label = week;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1657 observations read from the data set WHOUSE.FG_WEEK_CALENDAR_2016.
NOTE: The data set WORK.FG_TEMP2 has 1657 observations and 6 variables.
NOTE: Compressing data set WORK.FG_TEMP2 increased size by 33.33 percent. 
      Compressed is 12 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = fg_temp2 library = WORK;
NOTE: Format FGWEEKN has been output.
MPRINT(CREATE_PB_STD_FORMATS):   run;
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      
NOTE: There were 1657 observations read from the data set WORK.FG_TEMP2.

MPRINT(CREATE_PB_STD_FORMATS):   data active_status_temp;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "fmtactstat" type "N";
44                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   set dwhlib.mst_active_status;
MPRINT(CREATE_PB_STD_FORMATS):   START = active_status_id;
MPRINT(CREATE_PB_STD_FORMATS):   label = active_status_desc;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 15 observations read from the data set DWHLIB.MST_ACTIVE_STATUS.
NOTE: The data set WORK.ACTIVE_STATUS_TEMP has 15 observations and 18 variables.
NOTE: Compressing data set WORK.ACTIVE_STATUS_TEMP decreased size by 0.00 percent. 
      Compressed is 1 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.21 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format lib=formats cntlin=active_status_temp;
NOTE: Format FMTACTSTAT has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 15 observations read from the data set WORK.ACTIVE_STATUS_TEMP.

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = dwhlib.mst_association out=SUPPLIB.AID_LIST NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   by ASSOCIATION_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;

11                                                          The SAS System                              11:30 Friday, January 8, 
2016
 
 NOTE: PROCEDURE SQL used (Total process time):
       real time           0.09 seconds
       cpu time            0.01 seconds
       
 
NOTE: SQL generation was used to perform the sorting.
NOTE: There were 62 observations read from the data set WORK._ZSQL0.
NOTE: The data set SUPPLIB.AID_LIST has 62 observations and 22 variables.
NOTE: Compressing data set SUPPLIB.AID_LIST decreased size by 50.00 percent. 
      Compressed is 1 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.44 seconds
      cpu time            0.05 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data TEMP_AID;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "AID2CODE" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set supplib.aid_list;
MPRINT(CREATE_PB_STD_FORMATS):   WHERE ASSOCIATION_ID ~= .;
MPRINT(CREATE_PB_STD_FORMATS):   start = association_id;
MPRINT(CREATE_PB_STD_FORMATS):   label = ASSOCIATION_CODE;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 62 observations read from the data set SUPPLIB.AID_LIST.
      WHERE ASSOCIATION_ID not = .;
NOTE: The data set WORK.TEMP_AID has 62 observations and 26 variables.
NOTE: Compressing data set WORK.TEMP_AID decreased size by 50.00 percent. 
45                                                         The SAS System                              11:30 Friday, January 8, 2016

      Compressed is 1 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = temp_AID library = formats;
NOTE: Format AID2CODE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 62 observations read from the data set WORK.TEMP_AID.

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = dwhlib.mst_sourced_association out=SUPPLIB.SID_LIST NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   by SOURCED_ASSOCIATION_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;

11                                                          The SAS System                              11:30 Friday, January 8, 
2016
 
 NOTE: PROCEDURE SQL used (Total process time):
       real time           0.09 seconds
       cpu time            0.01 seconds
       
 
NOTE: SQL generation was used to perform the sorting.
NOTE: There were 125 observations read from the data set WORK._ZSQL0.
NOTE: The data set SUPPLIB.SID_LIST has 125 observations and 25 variables.
NOTE: Compressing data set SUPPLIB.SID_LIST decreased size by 75.00 percent. 
      Compressed is 1 pages; un-compressed would require 4 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           5.52 seconds
      cpu time            0.04 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data TEMP_SID;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "SID2DESC" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set supplib.sid_list;
MPRINT(CREATE_PB_STD_FORMATS):   start = sourced_association_id;
MPRINT(CREATE_PB_STD_FORMATS):   label = SOURCED_ASSOCIATION_DESC;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 125 observations read from the data set SUPPLIB.SID_LIST.
NOTE: The data set WORK.TEMP_SID has 125 observations and 29 variables.
NOTE: Compressing data set WORK.TEMP_SID decreased size by 75.00 percent. 
      Compressed is 1 pages; un-compressed would require 4 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = temp_SID library = formats;
NOTE: Format SID2DESC has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
46                                                         The SAS System                              11:30 Friday, January 8, 2016

      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 125 observations read from the data set WORK.TEMP_SID.

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = dwhlib.mst_sourced_association out=SUPPLIB.SID_LIST_2 NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   by SOURCED_ASSOCIATION_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;

11                                                          The SAS System                              11:30 Friday, January 8, 
2016
 
 NOTE: PROCEDURE SQL used (Total process time):
       real time           5.11 seconds
       cpu time            0.02 seconds
       
 
NOTE: SQL generation was used to perform the sorting.
NOTE: There were 125 observations read from the data set WORK._ZSQL0.
NOTE: The data set SUPPLIB.SID_LIST_2 has 125 observations and 25 variables.
NOTE: Compressing data set SUPPLIB.SID_LIST_2 decreased size by 75.00 percent. 
      Compressed is 1 pages; un-compressed would require 4 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           5.36 seconds
      cpu time            0.05 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data TEMP_SID_2;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "SID2CODE" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set supplib.sid_list_2;
MPRINT(CREATE_PB_STD_FORMATS):   start = sourced_association_id;
MPRINT(CREATE_PB_STD_FORMATS):   label = SOURCED_ASSOCIATION_CODE;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 125 observations read from the data set SUPPLIB.SID_LIST_2.
NOTE: The data set WORK.TEMP_SID_2 has 125 observations and 29 variables.
NOTE: Compressing data set WORK.TEMP_SID_2 decreased size by 75.00 percent. 
      Compressed is 1 pages; un-compressed would require 4 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = temp_SID_2 library = formats;
NOTE: Format SID2CODE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 125 observations read from the data set WORK.TEMP_SID_2.

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = dwhlib.mst_promo_codes out=SUPPLIB.PID_LIST NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   by PROMO_CODE_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;

11                                                          The SAS System                              11:30 Friday, January 8, 
47                                                         The SAS System                              11:30 Friday, January 8, 2016

2016
 
 NOTE: PROCEDURE SQL used (Total process time):
       real time           0.09 seconds
       cpu time            0.01 seconds
       
 
NOTE: SQL generation was used to perform the sorting.
NOTE: There were 304 observations read from the data set WORK._ZSQL0.
NOTE: The data set SUPPLIB.PID_LIST has 304 observations and 15 variables.
NOTE: Compressing data set SUPPLIB.PID_LIST decreased size by 85.71 percent. 
      Compressed is 1 pages; un-compressed would require 7 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.37 seconds
      cpu time            0.05 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data TEMP_PID;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "PID2DESC" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set SUPPLIB.PID_LIST;
MPRINT(CREATE_PB_STD_FORMATS):   start = PROMO_CODE_ID;
MPRINT(CREATE_PB_STD_FORMATS):   label = PROMO_CODE_DESC;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 304 observations read from the data set SUPPLIB.PID_LIST.
NOTE: The data set WORK.TEMP_PID has 304 observations and 19 variables.
NOTE: Compressing data set WORK.TEMP_PID decreased size by 87.50 percent. 
      Compressed is 1 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = temp_PID library = formats;
NOTE: Format PID2DESC has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 304 observations read from the data set WORK.TEMP_PID.

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = dwhlib.mst_promo_codes out=SUPPLIB.PID_LIST_2 NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   by PROMO_CODE_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;

11                                                          The SAS System                              11:30 Friday, January 8, 
2016
 
 NOTE: PROCEDURE SQL used (Total process time):
       real time           0.09 seconds
       cpu time            0.00 seconds
       
 
NOTE: SQL generation was used to perform the sorting.
NOTE: There were 304 observations read from the data set WORK._ZSQL0.
NOTE: The data set SUPPLIB.PID_LIST_2 has 304 observations and 15 variables.
48                                                         The SAS System                              11:30 Friday, January 8, 2016

NOTE: Compressing data set SUPPLIB.PID_LIST_2 decreased size by 85.71 percent. 
      Compressed is 1 pages; un-compressed would require 7 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.32 seconds
      cpu time            0.04 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data TEMP_PID_2;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "PID2CODE" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set SUPPLIB.PID_LIST_2;
MPRINT(CREATE_PB_STD_FORMATS):   start = PROMO_CODE_ID;
MPRINT(CREATE_PB_STD_FORMATS):   label = PROMO_CODE;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 304 observations read from the data set SUPPLIB.PID_LIST_2.
NOTE: The data set WORK.TEMP_PID_2 has 304 observations and 19 variables.
NOTE: Compressing data set WORK.TEMP_PID_2 decreased size by 87.50 percent. 
      Compressed is 1 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = temp_PID_2 library = formats;
NOTE: Format PID2CODE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 304 observations read from the data set WORK.TEMP_PID_2.

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = dwhlib.mst_member_card_type out=SUPPLIB.MEM_CARD_TYPE_LIST NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   by MEMBER_CARD_TYPE_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;

11                                                          The SAS System                              11:30 Friday, January 8, 
2016
 
 NOTE: PROCEDURE SQL used (Total process time):
       real time           0.09 seconds
       cpu time            0.01 seconds
       
 
NOTE: SQL generation was used to perform the sorting.
NOTE: There were 222 observations read from the data set WORK._ZSQL0.
NOTE: The data set SUPPLIB.MEM_CARD_TYPE_LIST has 222 observations and 20 variables.
NOTE: Compressing data set SUPPLIB.MEM_CARD_TYPE_LIST decreased size by 85.71 percent. 
      Compressed is 1 pages; un-compressed would require 7 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.33 seconds
      cpu time            0.05 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data TEMP_MCTID;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "MCT2DESC" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set SUPPLIB.MEM_CARD_TYPE_LIST;
49                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   start = MEMBER_CARD_TYPE_ID;
MPRINT(CREATE_PB_STD_FORMATS):   label = MEMBER_CARD_TYPE_DESC;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 222 observations read from the data set SUPPLIB.MEM_CARD_TYPE_LIST.
NOTE: The data set WORK.TEMP_MCTID has 222 observations and 24 variables.
NOTE: Compressing data set WORK.TEMP_MCTID decreased size by 85.71 percent. 
      Compressed is 1 pages; un-compressed would require 7 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = temp_MCTID library = formats;
NOTE: Format MCT2DESC has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 222 observations read from the data set WORK.TEMP_MCTID.

MPRINT(CREATE_PB_STD_FORMATS):   data branch;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "BRCHNM" TYPE "N";
MPRINT(CREATE_PB_STD_FORMATS):   set partner_hierarchy_1_dedup (keep=LEGAL_NAME STAR_BRANCH_ID);
MPRINT(CREATE_PB_STD_FORMATS):   START=STAR_BRANCH_ID;
MPRINT(CREATE_PB_STD_FORMATS):   LABEL = LEGAL_NAME;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1220 observations read from the data set WORK.PARTNER_HIERARCHY_1_DEDUP.
NOTE: The data set WORK.BRANCH has 1220 observations and 6 variables.
NOTE: Compressing data set WORK.BRANCH decreased size by 34.78 percent. 
      Compressed is 15 pages; un-compressed would require 23 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = BRANCH LIBRARY = FORMATS;
ERROR: This range is repeated, or values overlap: 332555-332555.
MPRINT(CREATE_PB_STD_FORMATS):   run;

WARNING: RUN statement ignored due to previous errors. Submit QUIT; to terminate the procedure.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: The SAS System stopped processing this step because of errors.
NOTE: There were 1220 observations read from the data set WORK.BRANCH.


MPRINT(CREATE_PB_STD_FORMATS):   DATA ECOUPON.MST_ECOUPON_COMM_CHANNEL;
MPRINT(CREATE_PB_STD_FORMATS):   SET ECOUPON.EC_CHANNEL (keep=Channel_Code Channel_Name rename=(Channel_Code = Start CHANNEL_NAME = 
label)) end=last;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN fmtname "ECOUPON_COMM_CHANNEL" TYPE 'N';
MPRINT(CREATE_PB_STD_FORMATS):   OUTPUT;
MPRINT(CREATE_PB_STD_FORMATS):   if last then do;
50                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   hlo='O';
MPRINT(CREATE_PB_STD_FORMATS):   label='Other Channel';
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 9 observations read from the data set ECOUPON.EC_CHANNEL.
NOTE: The data set ECOUPON.MST_ECOUPON_COMM_CHANNEL has 10 observations and 5 variables.
NOTE: Compressing data set ECOUPON.MST_ECOUPON_COMM_CHANNEL decreased size by 0.00 percent. 
      Compressed is 1 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format lib=FORMATS cntlin=ECOUPON.MST_ECOUPON_COMM_CHANNEL;
NOTE: Format ECOUPON_COMM_CHANNEL has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   RUN;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 10 observations read from the data set ECOUPON.MST_ECOUPON_COMM_CHANNEL.

MPRINT(CREATE_PB_STD_FORMATS):   data lookup1;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "LMID2PID" TYPE "C";
MPRINT(CREATE_PB_STD_FORMATS):   set dwhlib.dim_partner (keep=partner_id loyalty_partner_id where=(loyalty_partner_id ~= ""));
MPRINT(CREATE_PB_STD_FORMATS):   start = LOYALTY_PARTNER_ID;
MPRINT(CREATE_PB_STD_FORMATS):   label = PARTNER_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 15740 observations read from the data set DWHLIB.DIM_PARTNER.
      WHERE loyalty_partner_id not = ' ';
NOTE: The data set WORK.LOOKUP1 has 15740 observations and 6 variables.
NOTE: Compressing data set WORK.LOOKUP1 decreased size by 11.43 percent. 
      Compressed is 124 pages; un-compressed would require 140 pages.
NOTE: DATA statement used (Total process time):
      real time           0.61 seconds
      cpu time            0.04 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format CNTLIN=WORK.LOOKUP1 library = FORMATS;
NOTE: Format $LMID2PID has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      
NOTE: There were 15740 observations read from the data set WORK.LOOKUP1.

MPRINT(CREATE_PB_STD_FORMATS):   data lookup2;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "PID2LMID" TYPE "N";
MPRINT(CREATE_PB_STD_FORMATS):   set dwhlib.dim_partner (keep=partner_id loyalty_partner_id);
MPRINT(CREATE_PB_STD_FORMATS):   start = PARTNER_ID;
MPRINT(CREATE_PB_STD_FORMATS):   label = LOYALTY_PARTNER_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;
51                                                         The SAS System                              11:30 Friday, January 8, 2016


NOTE: There were 659310 observations read from the data set DWHLIB.DIM_PARTNER.
NOTE: The data set WORK.LOOKUP2 has 659310 observations and 6 variables.
NOTE: Compressing data set WORK.LOOKUP2 decreased size by 34.05 percent. 
      Compressed is 3848 pages; un-compressed would require 5835 pages.
NOTE: DATA statement used (Total process time):
      real time           3.16 seconds
      cpu time            1.28 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format CNTLIN=WORK.LOOKUP2 library = FORMATS;
NOTE: Format PID2LMID has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           1.87 seconds
      cpu time            1.88 seconds
      
NOTE: There were 659310 observations read from the data set WORK.LOOKUP2.

MPRINT(CREATE_PB_STD_FORMATS):   data partner_temp;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "part2typ" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set partner_list;
MPRINT(CREATE_PB_STD_FORMATS):   start=partner_id;
MPRINT(CREATE_PB_STD_FORMATS):   label=partner_type;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 15580 observations read from the data set WORK.PARTNER_LIST.
NOTE: The data set WORK.PARTNER_TEMP has 15580 observations and 19 variables.
NOTE: Compressing data set WORK.PARTNER_TEMP decreased size by 50.19 percent. 
      Compressed is 134 pages; un-compressed would require 269 pages.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin=partner_temp library=formats;
NOTE: Format PART2TYP has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.03 seconds
      cpu time            0.04 seconds
      
NOTE: There were 15580 observations read from the data set WORK.PARTNER_TEMP.

MPRINT(CREATE_PB_STD_FORMATS):   data partner_temp2;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "part2nm" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set partner_list end=EOF;
MPRINT(CREATE_PB_STD_FORMATS):   start=partner_id;
MPRINT(CREATE_PB_STD_FORMATS):   label=p_commercial_name;
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   if EOF then do;
MPRINT(CREATE_PB_STD_FORMATS):   hlo="O";
MPRINT(CREATE_PB_STD_FORMATS):   label="OTHERRETAIL";
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   run;
52                                                         The SAS System                              11:30 Friday, January 8, 2016


NOTE: There were 15580 observations read from the data set WORK.PARTNER_LIST.
NOTE: The data set WORK.PARTNER_TEMP2 has 15581 observations and 20 variables.
NOTE: Compressing data set WORK.PARTNER_TEMP2 decreased size by 54.24 percent. 
      Compressed is 135 pages; un-compressed would require 295 pages.
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.06 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin=partner_temp2 library=formats;
NOTE: Format PART2NM has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.03 seconds
      cpu time            0.04 seconds
      
NOTE: There were 15581 observations read from the data set WORK.PARTNER_TEMP2.

MPRINT(CREATE_PB_STD_FORMATS):   data pid_temp;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "pid2part" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set supplib.pid2partner end=EOF;
MPRINT(CREATE_PB_STD_FORMATS):  ;
MPRINT(CREATE_PB_STD_FORMATS):   start=promo_code_id;
MPRINT(CREATE_PB_STD_FORMATS):   label=promo_partner;
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   if EOF then do;
MPRINT(CREATE_PB_STD_FORMATS):   hlo="O";
MPRINT(CREATE_PB_STD_FORMATS):   label="OTHERRETAIL";
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 299 observations read from the data set SUPPLIB.PID2PARTNER.
NOTE: The data set WORK.PID_TEMP has 300 observations and 12 variables.
NOTE: Compressing data set WORK.PID_TEMP decreased size by 33.33 percent. 
      Compressed is 4 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin=pid_temp library=formats;
NOTE: Format PID2PART has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 300 observations read from the data set WORK.PID_TEMP.

MPRINT(CREATE_PB_STD_FORMATS):   data sid_temp;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "sid2part" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   set supplib.sid2partner end=EOF;
MPRINT(CREATE_PB_STD_FORMATS):   start=sourced_association_id;
MPRINT(CREATE_PB_STD_FORMATS):   label=sourced_partner;
53                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   if EOF then do;
MPRINT(CREATE_PB_STD_FORMATS):   hlo="O";
MPRINT(CREATE_PB_STD_FORMATS):   label="OTHERRETAIL";
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 121 observations read from the data set SUPPLIB.SID2PARTNER.
NOTE: The data set WORK.SID_TEMP has 122 observations and 13 variables.
NOTE: Compressing data set WORK.SID_TEMP decreased size by 0.00 percent. 
      Compressed is 3 pages; un-compressed would require 3 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin=sid_temp library=formats;
NOTE: Format SID2PART has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 122 observations read from the data set WORK.SID_TEMP.

NOTE: Data file SUPPLIB.BOARD_KPI_PARTNER_LIST.DATA is in a format that is native to another host, or the file encoding does not 
      match the session encoding. Cross Environment Data Access will be used, which might require additional CPU resources and 
      might reduce performance.
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = supplib.board_kpi_partner_list out = board_kpi_plist nodupkey;
MPRINT(CREATE_PB_STD_FORMATS):   by board_kpi_partner p_commercial_name;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 142 observations read from the data set SUPPLIB.BOARD_KPI_PARTNER_LIST.
NOTE: 3 observations with duplicate key values were deleted.
NOTE: The data set WORK.BOARD_KPI_PLIST has 139 observations and 3 variables.
NOTE: Compressing data set WORK.BOARD_KPI_PLIST decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data board_kpi_hash;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "part2brd" type "C";
MPRINT(CREATE_PB_STD_FORMATS):   set board_kpi_plist end=EOF;
MPRINT(CREATE_PB_STD_FORMATS):   IF p_commercial_name = "FIRSTCRY" and board_kpi_partner in ("OTHERS") THEN DELETE;
MPRINT(CREATE_PB_STD_FORMATS):   IF p_commercial_name ="OTHERRETAIL" and board_kpi_partner in ("ONLINE") then delete;
MPRINT(CREATE_PB_STD_FORMATS):   start=p_commercial_name;
MPRINT(CREATE_PB_STD_FORMATS):   label=board_kpi_partner;
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   if EOF then do;
MPRINT(CREATE_PB_STD_FORMATS):   hlo="O";
MPRINT(CREATE_PB_STD_FORMATS):   label="OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   run;
54                                                         The SAS System                              11:30 Friday, January 8, 2016


NOTE: There were 139 observations read from the data set WORK.BOARD_KPI_PLIST.
NOTE: The data set WORK.BOARD_KPI_HASH has 138 observations and 8 variables.
NOTE: Compressing data set WORK.BOARD_KPI_HASH decreased size by 33.33 percent. 
      Compressed is 2 pages; un-compressed would require 3 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = board_kpi_hash library = formats;
NOTE: Format $PART2BRD has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: There were 138 observations read from the data set WORK.BOARD_KPI_HASH.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   DATA mc_temp;
MPRINT(CREATE_PB_STD_FORMATS):   set supplib.Mc_level_mba_bigbazaar_mar_13;
NOTE: Data file SUPPLIB.MC_LEVEL_MBA_BIGBAZAAR_MAR_13.DATA is in a format that is native to another host, or the file encoding does 
      not match the session encoding. Cross Environment Data Access will be used, which might require additional CPU resources and 
      might reduce performance.
MPRINT(CREATE_PB_STD_FORMATS):   DEP_NAME = STRIP(UPCASE(DEP_NAME));
MPRINT(CREATE_PB_STD_FORMATS):   RUN;

NOTE: There were 1637 observations read from the data set SUPPLIB.MC_LEVEL_MBA_BIGBAZAAR_MAR_13.
NOTE: The data set WORK.MC_TEMP has 1637 observations and 17 variables.
NOTE: Compressing data set WORK.MC_TEMP decreased size by 50.00 percent. 
      Compressed is 16 pages; un-compressed would require 32 pages.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = MC_TEMP nodupkey;
MPRINT(CREATE_PB_STD_FORMATS):   by DEP_NAME;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1637 observations read from the data set WORK.MC_TEMP.
NOTE: 8 observations with duplicate key values were deleted.
NOTE: The data set WORK.MC_TEMP has 1629 observations and 17 variables.
NOTE: Compressing data set WORK.MC_TEMP decreased size by 50.00 percent. 
      Compressed is 16 pages; un-compressed would require 32 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data mc_temp;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname "old2nwmc" type "C";
MPRINT(CREATE_PB_STD_FORMATS):   set MC_TEMP end=EOF;
MPRINT(CREATE_PB_STD_FORMATS):   BY DEP_NAME;
MPRINT(CREATE_PB_STD_FORMATS):   start=strip(upcase(DEP_NAME));
MPRINT(CREATE_PB_STD_FORMATS):   label=strip(upcase(name));
MPRINT(CREATE_PB_STD_FORMATS):   output;
55                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   if EOF then do;
MPRINT(CREATE_PB_STD_FORMATS):   hlo="O";
MPRINT(CREATE_PB_STD_FORMATS):   label="OTHER";
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1629 observations read from the data set WORK.MC_TEMP.
NOTE: The data set WORK.MC_TEMP has 1630 observations and 22 variables.
NOTE: Compressing data set WORK.MC_TEMP decreased size by 51.28 percent. 
      Compressed is 19 pages; un-compressed would require 39 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin=mc_temp library=formats;
NOTE: Format $OLD2NWMC has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      
NOTE: There were 1630 observations read from the data set WORK.MC_TEMP.

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = supplib.fg_mc_code_to_desc out = basket_temp nodupkey;
MPRINT(CREATE_PB_STD_FORMATS):   by mc_code mcnew;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 5236 observations read from the data set SUPPLIB.FG_MC_CODE_TO_DESC.
NOTE: 14 observations with duplicate key values were deleted.
NOTE: The data set WORK.BASKET_TEMP has 5222 observations and 8 variables.
NOTE: Compressing data set WORK.BASKET_TEMP decreased size by 44.19 percent. 
      Compressed is 48 pages; un-compressed would require 86 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.09 seconds
      cpu time            0.03 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = basket_temp nodupkey;
MPRINT(CREATE_PB_STD_FORMATS):   by mc_code;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 5222 observations read from the data set WORK.BASKET_TEMP.
NOTE: 4 observations with duplicate key values were deleted.
NOTE: The data set WORK.BASKET_TEMP has 5218 observations and 8 variables.
NOTE: Compressing data set WORK.BASKET_TEMP decreased size by 44.19 percent. 
      Compressed is 48 pages; un-compressed would require 86 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data basket_desc;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "MC_CODE2DESC" TYPE "C";
MPRINT(CREATE_PB_STD_FORMATS):   set basket_temp(keep=mc_code mcnew);
MPRINT(CREATE_PB_STD_FORMATS):   START = MC_CODE;
56                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   LABEL=strip(upcase(MCNEW));
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 5218 observations read from the data set WORK.BASKET_TEMP.
NOTE: The data set WORK.BASKET_DESC has 5218 observations and 6 variables.
NOTE: Compressing data set WORK.BASKET_DESC decreased size by 39.18 percent. 
      Compressed is 59 pages; un-compressed would require 97 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats cntlin=basket_desc;
NOTE: Format $MC_CODE2DESC has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: There were 5218 observations read from the data set WORK.BASKET_DESC.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = partner_hierarchy_1_dedup(keep=LEGAL_NAME BRANCH_ID) OUT=BRCH2STR_INPUT nodup;
MPRINT(CREATE_PB_STD_FORMATS):   by BRANCH_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1220 observations read from the data set WORK.PARTNER_HIERARCHY_1_DEDUP.
NOTE: 0 duplicate observations were deleted.
NOTE: The data set WORK.BRCH2STR_INPUT has 1220 observations and 2 variables.
NOTE: Compressing data set WORK.BRCH2STR_INPUT decreased size by 18.18 percent. 
      Compressed is 9 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data BRCH2STR;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "brch2str" type "C";
MPRINT(CREATE_PB_STD_FORMATS):   SET BRCH2STR_INPUT end=eof;
MPRINT(CREATE_PB_STD_FORMATS):   WHERE not (strip(branch_id) = "6535" and strip(upcase(legal_name)) LIKE '%HYDERABAD%');
MPRINT(CREATE_PB_STD_FORMATS):   legal_name = strip(upcase(legal_name));
MPRINT(CREATE_PB_STD_FORMATS):   if strip(upcase(branch_id)) ~= "ONLINE" then do;
MPRINT(CREATE_PB_STD_FORMATS):   start = branch_id;
MPRINT(CREATE_PB_STD_FORMATS):   label = legal_name;
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   if eof and strip(branch_id) ~= "" then do;
MPRINT(CREATE_PB_STD_FORMATS):   hlo="O";
MPRINT(CREATE_PB_STD_FORMATS):   label="OTHER";
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1219 observations read from the data set WORK.BRCH2STR_INPUT.
      WHERE (STRIP(branch_id) not = '6535') or STRIP(UPCASE(legal_name)) not like '%HYDERABAD%';
NOTE: The data set WORK.BRCH2STR has 1219 observations and 7 variables.
NOTE: Compressing data set WORK.BRCH2STR decreased size by 27.27 percent. 
      Compressed is 16 pages; un-compressed would require 22 pages.
57                                                         The SAS System                              11:30 Friday, January 8, 2016

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = brch2str nodup;
MPRINT(CREATE_PB_STD_FORMATS):   by BRANCH_ID;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1219 observations read from the data set WORK.BRCH2STR.
NOTE: 0 duplicate observations were deleted.
NOTE: The data set WORK.BRCH2STR has 1219 observations and 7 variables.
NOTE: Compressing data set WORK.BRCH2STR decreased size by 27.27 percent. 
      Compressed is 16 pages; un-compressed would require 22 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin = BRCH2STR library = formats;
NOTE: Format $BRCH2STR has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: There were 1219 observations read from the data set WORK.BRCH2STR.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   data basket_lkp;
MPRINT(CREATE_PB_STD_FORMATS):   retain fmtname 'bsktmc2desc' type 'C';
MPRINT(CREATE_PB_STD_FORMATS):   set supplib.basket_mc_code_2_desc end=eof;
NOTE: Data file SUPPLIB.BASKET_MC_CODE_2_DESC.DATA is in a format that is native to another host, or the file encoding does not 
      match the session encoding. Cross Environment Data Access will be used, which might require additional CPU resources and 
      might reduce performance.
MPRINT(CREATE_PB_STD_FORMATS):   START = dep_code;
MPRINT(CREATE_PB_STD_FORMATS):   LABEL = dep_name;
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   if eof then do;
MPRINT(CREATE_PB_STD_FORMATS):   HLO="O";
MPRINT(CREATE_PB_STD_FORMATS):   label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 4323 observations read from the data set SUPPLIB.BASKET_MC_CODE_2_DESC.
NOTE: The data set WORK.BASKET_LKP has 4324 observations and 8 variables.
NOTE: Compressing data set WORK.BASKET_LKP decreased size by 20.31 percent. 
      Compressed is 51 pages; un-compressed would require 64 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = basket_lkp nodupkey;
MPRINT(CREATE_PB_STD_FORMATS):   by dep_code;
MPRINT(CREATE_PB_STD_FORMATS):   run;

58                                                         The SAS System                              11:30 Friday, January 8, 2016

NOTE: There were 4324 observations read from the data set WORK.BASKET_LKP.
NOTE: 1326 observations with duplicate key values were deleted.
NOTE: The data set WORK.BASKET_LKP has 2998 observations and 8 variables.
NOTE: Compressing data set WORK.BASKET_LKP decreased size by 18.18 percent. 
      Compressed is 36 pages; un-compressed would require 44 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin=basket_lkp library = formats;
NOTE: Format $BSKTMC2DESC has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      
NOTE: There were 2998 observations read from the data set WORK.BASKET_LKP.

MPRINT(CREATE_PB_STD_FORMATS):   data store_temp;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN fmtname 'fgstr2cy' TYPE 'C';
MPRINT(CREATE_PB_STD_FORMATS):   set partner_hierarchy_1_dedup;
MPRINT(CREATE_PB_STD_FORMATS):   where length(strip(branch_id)) <= 4 ;
MPRINT(CREATE_PB_STD_FORMATS):   if length(strip(branch_id)) = 4 then do;
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(put(input(branch_id, 4.), 4.));
MPRINT(CREATE_PB_STD_FORMATS):   label = strip(upcase(branch_city));
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   if length(strip(branch_id)) = 3 then do;
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(put(input(branch_id, 4.), z4.));
MPRINT(CREATE_PB_STD_FORMATS):   label = strip(upcase(branch_city));
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(put(input(branch_id, 4.), 4.));
MPRINT(CREATE_PB_STD_FORMATS):   label = strip(upcase(branch_city));
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1201 observations read from the data set WORK.PARTNER_HIERARCHY_1_DEDUP.
      WHERE LENGTH(STRIP(branch_id))<=4;
NOTE: The data set WORK.STORE_TEMP has 1287 observations and 23 variables.
NOTE: Compressing data set WORK.STORE_TEMP decreased size by 34.62 percent. 
      Compressed is 17 pages; un-compressed would require 26 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = STORE_TEMP NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   BY start;
MPRINT(CREATE_PB_STD_FORMATS):   RUN;

NOTE: There were 1287 observations read from the data set WORK.STORE_TEMP.
NOTE: 84 observations with duplicate key values were deleted.
NOTE: The data set WORK.STORE_TEMP has 1203 observations and 23 variables.
NOTE: Compressing data set WORK.STORE_TEMP decreased size by 33.33 percent. 
      Compressed is 16 pages; un-compressed would require 24 pages.
59                                                         The SAS System                              11:30 Friday, January 8, 2016

NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats cntlin = store_temp;
NOTE: Format $FGSTR2CY has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      
NOTE: There were 1203 observations read from the data set WORK.STORE_TEMP.

MPRINT(CREATE_PB_STD_FORMATS):   data store_temp_z;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN fmtname 'fgstr2zn' TYPE 'C';
MPRINT(CREATE_PB_STD_FORMATS):   set partner_hierarchy_1_dedup;
MPRINT(CREATE_PB_STD_FORMATS):   where length(strip(branch_id)) <= 4 ;
MPRINT(CREATE_PB_STD_FORMATS):   if length(strip(branch_id)) = 4 then do;
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(put(input(branch_id, 4.), 4.));
MPRINT(CREATE_PB_STD_FORMATS):   label = strip(upcase(zone));
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   if length(strip(branch_id)) = 3 then do;
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(put(input(branch_id, 4.), z4.));
MPRINT(CREATE_PB_STD_FORMATS):   label = strip(upcase(zone));
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(put(input(branch_id, 4.), 4.));
MPRINT(CREATE_PB_STD_FORMATS):   label = strip(upcase(zone));
MPRINT(CREATE_PB_STD_FORMATS):   output;
MPRINT(CREATE_PB_STD_FORMATS):   end;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1201 observations read from the data set WORK.PARTNER_HIERARCHY_1_DEDUP.
      WHERE LENGTH(STRIP(branch_id))<=4;
NOTE: The data set WORK.STORE_TEMP_Z has 1287 observations and 23 variables.
NOTE: Compressing data set WORK.STORE_TEMP_Z decreased size by 38.46 percent. 
      Compressed is 16 pages; un-compressed would require 26 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = STORE_TEMP_z NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   BY start;
MPRINT(CREATE_PB_STD_FORMATS):   RUN;

NOTE: There were 1287 observations read from the data set WORK.STORE_TEMP_Z.
NOTE: 84 observations with duplicate key values were deleted.
NOTE: The data set WORK.STORE_TEMP_Z has 1203 observations and 23 variables.
NOTE: Compressing data set WORK.STORE_TEMP_Z decreased size by 37.50 percent. 
      Compressed is 15 pages; un-compressed would require 24 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

60                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats cntlin = store_temp_z;
NOTE: Format $FGSTR2ZN has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      
NOTE: There were 1203 observations read from the data set WORK.STORE_TEMP_Z.

MPRINT(CREATE_PB_STD_FORMATS):   data store_temp1;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN fmtname 'fgstr2nm' TYPE 'C';
MPRINT(CREATE_PB_STD_FORMATS):   set partner_hierarchy_1_dedup;
MPRINT(CREATE_PB_STD_FORMATS):   where STRIP(UPCASE(branch_id)) not in ("ONLINE") and length(strip(branch_id)) ~= 6;
MPRINT(CREATE_PB_STD_FORMATS):   start = branch_id;
MPRINT(CREATE_PB_STD_FORMATS):   label = strip(upcase(legal_name));
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 1201 observations read from the data set WORK.PARTNER_HIERARCHY_1_DEDUP.
      WHERE (STRIP(UPCASE(branch_id)) not = 'ONLINE') and (LENGTH(STRIP(branch_id)) not = 6);
NOTE: The data set WORK.STORE_TEMP1 has 1201 observations and 23 variables.
NOTE: Compressing data set WORK.STORE_TEMP1 decreased size by 38.46 percent. 
      Compressed is 16 pages; un-compressed would require 26 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = STORE_TEMP1 NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   BY BRANCH_ID;
MPRINT(CREATE_PB_STD_FORMATS):   RUN;

NOTE: There were 1201 observations read from the data set WORK.STORE_TEMP1.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.STORE_TEMP1 has 1201 observations and 23 variables.
NOTE: Compressing data set WORK.STORE_TEMP1 decreased size by 38.46 percent. 
      Compressed is 16 pages; un-compressed would require 26 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats cntlin = store_temp1;
NOTE: Format $FGSTR2NM has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   QUIT;

NOTE: There were 1201 observations read from the data set WORK.STORE_TEMP1.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = DWHLIB.MST_activity_TRANS_TYPE out=WORK.TRANSACTION_TYPE NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   by ACTIVITY_transaction_type_id descending update_date descending add_date;
MPRINT(CREATE_PB_STD_FORMATS):   run;

11                                                          The SAS System                              11:30 Friday, January 8, 
2016
61                                                         The SAS System                              11:30 Friday, January 8, 2016

 
 NOTE: PROCEDURE SQL used (Total process time):
       real time           0.09 seconds
       cpu time            0.00 seconds
       
 
NOTE: SQL generation was used to perform the sorting.
NOTE: There were 374 observations read from the data set WORK._ZSQL0.
NOTE: The data set WORK.TRANSACTION_TYPE has 374 observations and 13 variables.
NOTE: Compressing data set WORK.TRANSACTION_TYPE decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.57 seconds
      cpu time            0.03 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   DATA WORK.TRANSACTION_TYPE;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN fmtname 'TRNTYP2DESC' type 'N';
MPRINT(CREATE_PB_STD_FORMATS):   SET WORK.TRANSACTION_TYPE;
MPRINT(CREATE_PB_STD_FORMATS):   start = activity_transaction_type_id;
MPRINT(CREATE_PB_STD_FORMATS):   LABEL = activity_transaction_desc;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 374 observations read from the data set WORK.TRANSACTION_TYPE.
NOTE: The data set WORK.TRANSACTION_TYPE has 374 observations and 17 variables.
NOTE: Compressing data set WORK.TRANSACTION_TYPE decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin=WORK.TRANSACTION_TYPE Library=FORMATS;
NOTE: Format TRNTYP2DESC has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 374 observations read from the data set WORK.TRANSACTION_TYPE.

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = DWHLIB.MST_REDEMPTION_CHANNEL out=WORK.REDEMPTION_CHANNEL NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   by redeem_channel_id descending update_date descending add_date;
MPRINT(CREATE_PB_STD_FORMATS):   run;

11                                                          The SAS System                              11:30 Friday, January 8, 
2016
 
 NOTE: PROCEDURE SQL used (Total process time):
       real time           5.11 seconds
       cpu time            0.00 seconds
       
 
NOTE: SQL generation was used to perform the sorting.
NOTE: There were 16 observations read from the data set WORK._ZSQL0.
NOTE: The data set WORK.REDEMPTION_CHANNEL has 16 observations and 17 variables.
NOTE: Compressing data set WORK.REDEMPTION_CHANNEL decreased size by 0.00 percent. 
62                                                         The SAS System                              11:30 Friday, January 8, 2016

      Compressed is 1 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           5.44 seconds
      cpu time            0.05 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   DATA WORK.REDEMPTION_CHANNEL;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN fmtname 'RDMID2NM' type 'N';
MPRINT(CREATE_PB_STD_FORMATS):   SET WORK.REDEMPTION_CHANNEL;
MPRINT(CREATE_PB_STD_FORMATS):   start = redeem_channel_id;
MPRINT(CREATE_PB_STD_FORMATS):   LABEL = redeem_channel_name;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 16 observations read from the data set WORK.REDEMPTION_CHANNEL.
NOTE: The data set WORK.REDEMPTION_CHANNEL has 16 observations and 21 variables.
NOTE: Compressing data set WORK.REDEMPTION_CHANNEL decreased size by 0.00 percent. 
      Compressed is 1 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format cntlin=WORK.redemption_channel Library=FORMATS;
NOTE: Format RDMID2NM has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 16 observations read from the data set WORK.REDEMPTION_CHANNEL.

MPRINT(CREATE_PB_STD_FORMATS):   proc sql;
MPRINT(CREATE_PB_STD_FORMATS):   create table terminal_dtls as select distinct Terminal_id as start, upcase(city) as label1, zip as 
label2, 'TID2city' as FMTNAME1, 'TID2zip' as FMTNAME2 from dwhlib.det_partner_terminal_address ;
NOTE: Compressing data set WORK.TERMINAL_DTLS decreased size by 14.33 percent. 
      Compressed is 269 pages; un-compressed would require 314 pages.
NOTE: Table WORK.TERMINAL_DTLS created, with 35401 rows and 5 columns.

MPRINT(CREATE_PB_STD_FORMATS):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.87 seconds
      cpu time            0.19 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC SORT DATA = terminal_dtls;
MPRINT(CREATE_PB_STD_FORMATS):   by start descending label2;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 35401 observations read from the data set WORK.TERMINAL_DTLS.
NOTE: The data set WORK.TERMINAL_DTLS has 35401 observations and 5 variables.
NOTE: Compressing data set WORK.TERMINAL_DTLS decreased size by 14.33 percent. 
      Compressed is 269 pages; un-compressed would require 314 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

63                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   PROC SORT DATA = terminal_dtls NODUPKEY;
MPRINT(CREATE_PB_STD_FORMATS):   by start;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 35401 observations read from the data set WORK.TERMINAL_DTLS.
NOTE: 59 observations with duplicate key values were deleted.
NOTE: The data set WORK.TERMINAL_DTLS has 35342 observations and 5 variables.
NOTE: Compressing data set WORK.TERMINAL_DTLS decreased size by 14.33 percent. 
      Compressed is 269 pages; un-compressed would require 314 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.06 seconds
      cpu time            0.07 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format lib=formats cntlin=terminal_dtls(keep=start label1 fmtname1 rename=(label1=label 
fmtname1=fmtname));
NOTE: Format TID2CITY has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.19 seconds
      cpu time            0.19 seconds
      
NOTE: There were 35342 observations read from the data set WORK.TERMINAL_DTLS.

MPRINT(CREATE_PB_STD_FORMATS):   proc format lib=formats cntlin=terminal_dtls(keep=start label2 fmtname2 rename=(label2=label 
fmtname2=fmtname));
NOTE: Format TID2ZIP has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.20 seconds
      cpu time            0.20 seconds
      
NOTE: There were 35342 observations read from the data set WORK.TERMINAL_DTLS.

NOTE: %INCLUDE (level 1) file /sasdata/core_etl/prod/FG/includes/prep_fg_calendar_201213.sas is file 
      /sasdata/core_etl/prod/FG/includes/prep_fg_calendar_201213.sas.
1424      +/* FG WEEKS for the fiscal calendar 2012-13 */
1425      +
1426      +data FG_CALENDAR_2012;
MPRINT(CREATE_PB_STD_FORMATS):   data FG_CALENDAR_2012;
1427      +	activity_date = "01JUL2012"D;
MPRINT(CREATE_PB_STD_FORMATS):   activity_date = "01JUL2012"D;
1428      +
1429      +	if activity_date = "01JUL2012"D then do;
MPRINT(CREATE_PB_STD_FORMATS):   if activity_date = "01JUL2012"D then do;
1430      +		week=1;
MPRINT(CREATE_PB_STD_FORMATS):   week=1;
1431      +		output;
MPRINT(CREATE_PB_STD_FORMATS):   output;
1432      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
1433      +	
1434      +	format activity_date date9.;
MPRINT(CREATE_PB_STD_FORMATS):   format activity_date date9.;
1435      +
1436      +	DO i = "01JUL2012"D TO "08JUL2012"D;
64                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   DO i = "01JUL2012"D TO "08JUL2012"D;
1437      +		IF weekday(i) = 2 then start = I;
MPRINT(CREATE_PB_STD_FORMATS):   IF weekday(i) = 2 then start = I;
1438      +		CONTINUE;
MPRINT(CREATE_PB_STD_FORMATS):   CONTINUE;
1439      +	END;
MPRINT(CREATE_PB_STD_FORMATS):   END;
1440      +	end = intnx("WEEK.2", INTNX("YEAR", start, 1, "S"), -1, "E");
MPRINT(CREATE_PB_STD_FORMATS):   end = intnx("WEEK.2", INTNX("YEAR", start, 1, "S"), -1, "E");
1441      +
1442      +	count = 0;
MPRINT(CREATE_PB_STD_FORMATS):   count = 0;
1443      +	week = 1;
MPRINT(CREATE_PB_STD_FORMATS):   week = 1;
1444      +	do activity_date = start to end;
MPRINT(CREATE_PB_STD_FORMATS):   do activity_date = start to end;
1445      +		count = count + 1;
MPRINT(CREATE_PB_STD_FORMATS):   count = count + 1;
1446      +		if mod(count, 7) = 1 then week = week + 1;
MPRINT(CREATE_PB_STD_FORMATS):   if mod(count, 7) = 1 then week = week + 1;
1447      +		output;
MPRINT(CREATE_PB_STD_FORMATS):   output;
1448      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
1449      +	keep activity_date week;
MPRINT(CREATE_PB_STD_FORMATS):   keep activity_date week;
1450      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: Compression was disabled for data set WORK.FG_CALENDAR_2012 because compression overhead would increase the size of the data 
      set.
NOTE: The data set WORK.FG_CALENDAR_2012 has 365 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1451      +
1452      +DATA FG_CALENDAR_2012;
MPRINT(CREATE_PB_STD_FORMATS):   DATA FG_CALENDAR_2012;
1453      +	RETAIN fmtname "fgwkcurr" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN fmtname "fgwkcurr" type "N";
1454      +	SET FG_CALENDAR_2012;
MPRINT(CREATE_PB_STD_FORMATS):   SET FG_CALENDAR_2012;
1455      +
1456      +	START=ACTIVITY_DATE;
MPRINT(CREATE_PB_STD_FORMATS):   START=ACTIVITY_DATE;
1457      +	LABEL = WEEK;
MPRINT(CREATE_PB_STD_FORMATS):   LABEL = WEEK;
1458      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 365 observations read from the data set WORK.FG_CALENDAR_2012.
NOTE: The data set WORK.FG_CALENDAR_2012 has 365 observations and 6 variables.
NOTE: Compressing data set WORK.FG_CALENDAR_2012 decreased size by 0.00 percent. 
      Compressed is 3 pages; un-compressed would require 3 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
65                                                         The SAS System                              11:30 Friday, January 8, 2016

      cpu time            0.01 seconds
      

1459      +
1460      +
1461      +DATA FG_CALENDAR_2012_C;
MPRINT(CREATE_PB_STD_FORMATS):   DATA FG_CALENDAR_2012_C;
1462      +	RETAIN fmtname "fgwkcurrc" type "N";
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN fmtname "fgwkcurrc" type "N";
1463      +	SET FG_CALENDAR_2012 (keep=ACTIVITY_DATE WEEK);
MPRINT(CREATE_PB_STD_FORMATS):   SET FG_CALENDAR_2012 (keep=ACTIVITY_DATE WEEK);
1464      +
1465      +	format label $8.;
MPRINT(CREATE_PB_STD_FORMATS):   format label $8.;
1466      +
1467      +	START=ACTIVITY_DATE;
MPRINT(CREATE_PB_STD_FORMATS):   START=ACTIVITY_DATE;
1468      +
1469      +	PREFIX="Wk # ";
MPRINT(CREATE_PB_STD_FORMATS):   PREFIX="Wk # ";
1470      +	WEEK_C = strip(put(WEEK, 2.));
MPRINT(CREATE_PB_STD_FORMATS):   WEEK_C = strip(put(WEEK, 2.));
1471      +
1472      +	LABEL = cats(strip(prefix), strip(week_c));
MPRINT(CREATE_PB_STD_FORMATS):   LABEL = cats(strip(prefix), strip(week_c));
1473      +	drop prefix week_c;
MPRINT(CREATE_PB_STD_FORMATS):   drop prefix week_c;
1474      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 365 observations read from the data set WORK.FG_CALENDAR_2012.
NOTE: The data set WORK.FG_CALENDAR_2012_C has 365 observations and 6 variables.
NOTE: Compressing data set WORK.FG_CALENDAR_2012_C decreased size by 0.00 percent. 
      Compressed is 3 pages; un-compressed would require 3 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

1475      +
1476      +
1477      +PROC FORMAT LIBRARY=FORMATS CNTLIN=FG_CALENDAR_2012;
MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT LIBRARY=FORMATS CNTLIN=FG_CALENDAR_2012;
NOTE: Format FGWKCURR has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   RUN;
1478      +RUN;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 365 observations read from the data set WORK.FG_CALENDAR_2012.

1479      +
1480      +
1481      +PROC FORMAT LIBRARY=FORMATS CNTLIN=FG_CALENDAR_2012_C;
MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT LIBRARY=FORMATS CNTLIN=FG_CALENDAR_2012_C;
NOTE: Format FGWKCURRC has been written to FORMATS.FORMATS.
66                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   RUN;
1482      +RUN;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
NOTE: There were 365 observations read from the data set WORK.FG_CALENDAR_2012_C.

1483      +
1484      +	
NOTE: %INCLUDE (level 1) ending.
MPRINT(CREATE_PB_STD_FORMATS):   proc format;
MPRINT(CREATE_PB_STD_FORMATS):   picture custcomma (round) low - 999 = '000' 1000 - 9999 = '0,000' 10000 - 99999 = '00,000' 100000 
- 999999 = '000,000' 1000000 - 9999999 = '0,000,000' 10000000 - 99999999 = '00,000,000' 100000000 - 999999999 = '000,000,000' 
1000000000 - 9999999999 = '0,000,000,000' ;
NOTE: Format CUSTCOMMA has been output.
MPRINT(CREATE_PB_STD_FORMATS):   picture datefmt (default=45) low-high = 'Trans datD: %B %d, %Y %A' (datatype=date);
NOTE: Format DATEFMT has been output.
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT library=formats;
MPRINT(CREATE_PB_STD_FORMATS):   PICTURE dt2yrmon (default=10) other='%b%Y' (DATATYPE=DATETIME);
NOTE: Format DT2YRMON has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT library=formats;
MPRINT(CREATE_PB_STD_FORMATS):   PICTURE dt2yymmn (default=10) other='%Y%0m' (DATATYPE=DATETIME);
NOTE: Format DT2YYMMN has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   PROC FORMAT library=formats;
MPRINT(CREATE_PB_STD_FORMATS):   PICTURE dt2date (default=9) other='%Y%0m%0d' (DATATYPE=DATETIME);
NOTE: Format DT2DATE has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = DWHLIB.MST_CAMPAIGN_SID_PID_LK OUT=MST_CAMPAIGN_SID_PID_LK;
MPRINT(CREATE_PB_STD_FORMATS):   by sourced_association_id promo_code_id ;
67                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: Sorting was performed by the data source.
NOTE: There were 423 observations read from the data set DWHLIB.MST_CAMPAIGN_SID_PID_LK.
NOTE: The data set WORK.MST_CAMPAIGN_SID_PID_LK has 423 observations and 6 variables.
NOTE: Compressing data set WORK.MST_CAMPAIGN_SID_PID_LK decreased size by 88.89 percent. 
      Compressed is 1 pages; un-compressed would require 9 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.05 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = MST_CAMPAIGN_SID_PID_LK nodupkey;
MPRINT(CREATE_PB_STD_FORMATS):   by sourced_association_id promo_code_id;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 423 observations read from the data set WORK.MST_CAMPAIGN_SID_PID_LK.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.MST_CAMPAIGN_SID_PID_LK has 423 observations and 6 variables.
NOTE: Compressing data set WORK.MST_CAMPAIGN_SID_PID_LK decreased size by 88.89 percent. 
      Compressed is 1 pages; un-compressed would require 9 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   DATA fmt_CAMPAIGN_SID_PID_LK;
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN fmtname 'ENRCMPGN' type 'N';
MPRINT(CREATE_PB_STD_FORMATS):   SET MST_CAMPAIGN_SID_PID_LK;
MPRINT(CREATE_PB_STD_FORMATS):   start = SUM(sourced_association_id*1000, promo_code_id);
MPRINT(CREATE_PB_STD_FORMATS):   LABEL = strip(upcase(MARKETING_DESC));
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 423 observations read from the data set WORK.MST_CAMPAIGN_SID_PID_LK.
NOTE: The data set WORK.FMT_CAMPAIGN_SID_PID_LK has 423 observations and 10 variables.
NOTE: Compressing data set WORK.FMT_CAMPAIGN_SID_PID_LK decreased size by 80.00 percent. 
      Compressed is 2 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   proc format library=FORMATS CNTLIN=fmt_CAMPAIGN_SID_PID_LK;
NOTE: Format ENRCMPGN has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;

NOTE: There were 423 observations read from the data set WORK.FMT_CAMPAIGN_SID_PID_LK.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   run;
NOTE: %INCLUDE (level 1) file /sasdata/core_etl/prod/sas/includes/create_std_date_vars_inc.sas is file 
      /sasdata/core_etl/prod/sas/includes/create_std_date_vars_inc.sas.
1485      +/************************************************************************
1486      +*       Program      :  create_std_date_vars_inc.sas                    *
1487      +*                                                                       *
68                                                         The SAS System                              11:30 Friday, January 8, 2016

1488      +*                                                                       *
1489      +*       Owner        : Analytics, LSRPL                                 *
1490      +*                                                                       *
1491      +*       Author       :  LSRL/273, AMR                                   *
1492      +*                                                                       *
1493      +*       Input        :                                                  *
1494      +*                                                                       *
1495      +*                                                                       *
1496      +*                                                                       *
1497      +*       Output       :                                                  *
1498      +*                                                                       *
1499      +*                                                                       *
1500      +*                                                                       *
1501      +*       Dependencies :                                                  *
1502      +*                                                                       *
1503      +*       Description  :                                                  *
1504      +*                                                                       *
1505      +*                                                                       *
1506      +*       Usage        :                                                  *
1507      +*                                                                       *
1508      +*                                                                       *
1509      +*                                                                       *
1510      +*                                                                       *
1511      +*       History      :                                                  *
1512      +*       (Analyst)     (Date)    (Changes)                               *
1513      +*                                                                       *
1514      +************************************************************************/
1515      +
1516      +%global
1517      +	ST_1MTH_DATE
1518      +	ST_3MTH_DATE
1519      +	ST_6MTH_DATE
1520      +	ST_12MTH_DATE
1521      +
1522      +	BEG_1MTH_DATE
1523      +	BEG_3MTH_DATE
1524      +	BEG_6MTH_DATE
1525      +	BEG_12MTH_DATE
1526      +
1527      +	EOM_1MTH_DATE
1528      +	EOM_3MTH_DATE
1529      +	EOM_6MTH_DATE
1530      +	EOM_12MTH_DATE
1531      +;
1532      +
1533      +data _null_;
MPRINT(CREATE_PB_STD_FORMATS):   data _null_;
1534      +
1535      +	call symput("ST_1MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -1, "S"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("ST_1MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -1, "S"), DATE9.));
1536      +	call symput("ST_3MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -3, "S"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("ST_3MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -3, "S"), DATE9.));
1537      +	call symput("ST_6MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -6, "S"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("ST_6MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -6, "S"), DATE9.));
1538      +	call symput("ST_12MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -12, "S"), DATE9.));
69                                                         The SAS System                              11:30 Friday, January 8, 2016

SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("ST_12MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -12, "S"), DATE9.));
1539      +
1540      +	call symput("BEG_1MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -1, "B"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("BEG_1MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -1, "B"), DATE9.));
1541      +	call symput("BEG_3MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -3, "B"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("BEG_3MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -3, "B"), DATE9.));
1542      +	call symput("BEG_6MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -6, "B"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("BEG_6MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -6, "B"), DATE9.));
1543      +	call symput("BEG_12MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -12, "B"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("BEG_12MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -12, "B"), DATE9.));
1544      +
1545      +	call symput("EOM_1MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -1, "E"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("EOM_1MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -1, "E"), DATE9.));
1546      +	call symput("EOM_3MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -3, "E"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("EOM_3MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -3, "E"), DATE9.));
1547      +	call symput("EOM_6MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -6, "E"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("EOM_6MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -6, "E"), DATE9.));
1548      +	call symput("EOM_12MTH_DATE", put(intnx("MONTH", "&RUNDATE."D, -12, "E"), DATE9.));
SYMBOLGEN:  Macro variable RUNDATE resolves to 08JAN2016
MPRINT(CREATE_PB_STD_FORMATS):   call symput("EOM_12MTH_DATE", put(intnx("MONTH", "08JAN2016"D, -12, "E"), DATE9.));
1549      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

SYMBOLGEN:  Macro variable ST_1MTH_DATE resolves to 08DEC2015
1550      +
1551      +%put Same time last month (moving 1 month window): &st_1mth_date.;
Same time last month (moving 1 month window): 08DEC2015
1552      +%put Same time in last 3 months (moving 3 months window): &st_3mth_date.;
SYMBOLGEN:  Macro variable ST_3MTH_DATE resolves to 08OCT2015
Same time in last 3 months (moving 3 months window): 08OCT2015
1553      +%put Same time in last 6 months (moving 6 months window): &st_6mth_date.;
SYMBOLGEN:  Macro variable ST_6MTH_DATE resolves to 08JUL2015
Same time in last 6 months (moving 6 months window): 08JUL2015
1554      +%put Same time in last 12 months (moving 12 months window): &st_12mth_date.;
SYMBOLGEN:  Macro variable ST_12MTH_DATE resolves to 08JAN2015
Same time in last 12 months (moving 12 months window): 08JAN2015
1555      +
1556      +%put Prev 1 month cut-off date (Beginning of last month): &BEG_1MTH_DATE.;
SYMBOLGEN:  Macro variable BEG_1MTH_DATE resolves to 01DEC2015
Prev 1 month cut-off date (Beginning of last month): 01DEC2015
1557      +%put Prev 3 months cut-off date (Beginning of last 3 months): &BEG_3MTH_DATE.;
SYMBOLGEN:  Macro variable BEG_3MTH_DATE resolves to 01OCT2015
Prev 3 months cut-off date (Beginning of last 3 months): 01OCT2015
1558      +%put Prev 6 months cut-off date (Beginning of last 6 months): &BEG_6MTH_DATE.;
SYMBOLGEN:  Macro variable BEG_6MTH_DATE resolves to 01JUL2015
70                                                         The SAS System                              11:30 Friday, January 8, 2016

Prev 6 months cut-off date (Beginning of last 6 months): 01JUL2015
1559      +%put Prev 12 months cut-off date (Beginning of last 12 months): &BEG_12MTH_DATE.;
SYMBOLGEN:  Macro variable BEG_12MTH_DATE resolves to 01JAN2015
Prev 12 months cut-off date (Beginning of last 12 months): 01JAN2015
1560      +
1561      +%put Prev 1 month cut-off date (End of last month): &EOM_1MTH_DATE.;
SYMBOLGEN:  Macro variable EOM_1MTH_DATE resolves to 31DEC2015
Prev 1 month cut-off date (End of last month): 31DEC2015
1562      +%put Prev 3 months cut-off date (End of last 3 months): &EOM_3MTH_DATE.;
SYMBOLGEN:  Macro variable EOM_3MTH_DATE resolves to 31OCT2015
Prev 3 months cut-off date (End of last 3 months): 31OCT2015
1563      +%put Prev 6 months cut-off date (End of last 6 months): &EOM_6MTH_DATE.;
SYMBOLGEN:  Macro variable EOM_6MTH_DATE resolves to 31JUL2015
Prev 6 months cut-off date (End of last 6 months): 31JUL2015
1564      +%put Prev 12 months cut-off date (End of last 12 months): &EOM_12MTH_DATE.;
SYMBOLGEN:  Macro variable EOM_12MTH_DATE resolves to 31JAN2015
Prev 12 months cut-off date (End of last 12 months): 31JAN2015
NOTE: %INCLUDE (level 1) ending.
NOTE: %INCLUDE (level 1) file /sasdata/core_etl/prod/FG/includes/prep_fg_top_cities_fmt.sas is file 
      /sasdata/core_etl/prod/FG/includes/prep_fg_top_cities_fmt.sas.
1565      +/************************************************************************
1566      +*       Program      : prep_fg_top_cities_fmt.sas                       *
1567      +*                                                                       *
1568      +*                                                                       *
1569      +*       Owner        : Analytics, LSRPL                                 *
1570      +*                                                                       *
1571      +*       Author       :                                                  *
1572      +*                                                                       *
1573      +*       Input        :                                                  *
1574      +*                                                                       *
1575      +*                                                                       *
1576      +*                                                                       *
1577      +*       Output       :                                                  *
1578      +*                                                                       *
1579      +*                                                                       *
1580      +*                                                                       *
1581      +*       Dependencies :                                                  *
1582      +*                                                                       *
1583      +*       Description  :                                                  *
1584      +*                                                                       *
1585      +*                                                                       *
1586      +*       Usage        :                                                  *
1587      +*                                                                       *
1588      +*                                                                       *
1589      +*                                                                       *
1590      +*                                                                       *
1591      +*       History      :                                                  *
1592      +*       (Analyst)     (Date)    (Changes)                               *
1593      +*        LSRL/273   15MAY2013   Changed of source data to read          *
1594      +*                               SASMART.MLY_FG_SUMM_BY_FORMAT_MONTH     *
1595      +*                               (C0001)                                 *
1596      +*        LSRL/273   15MAY2013   Changed to rank performance by          *
1597      +*                               transaction_type_id from                *
1598      +*                               activity_action_id (C0002)              *
1599      +************************************************************************/
1600      +
1601      +options mprint mlogic symbolgen;
MPRINT(CREATE_PB_STD_FORMATS):   options mprint mlogic symbolgen;
71                                                         The SAS System                              11:30 Friday, January 8, 2016

1602      +
1603      +data _null_;
MPRINT(CREATE_PB_STD_FORMATS):   data _null_;
1604      +	call symput("MTH_CODE_1Mth", put("&BEG_1MTH_DATE"d, yymmn6.));
SYMBOLGEN:  Macro variable BEG_1MTH_DATE resolves to 01DEC2015
MPRINT(CREATE_PB_STD_FORMATS):   call symput("MTH_CODE_1Mth", put("01DEC2015"d, yymmn6.));
1605      +	call symput("MTH_CODE_3Mth", put("&BEG_3MTH_DATE"d, yymmn6.));
SYMBOLGEN:  Macro variable BEG_3MTH_DATE resolves to 01OCT2015
MPRINT(CREATE_PB_STD_FORMATS):   call symput("MTH_CODE_3Mth", put("01OCT2015"d, yymmn6.));
1606      +	call symput("MTH_CODE_6Mth", put("&BEG_6MTH_DATE"d, yymmn6.));
SYMBOLGEN:  Macro variable BEG_6MTH_DATE resolves to 01JUL2015
MPRINT(CREATE_PB_STD_FORMATS):   call symput("MTH_CODE_6Mth", put("01JUL2015"d, yymmn6.));
1607      +	call symput("MTH_CODE_12Mth", put("&BEG_12MTH_DATE"d, yymmn6.));
SYMBOLGEN:  Macro variable BEG_12MTH_DATE resolves to 01JAN2015
MPRINT(CREATE_PB_STD_FORMATS):   call symput("MTH_CODE_12Mth", put("01JAN2015"d, yymmn6.));
1608      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

SYMBOLGEN:  Macro variable MTH_CODE_1MTH resolves to 201512
1609      +
1610      +%put Month code 1 mth: &mth_code_1mth.;
Month code 1 mth: 201512
1611      +%put Month code 3 mth: &mth_code_3mth.;
SYMBOLGEN:  Macro variable MTH_CODE_3MTH resolves to 201510
Month code 3 mth: 201510
1612      +%put Month code 6 mth: &mth_code_6mth.;
SYMBOLGEN:  Macro variable MTH_CODE_6MTH resolves to 201507
Month code 6 mth: 201507
1613      +%put Month code 12 mth: &mth_code_12mth.;
SYMBOLGEN:  Macro variable MTH_CODE_12MTH resolves to 201501
Month code 12 mth: 201501
1614      +
1615      +proc format;
MPRINT(CREATE_PB_STD_FORMATS):   proc format;
1616      +	
1616     !+ value txnid2typ
1617      +	8,295 = "EARN"
1618      +	6,294 = "BURN"
1619      +	;
MPRINT(CREATE_PB_STD_FORMATS):   value txnid2typ 8,295 = "EARN" 6,294 = "BURN" ;
NOTE: Format TXNID2TYP has been output.
MPRINT(CREATE_PB_STD_FORMATS):   RUN;
1620      +RUN;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1621      +quit;
MPRINT(CREATE_PB_STD_FORMATS):   quit;
1622      +
1623      +
72                                                         The SAS System                              11:30 Friday, January 8, 2016

1624      +data work.Fg_summ_by_format_by_month / view=work.Fg_summ_by_format_by_month;
MPRINT(CREATE_PB_STD_FORMATS):   data work.Fg_summ_by_format_by_month / view=work.Fg_summ_by_format_by_month;
1625      +
1626      +	/* C0001 */
1627      +	set sasmart.Mly_fg_summ_by_format_month;
MPRINT(CREATE_PB_STD_FORMATS):   set sasmart.Mly_fg_summ_by_format_month;
1628      +	
1629      +	branch_city = put(strip(branch_id), $fgstr2cy.);
MPRINT(CREATE_PB_STD_FORMATS):   branch_city = put(strip(branch_id), $fgstr2cy.);
1630      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: DATA STEP view saved on file WORK.FG_SUMM_BY_FORMAT_BY_MONTH.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

1631      +
1632      +proc summary data=work.Fg_summ_by_format_by_month(
1633      +	keep=
1634      +		month_code
1635      +		transaction_type_id /* C0002 */
1636      +		branch_city
1637      +		p_commercial_name
1638      +		uniq_mem_count_mly
1639      +		tot_mly_activity_count
1640      +		tot_mly_points
1641      +		tot_mly_value
1642      +	) nway
1643      +;
MPRINT(CREATE_PB_STD_FORMATS):   proc summary data=work.Fg_summ_by_format_by_month( keep= month_code transaction_type_id 
branch_city p_commercial_name uniq_mem_count_mly tot_mly_activity_count tot_mly_points tot_mly_value ) nway ;
1644      +	where
1645      +		month_code >= "&MTH_CODE_1Mth."
SYMBOLGEN:  Macro variable MTH_CODE_1MTH resolves to 201512
1646      +	;
MPRINT(CREATE_PB_STD_FORMATS):   where month_code >= "201512" ;
1647      +
1648      +	class
1649      +		transaction_type_id
1650      +		branch_city
1651      +		p_commercial_name
1652      +	;
MPRINT(CREATE_PB_STD_FORMATS):   class transaction_type_id branch_city p_commercial_name ;
1653      +
1654      +	FORMAT transaction_type_id txnid2typ.;
MPRINT(CREATE_PB_STD_FORMATS):   FORMAT transaction_type_id txnid2typ.;
1655      +
1656      +	var
1657      +		uniq_mem_count_mly
1658      +		tot_mly_activity_count
1659      +		tot_mly_points
1660      +		tot_mly_value
1661      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var uniq_mem_count_mly tot_mly_activity_count tot_mly_points tot_mly_value ;
1662      +
73                                                         The SAS System                              11:30 Friday, January 8, 2016

1663      +	output out=
1664      +		fg_1mth_top_citylist_by_fmt_e (where=(transaction_type_id in (8,295)) drop=_type_ _freq_) /* C0002 */
1665      +			sum(uniq_mem_count_mly) = tot_1mth_earn_uniq_memcount
1666      +			sum(tot_mly_activity_count) = tot_1mth_earn_actcount
1667      +			sum(tot_mly_points) = tot_1mth_earn_points
1668      +			sum(tot_mly_value) = tot_1mth_earn_value
1669      +	;
MPRINT(CREATE_PB_STD_FORMATS):   output out= fg_1mth_top_citylist_by_fmt_e (where=(transaction_type_id in (8,295)) drop=_type_ 
_freq_) sum(uniq_mem_count_mly) = tot_1mth_earn_uniq_memcount sum(tot_mly_activity_count) = tot_1mth_earn_actcount 
sum(tot_mly_points) = tot_1mth_earn_points sum(tot_mly_value) = tot_1mth_earn_value ;
1670      +	output out=
1671      +		fg_1mth_top_citylist_by_fmt_b (where=(transaction_type_id in (6,294)) drop=_type_ _freq_) /* C0002 */
1672      +			sum(uniq_mem_count_mly) = tot_1mth_burn_uniq_memcount
1673      +			sum(tot_mly_activity_count) = tot_1mth_burn_actcount
1674      +			sum(tot_mly_points) = tot_1mth_burn_points
1675      +			sum(tot_mly_value) = tot_1mth_burn_value
1676      +	;
MPRINT(CREATE_PB_STD_FORMATS):   output out= fg_1mth_top_citylist_by_fmt_b (where=(transaction_type_id in (6,294)) drop=_type_ 
_freq_) sum(uniq_mem_count_mly) = tot_1mth_burn_uniq_memcount sum(tot_mly_activity_count) = tot_1mth_burn_actcount 
sum(tot_mly_points) = tot_1mth_burn_points sum(tot_mly_value) = tot_1mth_burn_value ;
1677      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: No observations were selected from data set WORK.FG_SUMM_BY_FORMAT_BY_MONTH.
NOTE: View WORK.FG_SUMM_BY_FORMAT_BY_MONTH.VIEW used (Total process time):
      real time           20.47 seconds
      cpu time            18.39 seconds
      
NOTE: There were 13414714 observations read from the data set SASMART.MLY_FG_SUMM_BY_FORMAT_MONTH.
NOTE: There were 0 observations read from the data set WORK.FG_SUMM_BY_FORMAT_BY_MONTH.
      WHERE month_code>='201512';
NOTE: The data set WORK.FG_1MTH_TOP_CITYLIST_BY_FMT_E has 0 observations and 7 variables.
NOTE: The data set WORK.FG_1MTH_TOP_CITYLIST_BY_FMT_B has 0 observations and 7 variables.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           20.48 seconds
      cpu time            18.39 seconds
      

1678      +
1679      +proc summary data=work.Fg_summ_by_format_by_month(
1680      +	keep=
1681      +		month_code
1682      +		/* C0002 */
1683      +		transaction_type_id
1684      +		branch_city
1685      +		p_commercial_name
1686      +		uniq_mem_count_mly
1687      +		tot_mly_activity_count
1688      +		tot_mly_points
1689      +		tot_mly_value
1690      +	) nway
1691      +;
MPRINT(CREATE_PB_STD_FORMATS):   proc summary data=work.Fg_summ_by_format_by_month( keep= month_code transaction_type_id 
branch_city p_commercial_name uniq_mem_count_mly tot_mly_activity_count tot_mly_points tot_mly_value ) nway ;
1692      +	where
1693      +		month_code >= "&MTH_CODE_3Mth."
SYMBOLGEN:  Macro variable MTH_CODE_3MTH resolves to 201510
1694      +	;
74                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   where month_code >= "201510" ;
1695      +
1696      +	class
1697      +		transaction_type_id
1698      +		branch_city
1699      +		p_commercial_name
1700      +	;
MPRINT(CREATE_PB_STD_FORMATS):   class transaction_type_id branch_city p_commercial_name ;
1701      +	var
1702      +		uniq_mem_count_mly
1703      +		tot_mly_activity_count
1704      +		tot_mly_points
1705      +		tot_mly_value
1706      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var uniq_mem_count_mly tot_mly_activity_count tot_mly_points tot_mly_value ;
1707      +
1708      +	FORMAT transaction_type_id txnid2typ.;
MPRINT(CREATE_PB_STD_FORMATS):   FORMAT transaction_type_id txnid2typ.;
1709      +
1710      +	output out=
1711      +		fg_3mth_top_citylist_by_fmt_e (where=(transaction_type_id in (8,295)) drop=_type_ _freq_) /* C0002 */
1712      +			sum(uniq_mem_count_mly) = tot_3mth_earn_uniq_memcount
1713      +			sum(tot_mly_activity_count) = tot_3mth_earn_actcount
1714      +			sum(tot_mly_points) = tot_3mth_earn_points
1715      +			sum(tot_mly_value) = tot_3mth_earn_value
1716      +	;
MPRINT(CREATE_PB_STD_FORMATS):   output out= fg_3mth_top_citylist_by_fmt_e (where=(transaction_type_id in (8,295)) drop=_type_ 
_freq_) sum(uniq_mem_count_mly) = tot_3mth_earn_uniq_memcount sum(tot_mly_activity_count) = tot_3mth_earn_actcount 
sum(tot_mly_points) = tot_3mth_earn_points sum(tot_mly_value) = tot_3mth_earn_value ;
1717      +	output out=
1718      +		fg_3mth_top_citylist_by_fmt_b (where=(transaction_type_id in (6,294)) drop=_type_ _freq_) /* C0002 */
1719      +			sum(uniq_mem_count_mly) = tot_3mth_burn_uniq_memcount
1720      +			sum(tot_mly_activity_count) = tot_3mth_burn_actcount
1721      +			sum(tot_mly_points) = tot_3mth_burn_points
1722      +			sum(tot_mly_value) = tot_3mth_burn_value
1723      +	;
MPRINT(CREATE_PB_STD_FORMATS):   output out= fg_3mth_top_citylist_by_fmt_b (where=(transaction_type_id in (6,294)) drop=_type_ 
_freq_) sum(uniq_mem_count_mly) = tot_3mth_burn_uniq_memcount sum(tot_mly_activity_count) = tot_3mth_burn_actcount 
sum(tot_mly_points) = tot_3mth_burn_points sum(tot_mly_value) = tot_3mth_burn_value ;
1724      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: No observations were selected from data set WORK.FG_SUMM_BY_FORMAT_BY_MONTH.
NOTE: View WORK.FG_SUMM_BY_FORMAT_BY_MONTH.VIEW used (Total process time):
      real time           9.30 seconds
      cpu time            9.31 seconds
      
NOTE: There were 13414714 observations read from the data set SASMART.MLY_FG_SUMM_BY_FORMAT_MONTH.
NOTE: There were 0 observations read from the data set WORK.FG_SUMM_BY_FORMAT_BY_MONTH.
      WHERE month_code>='201510';
NOTE: The data set WORK.FG_3MTH_TOP_CITYLIST_BY_FMT_E has 0 observations and 7 variables.
NOTE: The data set WORK.FG_3MTH_TOP_CITYLIST_BY_FMT_B has 0 observations and 7 variables.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           9.30 seconds
      cpu time            9.31 seconds
      

1725      +
75                                                         The SAS System                              11:30 Friday, January 8, 2016

1726      +proc summary data=work.Fg_summ_by_format_by_month(
1727      +	keep=
1728      +		month_code
1729      +		/* C0002 */
1730      +		transaction_type_id
1731      +		branch_city
1732      +		p_commercial_name
1733      +		uniq_mem_count_mly
1734      +		tot_mly_activity_count
1735      +		tot_mly_points
1736      +		tot_mly_value
1737      +	) nway
1738      +;
MPRINT(CREATE_PB_STD_FORMATS):   proc summary data=work.Fg_summ_by_format_by_month( keep= month_code transaction_type_id 
branch_city p_commercial_name uniq_mem_count_mly tot_mly_activity_count tot_mly_points tot_mly_value ) nway ;
1739      +	where
1740      +		month_code >= "&MTH_CODE_6Mth."
SYMBOLGEN:  Macro variable MTH_CODE_6MTH resolves to 201507
1741      +	;
MPRINT(CREATE_PB_STD_FORMATS):   where month_code >= "201507" ;
1742      +
1743      +	class
1744      +		transaction_type_id
1745      +		branch_city
1746      +		p_commercial_name
1747      +	;
MPRINT(CREATE_PB_STD_FORMATS):   class transaction_type_id branch_city p_commercial_name ;
1748      +	var
1749      +		uniq_mem_count_mly
1750      +		tot_mly_activity_count
1751      +		tot_mly_points
1752      +		tot_mly_value
1753      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var uniq_mem_count_mly tot_mly_activity_count tot_mly_points tot_mly_value ;
1754      +	FORMAT transaction_type_id txnid2typ.;
MPRINT(CREATE_PB_STD_FORMATS):   FORMAT transaction_type_id txnid2typ.;
1755      +
1756      +	output out=
1757      +		fg_6mth_top_citylist_by_fmt_e (where=(transaction_type_id in (8,295)) drop=_type_ _freq_) /* C0002 */
1758      +			sum(uniq_mem_count_mly) = tot_6mth_earn_uniq_memcount
1759      +			sum(tot_mly_activity_count) = tot_6mth_earn_actcount
1760      +			sum(tot_mly_points) = tot_6mth_earn_points
1761      +			sum(tot_mly_value) = tot_6mth_earn_value
1762      +	;
MPRINT(CREATE_PB_STD_FORMATS):   output out= fg_6mth_top_citylist_by_fmt_e (where=(transaction_type_id in (8,295)) drop=_type_ 
_freq_) sum(uniq_mem_count_mly) = tot_6mth_earn_uniq_memcount sum(tot_mly_activity_count) = tot_6mth_earn_actcount 
sum(tot_mly_points) = tot_6mth_earn_points sum(tot_mly_value) = tot_6mth_earn_value ;
1763      +	output out=
1764      +		fg_6mth_top_citylist_by_fmt_b (where=(transaction_type_id in (6,294)) drop=_type_ _freq_) /* C0002 */
1765      +			sum(uniq_mem_count_mly) = tot_6mth_burn_uniq_memcount
1766      +			sum(tot_mly_activity_count) = tot_6mth_burn_actcount
1767      +			sum(tot_mly_points) = tot_6mth_burn_points
1768      +			sum(tot_mly_value) = tot_6mth_burn_value
1769      +	;
MPRINT(CREATE_PB_STD_FORMATS):   output out= fg_6mth_top_citylist_by_fmt_b (where=(transaction_type_id in (6,294)) drop=_type_ 
_freq_) sum(uniq_mem_count_mly) = tot_6mth_burn_uniq_memcount sum(tot_mly_activity_count) = tot_6mth_burn_actcount 
sum(tot_mly_points) = tot_6mth_burn_points sum(tot_mly_value) = tot_6mth_burn_value ;
1770      +run;
76                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: No observations were selected from data set WORK.FG_SUMM_BY_FORMAT_BY_MONTH.
NOTE: View WORK.FG_SUMM_BY_FORMAT_BY_MONTH.VIEW used (Total process time):
      real time           9.38 seconds
      cpu time            9.38 seconds
      
NOTE: There were 13414714 observations read from the data set SASMART.MLY_FG_SUMM_BY_FORMAT_MONTH.
NOTE: There were 0 observations read from the data set WORK.FG_SUMM_BY_FORMAT_BY_MONTH.
      WHERE month_code>='201507';
NOTE: The data set WORK.FG_6MTH_TOP_CITYLIST_BY_FMT_E has 0 observations and 7 variables.
NOTE: The data set WORK.FG_6MTH_TOP_CITYLIST_BY_FMT_B has 0 observations and 7 variables.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           9.38 seconds
      cpu time            9.38 seconds
      

1771      +		
1772      +proc summary data=work.Fg_summ_by_format_by_month(
1773      +	keep=
1774      +		month_code
1775      +		/* C0002 */
1776      +		transaction_type_id
1777      +		branch_city
1778      +		p_commercial_name
1779      +		uniq_mem_count_mly
1780      +		tot_mly_activity_count
1781      +		tot_mly_points
1782      +		tot_mly_value
1783      +	) nway
1784      +;
MPRINT(CREATE_PB_STD_FORMATS):   proc summary data=work.Fg_summ_by_format_by_month( keep= month_code transaction_type_id 
branch_city p_commercial_name uniq_mem_count_mly tot_mly_activity_count tot_mly_points tot_mly_value ) nway ;
1785      +	where
1786      +		month_code >= "&MTH_CODE_12Mth."
SYMBOLGEN:  Macro variable MTH_CODE_12MTH resolves to 201501
1787      +	;
MPRINT(CREATE_PB_STD_FORMATS):   where month_code >= "201501" ;
1788      +
1789      +	class
1790      +		transaction_type_id
1791      +		branch_city
1792      +		p_commercial_name
1793      +	;
MPRINT(CREATE_PB_STD_FORMATS):   class transaction_type_id branch_city p_commercial_name ;
1794      +
1795      +	FORMAT transaction_type_id txnid2typ.;
MPRINT(CREATE_PB_STD_FORMATS):   FORMAT transaction_type_id txnid2typ.;
1796      +
1797      +	var
1798      +		uniq_mem_count_mly
1799      +		tot_mly_activity_count
1800      +		tot_mly_points
1801      +		tot_mly_value
1802      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var uniq_mem_count_mly tot_mly_activity_count tot_mly_points tot_mly_value ;
1803      +	output out=
1804      +		fg_12mth_top_citylist_by_fmt_e (where=(transaction_type_id in (8,295)) drop=_type_ _freq_) /* C0002 */
77                                                         The SAS System                              11:30 Friday, January 8, 2016

1805      +			sum(uniq_mem_count_mly) = tot_12mth_earn_uniq_memcount
1806      +			sum(tot_mly_activity_count) = tot_12mth_earn_actcount
1807      +			sum(tot_mly_points) = tot_12mth_earn_points
1808      +			sum(tot_mly_value) = tot_12mth_earn_value
1809      +	;			
MPRINT(CREATE_PB_STD_FORMATS):   output out= fg_12mth_top_citylist_by_fmt_e (where=(transaction_type_id in (8,295)) drop=_type_ 
_freq_) sum(uniq_mem_count_mly) = tot_12mth_earn_uniq_memcount sum(tot_mly_activity_count) = tot_12mth_earn_actcount 
sum(tot_mly_points) = tot_12mth_earn_points sum(tot_mly_value) = tot_12mth_earn_value ;
1810      +	output out=
1811      +		fg_12mth_top_citylist_by_fmt_b (where=(transaction_type_id in (6,294)) drop=_type_ _freq_) /* C0002 */
1812      +			sum(uniq_mem_count_mly) = tot_12mth_burn_uniq_memcount
1813      +			sum(tot_mly_activity_count) = tot_12mth_burn_actcount
1814      +			sum(tot_mly_points) = tot_12mth_burn_points
1815      +			sum(tot_mly_value) = tot_12mth_burn_value
1816      +	;
MPRINT(CREATE_PB_STD_FORMATS):   output out= fg_12mth_top_citylist_by_fmt_b (where=(transaction_type_id in (6,294)) drop=_type_ 
_freq_) sum(uniq_mem_count_mly) = tot_12mth_burn_uniq_memcount sum(tot_mly_activity_count) = tot_12mth_burn_actcount 
sum(tot_mly_points) = tot_12mth_burn_points sum(tot_mly_value) = tot_12mth_burn_value ;
1817      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: No observations were selected from data set WORK.FG_SUMM_BY_FORMAT_BY_MONTH.
NOTE: View WORK.FG_SUMM_BY_FORMAT_BY_MONTH.VIEW used (Total process time):
      real time           9.03 seconds
      cpu time            9.04 seconds
      
NOTE: There were 13414714 observations read from the data set SASMART.MLY_FG_SUMM_BY_FORMAT_MONTH.
NOTE: There were 0 observations read from the data set WORK.FG_SUMM_BY_FORMAT_BY_MONTH.
      WHERE month_code>='201501';
NOTE: The data set WORK.FG_12MTH_TOP_CITYLIST_BY_FMT_E has 0 observations and 7 variables.
NOTE: The data set WORK.FG_12MTH_TOP_CITYLIST_BY_FMT_B has 0 observations and 7 variables.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           9.03 seconds
      cpu time            9.04 seconds
      

1818      +
1819      +/* PTD summary */
1820      +
1821      +DATA work.Fg_summ_by_format_PTD;
MPRINT(CREATE_PB_STD_FORMATS):   DATA work.Fg_summ_by_format_PTD;
1822      +	set SASMART.Mly_fg_summ_format_ptd;
MPRINT(CREATE_PB_STD_FORMATS):   set SASMART.Mly_fg_summ_format_ptd;
1823      +
1824      +	BRANCH_city = PUT(strip(branch_id), $fgstr2cy.);
MPRINT(CREATE_PB_STD_FORMATS):   BRANCH_city = PUT(strip(branch_id), $fgstr2cy.);
1825      +RUN;
MPRINT(CREATE_PB_STD_FORMATS):   RUN;

NOTE: There were 2751736 observations read from the data set SASMART.MLY_FG_SUMM_FORMAT_PTD.
NOTE: The data set WORK.FG_SUMM_BY_FORMAT_PTD has 2751736 observations and 12 variables.
NOTE: Compressing data set WORK.FG_SUMM_BY_FORMAT_PTD decreased size by 28.96 percent. 
      Compressed is 31031 pages; un-compressed would require 43679 pages.
NOTE: DATA statement used (Total process time):
      real time           6.46 seconds
      cpu time            6.06 seconds
      

78                                                         The SAS System                              11:30 Friday, January 8, 2016

1826      +
1827      +proc summary data=work.Fg_summ_by_format_PTD(
1828      +	keep=
1829      +		/* C0002 */
1830      +		transaction_type_id
1831      +		branch_city
1832      +		p_commercial_name
1833      +		uniq_mem_count_ptd
1834      +		tot_ptd_activity_count
1835      +		tot_ptd_points
1836      +		tot_ptd_value
1837      +	) nway
1838      +;
MPRINT(CREATE_PB_STD_FORMATS):   proc summary data=work.Fg_summ_by_format_PTD( keep= transaction_type_id branch_city 
p_commercial_name uniq_mem_count_ptd tot_ptd_activity_count tot_ptd_points tot_ptd_value ) nway ;
1839      +
1840      +	class
1841      +		transaction_type_id
1842      +		branch_city
1843      +		p_commercial_name
1844      +	;
MPRINT(CREATE_PB_STD_FORMATS):   class transaction_type_id branch_city p_commercial_name ;
1845      +
1846      +	FORMAT transaction_type_id txnid2typ.;
MPRINT(CREATE_PB_STD_FORMATS):   FORMAT transaction_type_id txnid2typ.;
1847      +
1848      +	var
1849      +		uniq_mem_count_ptd
1850      +		tot_ptd_activity_count
1851      +		tot_ptd_points
1852      +		tot_ptd_value
1853      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var uniq_mem_count_ptd tot_ptd_activity_count tot_ptd_points tot_ptd_value ;
1854      +	output out=
1855      +		fg_ptd_top_citylist_by_fmt_e (where=(transaction_type_id in (8,295)) drop=_type_ _freq_) /* C0002 */
1856      +			sum(uniq_mem_count_ptd) = tot_ptd_earn_uniq_memcount
1857      +			sum(tot_ptd_activity_count) = tot_ptd_earn_actcount
1858      +			sum(tot_ptd_points) = tot_ptd_earn_points
1859      +			sum(tot_ptd_value) = tot_ptd_earn_value
1860      +	;			
MPRINT(CREATE_PB_STD_FORMATS):   output out= fg_ptd_top_citylist_by_fmt_e (where=(transaction_type_id in (8,295)) drop=_type_ 
_freq_) sum(uniq_mem_count_ptd) = tot_ptd_earn_uniq_memcount sum(tot_ptd_activity_count) = tot_ptd_earn_actcount 
sum(tot_ptd_points) = tot_ptd_earn_points sum(tot_ptd_value) = tot_ptd_earn_value ;
1861      +	output out=
1862      +		fg_ptd_top_citylist_by_fmt_b (where=(transaction_type_id in (6,294)) drop=_type_ _freq_) /* C0002 */
1863      +			sum(uniq_mem_count_ptd) = tot_ptd_burn_uniq_memcount
1864      +			sum(tot_ptd_activity_count) = tot_ptd_burn_actcount
1865      +			sum(tot_ptd_points) = tot_ptd_burn_points
1866      +			sum(tot_ptd_value) = tot_ptd_burn_value
1867      +	;
MPRINT(CREATE_PB_STD_FORMATS):   output out= fg_ptd_top_citylist_by_fmt_b (where=(transaction_type_id in (6,294)) drop=_type_ 
_freq_) sum(uniq_mem_count_ptd) = tot_ptd_burn_uniq_memcount sum(tot_ptd_activity_count) = tot_ptd_burn_actcount 
sum(tot_ptd_points) = tot_ptd_burn_points sum(tot_ptd_value) = tot_ptd_burn_value ;
1868      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 2751736 observations read from the data set WORK.FG_SUMM_BY_FORMAT_PTD.
NOTE: The data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_E has 317 observations and 7 variables.
79                                                         The SAS System                              11:30 Friday, January 8, 2016

NOTE: Compressing data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_E decreased size by 0.00 percent. 
      Compressed is 4 pages; un-compressed would require 4 pages.
NOTE: The data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_B has 282 observations and 7 variables.
NOTE: Compressing data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_B decreased size by 25.00 percent. 
      Compressed is 3 pages; un-compressed would require 4 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           1.64 seconds
      cpu time            3.44 seconds
      

1869      +
1870      +
1871      +
1872      +/* Ranking step */
1873      +
1874      +proc sort data = fg_1mth_top_citylist_by_fmt_e;
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = fg_1mth_top_citylist_by_fmt_e;
1875      +	by
1876      +		p_commercial_name
1877      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1878      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: Input data set is empty.
NOTE: The data set WORK.FG_1MTH_TOP_CITYLIST_BY_FMT_E has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1879      +
1880      +proc sort data = fg_1mth_top_citylist_by_fmt_b;
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = fg_1mth_top_citylist_by_fmt_b;
1881      +	by
1882      +		p_commercial_name
1883      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1884      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: Input data set is empty.
NOTE: The data set WORK.FG_1MTH_TOP_CITYLIST_BY_FMT_B has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1885      +
1886      +proc sort data = fg_3mth_top_citylist_by_fmt_e;
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = fg_3mth_top_citylist_by_fmt_e;
1887      +	by
1888      +		p_commercial_name
1889      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1890      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

80                                                         The SAS System                              11:30 Friday, January 8, 2016

NOTE: Input data set is empty.
NOTE: The data set WORK.FG_3MTH_TOP_CITYLIST_BY_FMT_E has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1891      +
1892      +proc sort data = fg_3mth_top_citylist_by_fmt_b;
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = fg_3mth_top_citylist_by_fmt_b;
1893      +	by
1894      +		p_commercial_name
1895      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1896      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: Input data set is empty.
NOTE: The data set WORK.FG_3MTH_TOP_CITYLIST_BY_FMT_B has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

1897      +
1898      +proc sort data = fg_6mth_top_citylist_by_fmt_e;
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = fg_6mth_top_citylist_by_fmt_e;
1899      +	by
1900      +		p_commercial_name
1901      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1902      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: Input data set is empty.
NOTE: The data set WORK.FG_6MTH_TOP_CITYLIST_BY_FMT_E has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1903      +
1904      +proc sort data = fg_6mth_top_citylist_by_fmt_b;
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = fg_6mth_top_citylist_by_fmt_b;
1905      +	by
1906      +		p_commercial_name
1907      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1908      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: Input data set is empty.
NOTE: The data set WORK.FG_6MTH_TOP_CITYLIST_BY_FMT_B has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

81                                                         The SAS System                              11:30 Friday, January 8, 2016

1909      +
1910      +proc sort data = fg_12mth_top_citylist_by_fmt_e;
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = fg_12mth_top_citylist_by_fmt_e;
1911      +	by
1912      +		p_commercial_name
1913      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1914      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: Input data set is empty.
NOTE: The data set WORK.FG_12MTH_TOP_CITYLIST_BY_FMT_E has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1915      +
1916      +proc sort data = fg_12mth_top_citylist_by_fmt_b;
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = fg_12mth_top_citylist_by_fmt_b;
1917      +	by
1918      +		p_commercial_name
1919      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1920      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: Input data set is empty.
NOTE: The data set WORK.FG_12MTH_TOP_CITYLIST_BY_FMT_B has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1921      +
1922      +proc sort data = fg_ptd_top_citylist_by_fmt_e;
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = fg_ptd_top_citylist_by_fmt_e;
1923      +	by
1924      +		p_commercial_name
1925      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1926      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 317 observations read from the data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_E.
NOTE: The data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_E has 317 observations and 7 variables.
NOTE: Compressing data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_E decreased size by 0.00 percent. 
      Compressed is 4 pages; un-compressed would require 4 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1927      +
1928      +proc sort data = fg_ptd_top_citylist_by_fmt_b;
MPRINT(CREATE_PB_STD_FORMATS):   proc sort data = fg_ptd_top_citylist_by_fmt_b;
1929      +	by
1930      +		p_commercial_name
82                                                         The SAS System                              11:30 Friday, January 8, 2016

1931      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1932      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 282 observations read from the data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_B.
NOTE: The data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_B has 282 observations and 7 variables.
NOTE: Compressing data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_B decreased size by 25.00 percent. 
      Compressed is 3 pages; un-compressed would require 4 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

1933      +
1934      +
1935      +
1936      +proc rank data = fg_1mth_top_citylist_by_fmt_e out=fg_1mth_top_city_by_fmt_e_ranks
1937      +		(
1938      +		keep=
1939      +			p_commercial_name
1940      +			branch_city
1941      +			top_1mth_earn_rank_by_memcnt
1942      +			top_1mth_earn_rank_by_actcnt
1943      +			top_1mth_earn_rank_by_points
1944      +			top_1mth_earn_rank_by_value
1945      +		) descending ties=low
1946      +	;
MPRINT(CREATE_PB_STD_FORMATS):   proc rank data = fg_1mth_top_citylist_by_fmt_e out=fg_1mth_top_city_by_fmt_e_ranks ( keep= 
p_commercial_name branch_city top_1mth_earn_rank_by_memcnt top_1mth_earn_rank_by_actcnt top_1mth_earn_rank_by_points 
top_1mth_earn_rank_by_value ) descending ties=low ;
1947      +
1948      +	by
1949      +		p_commercial_name
1950      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1951      +
1952      +	var
1953      +		tot_1mth_earn_uniq_memcount
1954      +		tot_1mth_earn_actcount
1955      +		tot_1mth_earn_points
1956      +		tot_1mth_earn_value
1957      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var tot_1mth_earn_uniq_memcount tot_1mth_earn_actcount tot_1mth_earn_points tot_1mth_earn_value ;
1958      +
1959      +	ranks
1960      +		top_1mth_earn_rank_by_memcnt
1961      +		top_1mth_earn_rank_by_actcnt
1962      +		top_1mth_earn_rank_by_points
1963      +		top_1mth_earn_rank_by_value
1964      +	;
MPRINT(CREATE_PB_STD_FORMATS):   ranks top_1mth_earn_rank_by_memcnt top_1mth_earn_rank_by_actcnt top_1mth_earn_rank_by_points 
top_1mth_earn_rank_by_value ;
1965      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_1MTH_TOP_CITYLIST_BY_FMT_E.
NOTE: The data set WORK.FG_1MTH_TOP_CITY_BY_FMT_E_RANKS has 0 observations and 6 variables.
83                                                         The SAS System                              11:30 Friday, January 8, 2016

NOTE: PROCEDURE RANK used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
1966      +quit;
1967      +
1968      +proc rank data = fg_1mth_top_citylist_by_fmt_b out=fg_1mth_top_city_by_fmt_b_ranks
1969      +		(
1970      +		keep=
1971      +			p_commercial_name
1972      +			branch_city
1973      +			top_1mth_burn_rank_by_memcnt
1974      +			top_1mth_burn_rank_by_actcnt
1975      +			top_1mth_burn_rank_by_points
1976      +			top_1mth_burn_rank_by_value
1977      +		) descending ties=low
1978      +	;
MPRINT(CREATE_PB_STD_FORMATS):   proc rank data = fg_1mth_top_citylist_by_fmt_b out=fg_1mth_top_city_by_fmt_b_ranks ( keep= 
p_commercial_name branch_city top_1mth_burn_rank_by_memcnt top_1mth_burn_rank_by_actcnt top_1mth_burn_rank_by_points 
top_1mth_burn_rank_by_value ) descending ties=low ;
1979      +
1980      +	by
1981      +		p_commercial_name
1982      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
1983      +
1984      +	var
1985      +		tot_1mth_burn_uniq_memcount
1986      +		tot_1mth_burn_actcount
1987      +		tot_1mth_burn_points
1988      +		tot_1mth_burn_value
1989      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var tot_1mth_burn_uniq_memcount tot_1mth_burn_actcount tot_1mth_burn_points tot_1mth_burn_value ;
1990      +
1991      +	ranks
1992      +		top_1mth_burn_rank_by_memcnt
1993      +		top_1mth_burn_rank_by_actcnt
1994      +		top_1mth_burn_rank_by_points
1995      +		top_1mth_burn_rank_by_value
1996      +	;
MPRINT(CREATE_PB_STD_FORMATS):   ranks top_1mth_burn_rank_by_memcnt top_1mth_burn_rank_by_actcnt top_1mth_burn_rank_by_points 
top_1mth_burn_rank_by_value ;
1997      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_1MTH_TOP_CITYLIST_BY_FMT_B.
NOTE: The data set WORK.FG_1MTH_TOP_CITY_BY_FMT_B_RANKS has 0 observations and 6 variables.
NOTE: PROCEDURE RANK used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
1998      +quit;
1999      +
2000      +proc rank data = fg_3mth_top_citylist_by_fmt_e out=fg_3mth_top_city_by_fmt_e_ranks
84                                                         The SAS System                              11:30 Friday, January 8, 2016

2001      +		(
2002      +		keep=
2003      +			p_commercial_name
2004      +			branch_city
2005      +			top_3mth_earn_rank_by_memcnt
2006      +			top_3mth_earn_rank_by_actcnt
2007      +			top_3mth_earn_rank_by_points
2008      +			top_3mth_earn_rank_by_value
2009      +		) descending ties=low
2010      +	;
MPRINT(CREATE_PB_STD_FORMATS):   proc rank data = fg_3mth_top_citylist_by_fmt_e out=fg_3mth_top_city_by_fmt_e_ranks ( keep= 
p_commercial_name branch_city top_3mth_earn_rank_by_memcnt top_3mth_earn_rank_by_actcnt top_3mth_earn_rank_by_points 
top_3mth_earn_rank_by_value ) descending ties=low ;
2011      +
2012      +	by
2013      +		p_commercial_name
2014      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
2015      +
2016      +	var
2017      +		tot_3mth_earn_uniq_memcount
2018      +		tot_3mth_earn_actcount
2019      +		tot_3mth_earn_points
2020      +		tot_3mth_earn_value
2021      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var tot_3mth_earn_uniq_memcount tot_3mth_earn_actcount tot_3mth_earn_points tot_3mth_earn_value ;
2022      +
2023      +	ranks
2024      +		top_3mth_earn_rank_by_memcnt
2025      +		top_3mth_earn_rank_by_actcnt
2026      +		top_3mth_earn_rank_by_points
2027      +		top_3mth_earn_rank_by_value
2028      +	;
MPRINT(CREATE_PB_STD_FORMATS):   ranks top_3mth_earn_rank_by_memcnt top_3mth_earn_rank_by_actcnt top_3mth_earn_rank_by_points 
top_3mth_earn_rank_by_value ;
2029      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_3MTH_TOP_CITYLIST_BY_FMT_E.
NOTE: The data set WORK.FG_3MTH_TOP_CITY_BY_FMT_E_RANKS has 0 observations and 6 variables.
NOTE: PROCEDURE RANK used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
2030      +quit;
2031      +
2032      +proc rank data = fg_3mth_top_citylist_by_fmt_b out=fg_3mth_top_city_by_fmt_b_ranks
2033      +		(
2034      +		keep=
2035      +			p_commercial_name
2036      +			branch_city
2037      +			top_3mth_burn_rank_by_memcnt
2038      +			top_3mth_burn_rank_by_actcnt
2039      +			top_3mth_burn_rank_by_points
2040      +			top_3mth_burn_rank_by_value
2041      +		) descending ties=low
85                                                         The SAS System                              11:30 Friday, January 8, 2016

2042      +	;
MPRINT(CREATE_PB_STD_FORMATS):   proc rank data = fg_3mth_top_citylist_by_fmt_b out=fg_3mth_top_city_by_fmt_b_ranks ( keep= 
p_commercial_name branch_city top_3mth_burn_rank_by_memcnt top_3mth_burn_rank_by_actcnt top_3mth_burn_rank_by_points 
top_3mth_burn_rank_by_value ) descending ties=low ;
2043      +
2044      +	by
2045      +		p_commercial_name
2046      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
2047      +
2048      +	var
2049      +		tot_3mth_burn_uniq_memcount
2050      +		tot_3mth_burn_actcount
2051      +		tot_3mth_burn_points
2052      +		tot_3mth_burn_value
2053      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var tot_3mth_burn_uniq_memcount tot_3mth_burn_actcount tot_3mth_burn_points tot_3mth_burn_value ;
2054      +
2055      +	ranks
2056      +		top_3mth_burn_rank_by_memcnt
2057      +		top_3mth_burn_rank_by_actcnt
2058      +		top_3mth_burn_rank_by_points
2059      +		top_3mth_burn_rank_by_value
2060      +	;
MPRINT(CREATE_PB_STD_FORMATS):   ranks top_3mth_burn_rank_by_memcnt top_3mth_burn_rank_by_actcnt top_3mth_burn_rank_by_points 
top_3mth_burn_rank_by_value ;
2061      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_3MTH_TOP_CITYLIST_BY_FMT_B.
NOTE: The data set WORK.FG_3MTH_TOP_CITY_BY_FMT_B_RANKS has 0 observations and 6 variables.
NOTE: PROCEDURE RANK used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
2062      +quit;
2063      +
2064      +proc rank data = fg_6mth_top_citylist_by_fmt_e out=fg_6mth_top_city_by_fmt_e_ranks
2065      +		(
2066      +		keep=
2067      +			p_commercial_name
2068      +			branch_city
2069      +			top_6mth_earn_rank_by_memcnt
2070      +			top_6mth_earn_rank_by_actcnt
2071      +			top_6mth_earn_rank_by_points
2072      +			top_6mth_earn_rank_by_value
2073      +		) descending ties=low
2074      +	;
MPRINT(CREATE_PB_STD_FORMATS):   proc rank data = fg_6mth_top_citylist_by_fmt_e out=fg_6mth_top_city_by_fmt_e_ranks ( keep= 
p_commercial_name branch_city top_6mth_earn_rank_by_memcnt top_6mth_earn_rank_by_actcnt top_6mth_earn_rank_by_points 
top_6mth_earn_rank_by_value ) descending ties=low ;
2075      +
2076      +	by
2077      +		p_commercial_name
2078      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
86                                                         The SAS System                              11:30 Friday, January 8, 2016

2079      +
2080      +	var
2081      +		tot_6mth_earn_uniq_memcount
2082      +		tot_6mth_earn_actcount
2083      +		tot_6mth_earn_points
2084      +		tot_6mth_earn_value
2085      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var tot_6mth_earn_uniq_memcount tot_6mth_earn_actcount tot_6mth_earn_points tot_6mth_earn_value ;
2086      +
2087      +	ranks
2088      +		top_6mth_earn_rank_by_memcnt
2089      +		top_6mth_earn_rank_by_actcnt
2090      +		top_6mth_earn_rank_by_points
2091      +		top_6mth_earn_rank_by_value
2092      +	;
MPRINT(CREATE_PB_STD_FORMATS):   ranks top_6mth_earn_rank_by_memcnt top_6mth_earn_rank_by_actcnt top_6mth_earn_rank_by_points 
top_6mth_earn_rank_by_value ;
2093      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_6MTH_TOP_CITYLIST_BY_FMT_E.
NOTE: The data set WORK.FG_6MTH_TOP_CITY_BY_FMT_E_RANKS has 0 observations and 6 variables.
NOTE: PROCEDURE RANK used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
2094      +quit;
2095      +
2096      +proc rank data = fg_6mth_top_citylist_by_fmt_b out=fg_6mth_top_city_by_fmt_b_ranks
2097      +		(
2098      +		keep=
2099      +			p_commercial_name
2100      +			branch_city
2101      +			top_6mth_burn_rank_by_memcnt
2102      +			top_6mth_burn_rank_by_actcnt
2103      +			top_6mth_burn_rank_by_points
2104      +			top_6mth_burn_rank_by_value
2105      +		) descending ties=low
2106      +	;
MPRINT(CREATE_PB_STD_FORMATS):   proc rank data = fg_6mth_top_citylist_by_fmt_b out=fg_6mth_top_city_by_fmt_b_ranks ( keep= 
p_commercial_name branch_city top_6mth_burn_rank_by_memcnt top_6mth_burn_rank_by_actcnt top_6mth_burn_rank_by_points 
top_6mth_burn_rank_by_value ) descending ties=low ;
2107      +
2108      +	by
2109      +		p_commercial_name
2110      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
2111      +
2112      +	var
2113      +		tot_6mth_burn_uniq_memcount
2114      +		tot_6mth_burn_actcount
2115      +		tot_6mth_burn_points
2116      +		tot_6mth_burn_value
2117      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var tot_6mth_burn_uniq_memcount tot_6mth_burn_actcount tot_6mth_burn_points tot_6mth_burn_value ;
2118      +
87                                                         The SAS System                              11:30 Friday, January 8, 2016

2119      +	ranks
2120      +		top_6mth_burn_rank_by_memcnt
2121      +		top_6mth_burn_rank_by_actcnt
2122      +		top_6mth_burn_rank_by_points
2123      +		top_6mth_burn_rank_by_value
2124      +	;
MPRINT(CREATE_PB_STD_FORMATS):   ranks top_6mth_burn_rank_by_memcnt top_6mth_burn_rank_by_actcnt top_6mth_burn_rank_by_points 
top_6mth_burn_rank_by_value ;
2125      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_6MTH_TOP_CITYLIST_BY_FMT_B.
NOTE: The data set WORK.FG_6MTH_TOP_CITY_BY_FMT_B_RANKS has 0 observations and 6 variables.
NOTE: PROCEDURE RANK used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
2126      +quit;
2127      +
2128      +proc rank data = fg_12mth_top_citylist_by_fmt_e out=fg_12mth_top_city_by_fmt_e_ranks
2129      +		(
2130      +		keep=
2131      +			p_commercial_name
2132      +			branch_city
2133      +			top_12mth_earn_rank_by_memcnt
2134      +			top_12mth_earn_rank_by_actcnt
2135      +			top_12mth_earn_rank_by_points
2136      +			top_12mth_earn_rank_by_value
2137      +		) descending ties=low
2138      +	;
MPRINT(CREATE_PB_STD_FORMATS):   proc rank data = fg_12mth_top_citylist_by_fmt_e out=fg_12mth_top_city_by_fmt_e_ranks ( keep= 
p_commercial_name branch_city top_12mth_earn_rank_by_memcnt top_12mth_earn_rank_by_actcnt top_12mth_earn_rank_by_points 
top_12mth_earn_rank_by_value ) descending ties=low ;
2139      +
2140      +	by
2141      +		p_commercial_name
2142      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
2143      +
2144      +	var
2145      +		tot_12mth_earn_uniq_memcount
2146      +		tot_12mth_earn_actcount
2147      +		tot_12mth_earn_points
2148      +		tot_12mth_earn_value
2149      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var tot_12mth_earn_uniq_memcount tot_12mth_earn_actcount tot_12mth_earn_points 
tot_12mth_earn_value ;
2150      +
2151      +	ranks
2152      +		top_12mth_earn_rank_by_memcnt
2153      +		top_12mth_earn_rank_by_actcnt
2154      +		top_12mth_earn_rank_by_points
2155      +		top_12mth_earn_rank_by_value
2156      +	;
MPRINT(CREATE_PB_STD_FORMATS):   ranks top_12mth_earn_rank_by_memcnt top_12mth_earn_rank_by_actcnt top_12mth_earn_rank_by_points 
top_12mth_earn_rank_by_value ;
88                                                         The SAS System                              11:30 Friday, January 8, 2016

2157      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_12MTH_TOP_CITYLIST_BY_FMT_E.
NOTE: The data set WORK.FG_12MTH_TOP_CITY_BY_FMT_E_RANKS has 0 observations and 6 variables.
NOTE: PROCEDURE RANK used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
2158      +quit;
2159      +
2160      +proc rank data = fg_12mth_top_citylist_by_fmt_b out=fg_12mth_top_city_by_fmt_b_ranks
2161      +		(
2162      +		keep=
2163      +			p_commercial_name
2164      +			branch_city
2165      +			top_12mth_burn_rank_by_memcnt
2166      +			top_12mth_burn_rank_by_actcnt
2167      +			top_12mth_burn_rank_by_points
2168      +			top_12mth_burn_rank_by_value
2169      +		) descending ties=low
2170      +	;
MPRINT(CREATE_PB_STD_FORMATS):   proc rank data = fg_12mth_top_citylist_by_fmt_b out=fg_12mth_top_city_by_fmt_b_ranks ( keep= 
p_commercial_name branch_city top_12mth_burn_rank_by_memcnt top_12mth_burn_rank_by_actcnt top_12mth_burn_rank_by_points 
top_12mth_burn_rank_by_value ) descending ties=low ;
2171      +
2172      +	by
2173      +		p_commercial_name
2174      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
2175      +
2176      +	var
2177      +		tot_12mth_burn_uniq_memcount
2178      +		tot_12mth_burn_actcount
2179      +		tot_12mth_burn_points
2180      +		tot_12mth_burn_value
2181      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var tot_12mth_burn_uniq_memcount tot_12mth_burn_actcount tot_12mth_burn_points 
tot_12mth_burn_value ;
2182      +
2183      +	ranks
2184      +		top_12mth_burn_rank_by_memcnt
2185      +		top_12mth_burn_rank_by_actcnt
2186      +		top_12mth_burn_rank_by_points
2187      +		top_12mth_burn_rank_by_value
2188      +	;
MPRINT(CREATE_PB_STD_FORMATS):   ranks top_12mth_burn_rank_by_memcnt top_12mth_burn_rank_by_actcnt top_12mth_burn_rank_by_points 
top_12mth_burn_rank_by_value ;
2189      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_12MTH_TOP_CITYLIST_BY_FMT_B.
NOTE: The data set WORK.FG_12MTH_TOP_CITY_BY_FMT_B_RANKS has 0 observations and 6 variables.
NOTE: PROCEDURE RANK used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
89                                                         The SAS System                              11:30 Friday, January 8, 2016

      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
2190      +quit;
2191      +
2192      +
2193      +
2194      +proc rank data = fg_ptd_top_citylist_by_fmt_e out=fg_ptd_top_city_by_fmt_e_ranks
2195      +		(
2196      +		keep=
2197      +			p_commercial_name
2198      +			branch_city
2199      +			top_ptd_earn_rank_by_memcnt
2200      +			top_ptd_earn_rank_by_actcnt
2201      +			top_ptd_earn_rank_by_points
2202      +			top_ptd_earn_rank_by_value
2203      +		) descending ties=low
2204      +	;
MPRINT(CREATE_PB_STD_FORMATS):   proc rank data = fg_ptd_top_citylist_by_fmt_e out=fg_ptd_top_city_by_fmt_e_ranks ( keep= 
p_commercial_name branch_city top_ptd_earn_rank_by_memcnt top_ptd_earn_rank_by_actcnt top_ptd_earn_rank_by_points 
top_ptd_earn_rank_by_value ) descending ties=low ;
2205      +
2206      +	by
2207      +		p_commercial_name
2208      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
2209      +
2210      +	var
2211      +		tot_ptd_earn_uniq_memcount
2212      +		tot_ptd_earn_actcount
2213      +		tot_ptd_earn_points
2214      +		tot_ptd_earn_value
2215      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var tot_ptd_earn_uniq_memcount tot_ptd_earn_actcount tot_ptd_earn_points tot_ptd_earn_value ;
2216      +
2217      +	ranks
2218      +		top_ptd_earn_rank_by_memcnt
2219      +		top_ptd_earn_rank_by_actcnt
2220      +		top_ptd_earn_rank_by_points
2221      +		top_ptd_earn_rank_by_value
2222      +	;
MPRINT(CREATE_PB_STD_FORMATS):   ranks top_ptd_earn_rank_by_memcnt top_ptd_earn_rank_by_actcnt top_ptd_earn_rank_by_points 
top_ptd_earn_rank_by_value ;
2223      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 317 observations read from the data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_E.
NOTE: The data set WORK.FG_PTD_TOP_CITY_BY_FMT_E_RANKS has 317 observations and 6 variables.
NOTE: Compressing data set WORK.FG_PTD_TOP_CITY_BY_FMT_E_RANKS decreased size by 25.00 percent. 
      Compressed is 3 pages; un-compressed would require 4 pages.
NOTE: PROCEDURE RANK used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
2224      +quit;
2225      +
90                                                         The SAS System                              11:30 Friday, January 8, 2016

2226      +proc rank data = fg_ptd_top_citylist_by_fmt_b out=fg_ptd_top_city_by_fmt_b_ranks
2227      +		(
2228      +		keep=
2229      +			p_commercial_name
2230      +			branch_city
2231      +			top_ptd_burn_rank_by_memcnt
2232      +			top_ptd_burn_rank_by_actcnt
2233      +			top_ptd_burn_rank_by_points
2234      +			top_ptd_burn_rank_by_value
2235      +		) descending ties=low
2236      +	;
MPRINT(CREATE_PB_STD_FORMATS):   proc rank data = fg_ptd_top_citylist_by_fmt_b out=fg_ptd_top_city_by_fmt_b_ranks ( keep= 
p_commercial_name branch_city top_ptd_burn_rank_by_memcnt top_ptd_burn_rank_by_actcnt top_ptd_burn_rank_by_points 
top_ptd_burn_rank_by_value ) descending ties=low ;
2237      +
2238      +	by
2239      +		p_commercial_name
2240      +	;
MPRINT(CREATE_PB_STD_FORMATS):   by p_commercial_name ;
2241      +
2242      +	var
2243      +		tot_ptd_burn_uniq_memcount
2244      +		tot_ptd_burn_actcount
2245      +		tot_ptd_burn_points
2246      +		tot_ptd_burn_value
2247      +	;
MPRINT(CREATE_PB_STD_FORMATS):   var tot_ptd_burn_uniq_memcount tot_ptd_burn_actcount tot_ptd_burn_points tot_ptd_burn_value ;
2248      +
2249      +	ranks
2250      +		top_ptd_burn_rank_by_memcnt
2251      +		top_ptd_burn_rank_by_actcnt
2252      +		top_ptd_burn_rank_by_points
2253      +		top_ptd_burn_rank_by_value
2254      +	;
MPRINT(CREATE_PB_STD_FORMATS):   ranks top_ptd_burn_rank_by_memcnt top_ptd_burn_rank_by_actcnt top_ptd_burn_rank_by_points 
top_ptd_burn_rank_by_value ;
2255      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 282 observations read from the data set WORK.FG_PTD_TOP_CITYLIST_BY_FMT_B.
NOTE: The data set WORK.FG_PTD_TOP_CITY_BY_FMT_B_RANKS has 282 observations and 6 variables.
NOTE: Compressing data set WORK.FG_PTD_TOP_CITY_BY_FMT_B_RANKS decreased size by 25.00 percent. 
      Compressed is 3 pages; un-compressed would require 4 pages.
NOTE: PROCEDURE RANK used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATE_PB_STD_FORMATS):   quit;
2256      +quit;
2257      +
2258      +
2259      +/* Construction of SAS FORMAT based on unique member count for every FG FORMAT */
2260      +
2261      +data fg_top10cy_ecnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   data fg_top10cy_ecnt_12mth;
2262      +
2263      +	RETAIN FMTNAME "fg_top10cy_ecnt_12mth" Type 'C';
91                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "fg_top10cy_ecnt_12mth" Type 'C';
2264      +
2265      +	set fg_12mth_top_city_by_fmt_e_ranks end=eof;
MPRINT(CREATE_PB_STD_FORMATS):   set fg_12mth_top_city_by_fmt_e_ranks end=eof;
2266      +
2267      +	format start $50.;
MPRINT(CREATE_PB_STD_FORMATS):   format start $50.;
2268      +		
2269      +	start = strip(p_commercial_name) || strip(branch_city);
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(p_commercial_name) || strip(branch_city);
2270      +	if top_12mth_earn_rank_by_memcnt <= 10 then do;
MPRINT(CREATE_PB_STD_FORMATS):   if top_12mth_earn_rank_by_memcnt <= 10 then do;
2271      +		label = branch_city;
MPRINT(CREATE_PB_STD_FORMATS):   label = branch_city;
2272      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2273      +	else label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   else label = "OTHERS";
2274      +	output;
MPRINT(CREATE_PB_STD_FORMATS):   output;
2275      +	if eof then do;
MPRINT(CREATE_PB_STD_FORMATS):   if eof then do;
2276      +		hlo='O';
MPRINT(CREATE_PB_STD_FORMATS):   hlo='O';
2277      +		label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   label = "OTHERS";
2278      +		OUTPUT;
MPRINT(CREATE_PB_STD_FORMATS):   OUTPUT;
2279      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2280      +
2281      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_12MTH_TOP_CITY_BY_FMT_E_RANKS.
NOTE: The data set WORK.FG_TOP10CY_ECNT_12MTH has 0 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2282      +
2283      +proc format library = formats cntlin=fg_top10cy_ecnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats cntlin=fg_top10cy_ecnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   quit;
2284      +quit;

NOTE: There were 0 observations read from the data set WORK.FG_TOP10CY_ECNT_12MTH.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2285      +
2286      +/* Top20 FG cities by performance variable: UNIQ EARN MEMBER COUNT */
2287      +
2288      +data fg_top20cy_ecnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   data fg_top20cy_ecnt_12mth;
92                                                         The SAS System                              11:30 Friday, January 8, 2016

2289      +
2290      +	RETAIN FMTNAME "fg_top20cy_ecnt_12mth" Type 'C';
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "fg_top20cy_ecnt_12mth" Type 'C';
2291      +
2292      +	set fg_12mth_top_city_by_fmt_e_ranks end=eof;
MPRINT(CREATE_PB_STD_FORMATS):   set fg_12mth_top_city_by_fmt_e_ranks end=eof;
2293      +
2294      +	format start $50.;
MPRINT(CREATE_PB_STD_FORMATS):   format start $50.;
2295      +		
2296      +	start = strip(p_commercial_name) || strip(branch_city);
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(p_commercial_name) || strip(branch_city);
2297      +	if top_12mth_earn_rank_by_memcnt <= 20 then do;
MPRINT(CREATE_PB_STD_FORMATS):   if top_12mth_earn_rank_by_memcnt <= 20 then do;
2298      +		label = branch_city;
MPRINT(CREATE_PB_STD_FORMATS):   label = branch_city;
2299      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2300      +	else label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   else label = "OTHERS";
2301      +	output;
MPRINT(CREATE_PB_STD_FORMATS):   output;
2302      +	if eof then do;
MPRINT(CREATE_PB_STD_FORMATS):   if eof then do;
2303      +		hlo='O';
MPRINT(CREATE_PB_STD_FORMATS):   hlo='O';
2304      +		label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   label = "OTHERS";
2305      +		OUTPUT;
MPRINT(CREATE_PB_STD_FORMATS):   OUTPUT;
2306      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2307      +
2308      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_12MTH_TOP_CITY_BY_FMT_E_RANKS.
NOTE: The data set WORK.FG_TOP20CY_ECNT_12MTH has 0 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2309      +
2310      +proc format library = formats cntlin=fg_top20cy_ecnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats cntlin=fg_top20cy_ecnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   quit;
2311      +quit;

NOTE: There were 0 observations read from the data set WORK.FG_TOP20CY_ECNT_12MTH.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2312      +
2313      +
2314      +/* Top50 FG cities by performance variable: UNIQ EARN MEMBER COUNT */
93                                                         The SAS System                              11:30 Friday, January 8, 2016

2315      +
2316      +
2317      +data fg_top50cy_ecnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   data fg_top50cy_ecnt_12mth;
2318      +
2319      +	RETAIN FMTNAME "fg_top50cy_ecnt_12mth" Type 'C';
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "fg_top50cy_ecnt_12mth" Type 'C';
2320      +
2321      +	set fg_12mth_top_city_by_fmt_e_ranks end=eof;
MPRINT(CREATE_PB_STD_FORMATS):   set fg_12mth_top_city_by_fmt_e_ranks end=eof;
2322      +
2323      +	format start $50.;
MPRINT(CREATE_PB_STD_FORMATS):   format start $50.;
2324      +		
2325      +	start = strip(p_commercial_name) || strip(branch_city);
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(p_commercial_name) || strip(branch_city);
2326      +	if top_12mth_earn_rank_by_memcnt <= 50 then do;
MPRINT(CREATE_PB_STD_FORMATS):   if top_12mth_earn_rank_by_memcnt <= 50 then do;
2327      +		label = branch_city;
MPRINT(CREATE_PB_STD_FORMATS):   label = branch_city;
2328      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2329      +	else label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   else label = "OTHERS";
2330      +	
2331      +	output;
MPRINT(CREATE_PB_STD_FORMATS):   output;
2332      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_12MTH_TOP_CITY_BY_FMT_E_RANKS.
NOTE: The data set WORK.FG_TOP50CY_ECNT_12MTH has 0 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2333      +
2334      +proc format library = formats cntlin=fg_top50cy_ecnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats cntlin=fg_top50cy_ecnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   quit;
2335      +quit;

NOTE: There were 0 observations read from the data set WORK.FG_TOP50CY_ECNT_12MTH.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2336      +
2337      +/* Top20 FG cities by performance variable: EARN activity count */
2338      +
2339      +data fg_top20cy_eactcnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   data fg_top20cy_eactcnt_12mth;
2340      +
2341      +	RETAIN FMTNAME "fg_top20cy_eactcnt_12mth" Type 'C';
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "fg_top20cy_eactcnt_12mth" Type 'C';
2342      +
94                                                         The SAS System                              11:30 Friday, January 8, 2016

2343      +	set fg_12mth_top_city_by_fmt_e_ranks end=eof;
MPRINT(CREATE_PB_STD_FORMATS):   set fg_12mth_top_city_by_fmt_e_ranks end=eof;
2344      +
2345      +	format start $50.;
MPRINT(CREATE_PB_STD_FORMATS):   format start $50.;
2346      +		
2347      +	start = strip(p_commercial_name) || strip(branch_city);
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(p_commercial_name) || strip(branch_city);
2348      +	if top_12mth_earn_rank_by_actcnt <= 20 then do;
MPRINT(CREATE_PB_STD_FORMATS):   if top_12mth_earn_rank_by_actcnt <= 20 then do;
2349      +		label = branch_city;
MPRINT(CREATE_PB_STD_FORMATS):   label = branch_city;
2350      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2351      +	else label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   else label = "OTHERS";
2352      +	output;
MPRINT(CREATE_PB_STD_FORMATS):   output;
2353      +	if eof then do;
MPRINT(CREATE_PB_STD_FORMATS):   if eof then do;
2354      +		hlo='O';
MPRINT(CREATE_PB_STD_FORMATS):   hlo='O';
2355      +		label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   label = "OTHERS";
2356      +		OUTPUT;
MPRINT(CREATE_PB_STD_FORMATS):   OUTPUT;
2357      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2358      +
2359      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 0 observations read from the data set WORK.FG_12MTH_TOP_CITY_BY_FMT_E_RANKS.
NOTE: The data set WORK.FG_TOP20CY_EACTCNT_12MTH has 0 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2360      +
2361      +proc format library = formats cntlin=fg_top20cy_eactcnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats cntlin=fg_top20cy_eactcnt_12mth;
MPRINT(CREATE_PB_STD_FORMATS):   quit;
2362      +quit;

NOTE: There were 0 observations read from the data set WORK.FG_TOP20CY_EACTCNT_12MTH.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2363      +
2364      +/* FG Top cities Format by PTD performance - */
2365      +
2366      +data fg_top20cy_ecnt_ptd;
MPRINT(CREATE_PB_STD_FORMATS):   data fg_top20cy_ecnt_ptd;
2367      +
2368      +	RETAIN FMTNAME "fg_top20cy_ecnt_ptd" Type 'C';
95                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "fg_top20cy_ecnt_ptd" Type 'C';
2369      +
2370      +	set fg_ptd_top_city_by_fmt_e_ranks end=eof;
MPRINT(CREATE_PB_STD_FORMATS):   set fg_ptd_top_city_by_fmt_e_ranks end=eof;
2371      +
2372      +	format start $50.;
MPRINT(CREATE_PB_STD_FORMATS):   format start $50.;
2373      +		
2374      +	start = strip(p_commercial_name) || strip(branch_city);
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(p_commercial_name) || strip(branch_city);
2375      +	if top_ptd_earn_rank_by_memcnt <= 20 then do;
MPRINT(CREATE_PB_STD_FORMATS):   if top_ptd_earn_rank_by_memcnt <= 20 then do;
2376      +		label = branch_city;
MPRINT(CREATE_PB_STD_FORMATS):   label = branch_city;
2377      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2378      +	else label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   else label = "OTHERS";
2379      +	output;
MPRINT(CREATE_PB_STD_FORMATS):   output;
2380      +	if eof then do;
MPRINT(CREATE_PB_STD_FORMATS):   if eof then do;
2381      +		hlo='O';
MPRINT(CREATE_PB_STD_FORMATS):   hlo='O';
2382      +		label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   label = "OTHERS";
2383      +		OUTPUT;
MPRINT(CREATE_PB_STD_FORMATS):   OUTPUT;
2384      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2385      +
2386      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 317 observations read from the data set WORK.FG_PTD_TOP_CITY_BY_FMT_E_RANKS.
NOTE: The data set WORK.FG_TOP20CY_ECNT_PTD has 318 observations and 11 variables.
NOTE: Compressing data set WORK.FG_TOP20CY_ECNT_PTD decreased size by 25.00 percent. 
      Compressed is 3 pages; un-compressed would require 4 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

2387      +
2388      +proc format library = formats cntlin=fg_top20cy_ecnt_ptd;
MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats cntlin=fg_top20cy_ecnt_ptd;
NOTE: Format $FG_TOP20CY_ECNT_PTD has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;
2389      +quit;

NOTE: There were 318 observations read from the data set WORK.FG_TOP20CY_ECNT_PTD.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2390      +
2391      +data fg_top20cy_eactcnt_ptd;
96                                                         The SAS System                              11:30 Friday, January 8, 2016

MPRINT(CREATE_PB_STD_FORMATS):   data fg_top20cy_eactcnt_ptd;
2392      +
2393      +	RETAIN FMTNAME "fg_top20cy_eactcnt_ptd" Type 'C';
MPRINT(CREATE_PB_STD_FORMATS):   RETAIN FMTNAME "fg_top20cy_eactcnt_ptd" Type 'C';
2394      +
2395      +	set fg_ptd_top_city_by_fmt_e_ranks end=eof;
MPRINT(CREATE_PB_STD_FORMATS):   set fg_ptd_top_city_by_fmt_e_ranks end=eof;
2396      +
2397      +	format start $50.;
MPRINT(CREATE_PB_STD_FORMATS):   format start $50.;
2398      +		
2399      +	start = strip(p_commercial_name) || strip(branch_city);
MPRINT(CREATE_PB_STD_FORMATS):   start = strip(p_commercial_name) || strip(branch_city);
2400      +	if top_ptd_earn_rank_by_actcnt <= 20 then do;
MPRINT(CREATE_PB_STD_FORMATS):   if top_ptd_earn_rank_by_actcnt <= 20 then do;
2401      +		label = branch_city;
MPRINT(CREATE_PB_STD_FORMATS):   label = branch_city;
2402      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2403      +	else label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   else label = "OTHERS";
2404      +	output;
MPRINT(CREATE_PB_STD_FORMATS):   output;
2405      +	if eof then do;
MPRINT(CREATE_PB_STD_FORMATS):   if eof then do;
2406      +		hlo='O';
MPRINT(CREATE_PB_STD_FORMATS):   hlo='O';
2407      +		label = "OTHERS";
MPRINT(CREATE_PB_STD_FORMATS):   label = "OTHERS";
2408      +		OUTPUT;
MPRINT(CREATE_PB_STD_FORMATS):   OUTPUT;
2409      +	end;
MPRINT(CREATE_PB_STD_FORMATS):   end;
2410      +
2411      +run;
MPRINT(CREATE_PB_STD_FORMATS):   run;

NOTE: There were 317 observations read from the data set WORK.FG_PTD_TOP_CITY_BY_FMT_E_RANKS.
NOTE: The data set WORK.FG_TOP20CY_EACTCNT_PTD has 318 observations and 11 variables.
NOTE: Compressing data set WORK.FG_TOP20CY_EACTCNT_PTD decreased size by 25.00 percent. 
      Compressed is 3 pages; un-compressed would require 4 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2412      +
2413      +proc format library = formats cntlin=fg_top20cy_eactcnt_ptd;
MPRINT(CREATE_PB_STD_FORMATS):   proc format library = formats cntlin=fg_top20cy_eactcnt_ptd;
NOTE: Format $FG_TOP20CY_EACTCNT_PTD has been written to FORMATS.FORMATS.
MPRINT(CREATE_PB_STD_FORMATS):   quit;
2414      +quit;

NOTE: There were 318 observations read from the data set WORK.FG_TOP20CY_EACTCNT_PTD.
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
97                                                         The SAS System                              11:30 Friday, January 8, 2016


NOTE: %INCLUDE (level 1) ending.
MLOGIC(CREATE_PB_STD_FORMATS):  Ending execution.
2415       

ERROR: Errors printed on page 49.

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           1:30.45
      cpu time            1:01.25
      
